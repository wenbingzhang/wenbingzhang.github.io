<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux on 张文兵的笔记</title><link>https://notes.zhangwenbing.com/categories/linux/</link><description>Recent content in Linux on 张文兵的笔记</description><generator>Hugo</generator><language>zh</language><lastBuildDate>Mon, 23 Dec 2024 18:17:28 +0800</lastBuildDate><atom:link href="https://notes.zhangwenbing.com/categories/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Linux硬盘故障相关的查询命令</title><link>https://notes.zhangwenbing.com/articles/2024/12/23/wvkjyjt7qhumo4jpucheca/</link><pubDate>Mon, 23 Dec 2024 18:17:28 +0800</pubDate><guid>https://notes.zhangwenbing.com/articles/2024/12/23/wvkjyjt7qhumo4jpucheca/</guid><description>&lt;h2 id="查看硬盘及对应的uuid信息">
 查看硬盘及对应的UUID信息
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e7%a1%ac%e7%9b%98%e5%8f%8a%e5%af%b9%e5%ba%94%e7%9a%84uuid%e4%bf%a1%e6%81%af">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 查看硬盘及对应的UUID信息 或者是所有硬盘的UUID信息&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>blkid &lt;span style="color:#f92672">[&lt;/span>/dev/sda1&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#75715e"># lsblk -o NAME,UUID -p&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="查看uuid对应的硬盘路径">
 查看UUID对应的硬盘路径
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8buuid%e5%af%b9%e5%ba%94%e7%9a%84%e7%a1%ac%e7%9b%98%e8%b7%af%e5%be%84">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>blkid -U 383bc776-fc1a-4040-ad8f-45f4f5d96fcf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="查看硬盘信息">
 查看硬盘信息
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e7%a1%ac%e7%9b%98%e4%bf%a1%e6%81%af">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>lshw -class disk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="检测磁盘是否损坏">
 检测磁盘是否损坏
 &lt;a class="anchor" href="#%e6%a3%80%e6%b5%8b%e7%a3%81%e7%9b%98%e6%98%af%e5%90%a6%e6%8d%9f%e5%9d%8f">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>badblocks -b &lt;span style="color:#ae81ff">4096&lt;/span> -v /dev/sda &lt;span style="color:#75715e"># 也有坏快的屏蔽方式这个里就不列举了&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="点亮硬盘led">
 点亮硬盘LED
 &lt;a class="anchor" href="#%e7%82%b9%e4%ba%ae%e7%a1%ac%e7%9b%98led">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dd &lt;span style="color:#66d9ef">if&lt;/span>&lt;span style="color:#f92672">=&lt;/span>/dev/sda of&lt;span style="color:#f92672">=&lt;/span>/dev/null bs&lt;span style="color:#f92672">=&lt;/span>1M count&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#75715e"># 点亮硬盘LED&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="查看服务器序列号">
 查看服务器序列号
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%ba%8f%e5%88%97%e5%8f%b7">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dmidecode -t &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#75715e"># 查看对应的&amp;#39;Serial Number&amp;#39;字段&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Mamba替代Conda</title><link>https://notes.zhangwenbing.com/articles/2024/03/27/e4c2nybngzu5eddbnmdjgq/</link><pubDate>Wed, 27 Mar 2024 13:07:03 +0800</pubDate><guid>https://notes.zhangwenbing.com/articles/2024/03/27/e4c2nybngzu5eddbnmdjgq/</guid><description>&lt;p>mamba是一个conda的替代品，可以加速conda的包管理，提升包管理的效率。&lt;/p>
&lt;h2 id="安装">
 安装
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>brew install micromamba
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="配置">
 配置
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 根据命令提示，修改~/.zshrc文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>micromamba shell init -s zsh -p ~/.micromamba
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 添加配置文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ cat ~/.mambarc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>channels:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - conda-forge
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>always_yes: false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="使用">
 使用
 &lt;a class="anchor" href="#%e4%bd%bf%e7%94%a8">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>micromamba create -n python310 python&lt;span style="color:#f92672">=&lt;/span>3.10
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 激活环境&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>micromamba activate python310
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 然后可以用 micromamba 或者 pip 装东西&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>micromamba install package_1 package_2&lt;span style="color:#f92672">=&lt;/span>version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## 具体请参考 https://mamba.readthedocs.io/en/latest/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>micromamba --help
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ssh客户端于服务端保持连接</title><link>https://notes.zhangwenbing.com/blog/linux/fSHb366Mg/</link><pubDate>Fri, 11 Jun 2021 17:26:32 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/fSHb366Mg/</guid><description>&lt;blockquote>
&lt;p>linux ssh 默认没有开启心跳，所以很容易导致连接断开。&lt;/p>
&lt;/blockquote>
&lt;h2 id="服务端设置">
 服务端设置
 &lt;a class="anchor" href="#%e6%9c%8d%e5%8a%a1%e7%ab%af%e8%ae%be%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TCPKeepAlive yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ClientAliveInterval &lt;span style="color:#ae81ff">60&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ClientAliveCountMax &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="客户端设置">
 客户端设置
 &lt;a class="anchor" href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e8%ae%be%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;p>一般还是建议在客户端设置。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/ssh/ssh_config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TCPKeepAlive yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ServerAliveInterval &lt;span style="color:#ae81ff">60&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ServerAliveCountMax &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Centos7系统升级内核版本</title><link>https://notes.zhangwenbing.com/blog/linux/G0DCCusMR/</link><pubDate>Tue, 02 Mar 2021 17:52:33 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/G0DCCusMR/</guid><description>&lt;blockquote>
&lt;p>使用ELRepo仓库升级系统内核&lt;/p>
&lt;/blockquote>
&lt;h2 id="查看内核版本">
 查看内核版本
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e5%86%85%e6%a0%b8%e7%89%88%e6%9c%ac">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>uname -r
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uname -a
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cat /etc/redhat-release
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="安装elrepo-yum源">
 安装ELRepo yum源
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85elrepo-yum%e6%ba%90">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="查看可用的内核版本">
 查看可用的内核版本
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e5%8f%af%e7%94%a8%e7%9a%84%e5%86%85%e6%a0%b8%e7%89%88%e6%9c%ac">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum --disablerepo&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span> --enablerepo&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;elrepo-kernel&amp;#34;&lt;/span> list available
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kernel-lt.x86_64 4.4.155-1.el7.elrepo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>kernel-lt-devel.x86_64 4.4.155-1.el7.elrepo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="安装稳定版本内核">
 安装稳定版本内核
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85%e7%a8%b3%e5%ae%9a%e7%89%88%e6%9c%ac%e5%86%85%e6%a0%b8">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum --enablerepo&lt;span style="color:#f92672">=&lt;/span>elrepo-kernel install kernel-lt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="设置引导grub2">
 设置引导（grub2）
 &lt;a class="anchor" href="#%e8%ae%be%e7%bd%ae%e5%bc%95%e5%af%bcgrub2">#&lt;/a>
&lt;/h2>
&lt;h3 id="查看所有内核版本">
 查看所有内核版本
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89%e5%86%85%e6%a0%b8%e7%89%88%e6%9c%ac">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo awk -F&lt;span style="color:#ae81ff">\&amp;#39;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;$1==&amp;#34;menuentry &amp;#34; {print i++ &amp;#34; : &amp;#34; $2}&amp;#39;&lt;/span> /etc/grub2.cfg
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">0&lt;/span> : CentOS Linux &lt;span style="color:#f92672">(&lt;/span>4.4.241-1.el7.elrepo.x86_64&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span> &lt;span style="color:#f92672">(&lt;/span>Core&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">1&lt;/span> : CentOS Linux &lt;span style="color:#f92672">(&lt;/span>3.10.0-957.el7.x86_64&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span> &lt;span style="color:#f92672">(&lt;/span>Core&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">2&lt;/span> : CentOS Linux &lt;span style="color:#f92672">(&lt;/span>0-rescue-651e1b90bb3149809cdeb8cc80e72c43&lt;span style="color:#f92672">)&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span> &lt;span style="color:#f92672">(&lt;/span>Core&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="设置新的默认引导的内核版本">
 设置新的默认引导的内核版本
 &lt;a class="anchor" href="#%e8%ae%be%e7%bd%ae%e6%96%b0%e7%9a%84%e9%bb%98%e8%ae%a4%e5%bc%95%e5%af%bc%e7%9a%84%e5%86%85%e6%a0%b8%e7%89%88%e6%9c%ac">#&lt;/a>
&lt;/h3>
&lt;p>方法1&lt;/p></description></item><item><title>dnsmasq安装与配置</title><link>https://notes.zhangwenbing.com/blog/linux/xd2UELYGR/</link><pubDate>Wed, 03 Feb 2021 11:20:44 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/xd2UELYGR/</guid><description>&lt;blockquote>
&lt;p>dnsmasq是一个小巧且方便地用于配置DNS和DHCP的工具，适用于小型网络，它提供了DNS功能和可选择的DHCP功能。&lt;/p>
&lt;/blockquote>
&lt;h2 id="安装服务">
 安装服务
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo yum install dnsmasq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="常用配置">
 常用配置
 &lt;a class="anchor" href="#%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/dnsmasq.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#######这里表示 严格按照 resolv-file 文件中的顺序从上到下进行 DNS 解析, 直到第一个成功解析成功为止&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#strict-order&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">###同时发送所有的查询到所有的dns服务器，谁快就用谁&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>all-servers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>listen-address&lt;span style="color:#f92672">=&lt;/span>127.0.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">###不让dnsmasq去读/etc/hosts文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>no-hosts
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">## 设置缓存条目&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cache-size&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">10240&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#允许客户端缓存的时间单位为秒&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>local-ttl&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">10&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>max-cache-ttl&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">15&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">###开启日志&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#log-queries&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">##配置日志文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#log-facility=/data/logs/dnsmasq.log&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/resolv.dnsmasq.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nameserver 223.5.5.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nameserver 114.114.114.114
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>nameserver 222.246.129.80
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="启动服务">
 启动服务
 &lt;a class="anchor" href="#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>systemctl start dnsmasq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="验证方法">
 验证方法
 &lt;a class="anchor" href="#%e9%aa%8c%e8%af%81%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>dig www.zhangwenbing.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="其他配置">
 其他配置
 &lt;a class="anchor" href="#%e5%85%b6%e4%bb%96%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;h3 id="国内指定dns">
 &lt;strong>国内指定DNS&lt;/strong>
 &lt;a class="anchor" href="#%e5%9b%bd%e5%86%85%e6%8c%87%e5%ae%9adns">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">server&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/cn/114.114.114.114&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">server&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/taobao.com/114.114.114.114&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">server&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/taobaocdn.com/114.114.114.114&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="国外指定dns">
 &lt;strong>国外指定DNS&lt;/strong>
 &lt;a class="anchor" href="#%e5%9b%bd%e5%a4%96%e6%8c%87%e5%ae%9adns">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">server&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/google.com/8.8.8.8&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="屏蔽网页广告">
 屏蔽网页广告
 &lt;a class="anchor" href="#%e5%b1%8f%e8%94%bd%e7%bd%91%e9%a1%b5%e5%b9%bf%e5%91%8a">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ini" data-lang="ini">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">address&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/ad.youku.com/127.0.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">address&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">/ad.iqiyi.com/127.0.0.1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="其他功能">
 其他功能
 &lt;a class="anchor" href="#%e5%85%b6%e4%bb%96%e5%8a%9f%e8%83%bd">#&lt;/a>
&lt;/h2>
&lt;p>除了DNS，还支持DHCP和TFTP，由于暂时用不到，这里就不一一例举了。&lt;/p></description></item><item><title>使用ssh配置跳板机</title><link>https://notes.zhangwenbing.com/blog/linux/SNyWJwbGR/</link><pubDate>Tue, 29 Dec 2020 16:11:55 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SNyWJwbGR/</guid><description>&lt;blockquote>
&lt;p>简单的修改/etc/ssh/ssh_config文件即可通过跳板机，直达目标服务器。&lt;/p>
&lt;/blockquote>
&lt;h2 id="配置方法">
 配置方法
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%ae%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/ssh/ssh_config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host jump-server
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> User xxxx
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Hostname yyy.yyy.yyy.yyy
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Port &lt;span style="color:#ae81ff">22&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host 10.*
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ProxyCommand ssh -q -W %h:%p jump-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Host 支持通配符 &lt;code>*&lt;/code> 和 &lt;code>?&lt;/code>&lt;/p></description></item><item><title>centos6镜像站停止维护的解决办法</title><link>https://notes.zhangwenbing.com/blog/linux/tqj7MybMg/</link><pubDate>Mon, 28 Dec 2020 17:47:27 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/tqj7MybMg/</guid><description>&lt;blockquote>
&lt;p>2020年11月30日 centos6各大开源镜像站已经停止维护了，但是阿里云还有其他源可以使用。&lt;/p>
&lt;/blockquote>
&lt;h2 id="错误提示">
 错误提示
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e6%8f%90%e7%a4%ba">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span> http://mirrors.aliyun.com/epel/6/x86_64/repodata/repomd.xml: &lt;span style="color:#f92672">[&lt;/span>Errno 14&lt;span style="color:#f92672">]&lt;/span> PYCURL ERROR &lt;span style="color:#ae81ff">22&lt;/span> - &lt;span style="color:#e6db74">&amp;#34;The requested URL returned error: 404 Not Found&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="解决办法">
 解决办法
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e5%8a%9e%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/yum.repos.d/CentOS-Base.repo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># CentOS-Base.repo&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># The mirror system uses the connecting IP address of the client and the&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># update status of each mirror to pick mirrors that are updated to and&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># geographically close to the client. You should use this for CentOS updates&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># unless you are manually picking other mirrors.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># If the mirrorlist= does not work for you, as a fall back you can try the&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># remarked out baseurl= line instead.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>base&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&lt;span style="color:#f92672">=&lt;/span>CentOS-6.10 - Base - mirrors.aliyun.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>failovermethod&lt;span style="color:#f92672">=&lt;/span>priority
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baseurl&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/6.10/os/$basearch/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgcheck&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgkey&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#released updates&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>updates&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&lt;span style="color:#f92672">=&lt;/span>CentOS-6.10 - Updates - mirrors.aliyun.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>failovermethod&lt;span style="color:#f92672">=&lt;/span>priority
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baseurl&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/6.10/updates/$basearch/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgcheck&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgkey&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#additional packages that may be useful&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>extras&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&lt;span style="color:#f92672">=&lt;/span>CentOS-6.10 - Extras - mirrors.aliyun.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>failovermethod&lt;span style="color:#f92672">=&lt;/span>priority
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baseurl&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/6.10/extras/$basearch/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgcheck&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgkey&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#additional packages that extend functionality of existing packages&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>centosplus&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&lt;span style="color:#f92672">=&lt;/span>CentOS-6.10 - Plus - mirrors.aliyun.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>failovermethod&lt;span style="color:#f92672">=&lt;/span>priority
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baseurl&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/6.10/centosplus/$basearch/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgcheck&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>enabled&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgkey&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#contrib - packages by Centos Users&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>contrib&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&lt;span style="color:#f92672">=&lt;/span>CentOS-6.10 - Contrib - mirrors.aliyun.com
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>failovermethod&lt;span style="color:#f92672">=&lt;/span>priority
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baseurl&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/6.10/contrib/$basearch/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgcheck&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>enabled&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgkey&lt;span style="color:#f92672">=&lt;/span>http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum clean all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yum makecache
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>tcpdump之UDP抓包</title><link>https://notes.zhangwenbing.com/blog/linux/-vpymjJGg/</link><pubDate>Fri, 18 Dec 2020 15:01:47 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/-vpymjJGg/</guid><description>&lt;blockquote>
&lt;p>使用tcpdump抓UDP包，过滤过滤IP和port，并且自动拆分片段。&lt;/p>
&lt;/blockquote>
&lt;h2 id="安装tcpdump">
 安装tcpdump
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85tcpdump">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum install -y tcpdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="使用方法">
 使用方法
 &lt;a class="anchor" href="#%e4%bd%bf%e7%94%a8%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>tcpdump -i bond0 udp port xxxx and host xxx.x.xx.xxx -s0 -G &lt;span style="color:#ae81ff">600&lt;/span> -w %Y_%m%d_%H%M_%S.pcap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="参数说明">
 参数说明
 &lt;a class="anchor" href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e">#&lt;/a>
&lt;/h3>
&lt;p>-i 指定监听的网卡&lt;/p></description></item><item><title>Linux收录UDP视频花屏总结</title><link>https://notes.zhangwenbing.com/blog/linux/h5sGcU1MR/</link><pubDate>Wed, 16 Dec 2020 19:10:08 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/h5sGcU1MR/</guid><description>&lt;blockquote>
&lt;p>最近在Linux下使用ffmpeg收录UDP流花屏问题，发现机器有双网卡，添加路由指定网卡收录导致无法收录了。另附一些解决花屏的优化方法。&lt;/p>
&lt;/blockquote>
&lt;h2 id="优化内核参数">
 优化内核参数
 &lt;a class="anchor" href="#%e4%bc%98%e5%8c%96%e5%86%85%e6%a0%b8%e5%8f%82%e6%95%b0">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/sysctl.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>net.ipv4.conf.default.rp_filter &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>net.ipv4.conf.all.rp_filter &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 修改默认网络的缓存大小 这个很重要不然&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>net.core.rmem_max &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">50000000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>net.core.rmem_default &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">50000000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sysctl -p
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 添加以上配置后需要重启系统&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>reboot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 不重启的话一定要执行以下命令&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> i in /proc/sys/net/ipv4/conf/*/rp_filter ; &lt;span style="color:#66d9ef">do&lt;/span> echo &lt;span style="color:#ae81ff">0&lt;/span> &amp;gt; &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$i&lt;span style="color:#e6db74">&amp;#34;&lt;/span>; &lt;span style="color:#66d9ef">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="吐槽">
 吐槽
 &lt;a class="anchor" href="#%e5%90%90%e6%a7%bd">#&lt;/a>
&lt;/h2>
&lt;p>由于博主只修改了上面的 &lt;code>sysctl.conf&lt;/code> 并且只执行了 &lt;code>sysctl -p&lt;/code> 所以悲剧了，添加路由之后一直无法收录。&lt;/p></description></item><item><title>CentOS添加静态路由之route</title><link>https://notes.zhangwenbing.com/blog/linux/loBZJ41MR/</link><pubDate>Wed, 09 Dec 2020 20:50:36 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/loBZJ41MR/</guid><description>&lt;blockquote>
&lt;p>route命令参数详细说明及常用命令&lt;/p>
&lt;/blockquote>
&lt;p>原文地址 &lt;a href="https://docs.lvrui.io/2016/10/12/CentOS%E4%B8%8B%E6%B7%BB%E5%8A%A0%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1/">docs.lvrui.io&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&amp;gt; route
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Kernel IP routing table
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Destination Gateway Genmask Flags Metric Ref Use Iface
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>default localhost 0.0.0.0 UG &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> eno16780032
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>172.17.0.0 0.0.0.0 255.255.0.0 U &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> docker0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>192.168.10.0 0.0.0.0 255.255.255.0 U &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> eno16780032
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;em>macOS 中使用 &lt;code>netstat -nr&lt;/code> 命令来查看当前路由表&lt;/em>&lt;/p></description></item><item><title>nginx及php-fpm优化</title><link>https://notes.zhangwenbing.com/blog/linux/bdpp4QAMg/</link><pubDate>Fri, 04 Dec 2020 16:33:34 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/bdpp4QAMg/</guid><description>&lt;blockquote>
&lt;p>简单的讲讲nginx+php的一些常用优化，以及相关的内核参数优化。&lt;/p>
&lt;/blockquote>
&lt;h2 id="nginx-优化">
 Nginx 优化
 &lt;a class="anchor" href="#nginx-%e4%bc%98%e5%8c%96">#&lt;/a>
&lt;/h2>
&lt;h3 id="1-tcp-与-unix-套接字">
 1. TCP 与 UNIX 套接字
 &lt;a class="anchor" href="#1-tcp-%e4%b8%8e-unix-%e5%a5%97%e6%8e%a5%e5%ad%97">#&lt;/a>
&lt;/h3>
&lt;p>UNIX 域套接字提供的性能略高于 TCP 套接字在回送接口上的性能（较少的数据复制，较少的上下文切换）。如果每个服务器需要支持超过 1000 个连接，请使用 TCP 套接字 - 它们可以更好地扩展。&lt;/p></description></item><item><title>[supervisord]填坑之最大连接数</title><link>https://notes.zhangwenbing.com/blog/linux/HTLMANZea/</link><pubDate>Thu, 27 Aug 2020 04:03:19 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HTLMANZea/</guid><description>&lt;blockquote>
&lt;p>修改supervisord配置突破1024最大连接数&lt;/p>
&lt;/blockquote>
&lt;h2 id="问题描述">
 问题描述
 &lt;a class="anchor" href="#%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0">#&lt;/a>
&lt;/h2>
&lt;p>最近在使用supervisord服务时发现，无论如何修改系统的最大连接数，由supervisord管理的程序都无法突破1024的限制。&lt;/p></description></item><item><title>supervisor 常见坑及解决办法</title><link>https://notes.zhangwenbing.com/blog/linux/QNIBzjz3k/</link><pubDate>Tue, 14 Jul 2020 09:51:26 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/QNIBzjz3k/</guid><description>&lt;blockquote>
&lt;p>Too many open files、获取不到$HOME等&lt;/p>
&lt;/blockquote>
&lt;h2 id="too-many-open-files">
 Too many open files
 &lt;a class="anchor" href="#too-many-open-files">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/supervisord.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>supervisord&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>minfds&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">81920&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>minprocs&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">81920&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># systemctl restart supervisord&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="获取不到home">
 获取不到$HOME
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96%e4%b8%8d%e5%88%b0home">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>program:apache2&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>command&lt;span style="color:#f92672">=&lt;/span>/home/chrism/bin/httpd -c &lt;span style="color:#e6db74">&amp;#34;ErrorLog /dev/stdout&amp;#34;&lt;/span> -DFOREGROUND
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>user&lt;span style="color:#f92672">=&lt;/span>chrism
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>environment&lt;span style="color:#f92672">=&lt;/span>HOME&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/home/chrism&amp;#34;&lt;/span>,USER&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;chrism&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>supervisorctl update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>linux nvidia 获取显卡信息</title><link>https://notes.zhangwenbing.com/blog/linux/N2EsU3hZT/</link><pubDate>Thu, 04 Jun 2020 06:40:16 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/N2EsU3hZT/</guid><description>&lt;blockquote>
&lt;p>使用deviceQuery获取显卡信息&lt;/p>
&lt;/blockquote>
&lt;h2 id="环境">
 环境
 &lt;a class="anchor" href="#%e7%8e%af%e5%a2%83">#&lt;/a>
&lt;/h2>
&lt;p>Linux、nvidia、cuda&lt;/p>
&lt;h2 id="命令">
 命令
 &lt;a class="anchor" href="#%e5%91%bd%e4%bb%a4">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/usr/local/cuda/extras/demo_suite/deviceQuery
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CUDA Device Query &lt;span style="color:#f92672">(&lt;/span>Runtime API&lt;span style="color:#f92672">)&lt;/span> version &lt;span style="color:#f92672">(&lt;/span>CUDART static linking&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Detected &lt;span style="color:#ae81ff">2&lt;/span> CUDA Capable device&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Device 0: &lt;span style="color:#e6db74">&amp;#34;GeForce RTX 2080 Ti&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CUDA Driver Version / Runtime Version 10.1 / 10.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CUDA Capability Major/Minor version number: 7.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total amount of global memory: &lt;span style="color:#ae81ff">11019&lt;/span> MBytes &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#ae81ff">11554717696&lt;/span> bytes&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">(&lt;/span>68&lt;span style="color:#f92672">)&lt;/span> Multiprocessors, &lt;span style="color:#f92672">(&lt;/span> 64&lt;span style="color:#f92672">)&lt;/span> CUDA Cores/MP: &lt;span style="color:#ae81ff">4352&lt;/span> CUDA Cores
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GPU Max Clock rate: &lt;span style="color:#ae81ff">1545&lt;/span> MHz &lt;span style="color:#f92672">(&lt;/span>1.54 GHz&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Memory Clock rate: &lt;span style="color:#ae81ff">7000&lt;/span> Mhz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Memory Bus Width: 352-bit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> L2 Cache Size: &lt;span style="color:#ae81ff">5767168&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum Texture Dimension Size &lt;span style="color:#f92672">(&lt;/span>x,y,z&lt;span style="color:#f92672">)&lt;/span> 1D&lt;span style="color:#f92672">=(&lt;/span>131072&lt;span style="color:#f92672">)&lt;/span>, 2D&lt;span style="color:#f92672">=(&lt;/span>131072, 65536&lt;span style="color:#f92672">)&lt;/span>, 3D&lt;span style="color:#f92672">=(&lt;/span>16384, 16384, 16384&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum Layered 1D Texture Size, &lt;span style="color:#f92672">(&lt;/span>num&lt;span style="color:#f92672">)&lt;/span> layers 1D&lt;span style="color:#f92672">=(&lt;/span>32768&lt;span style="color:#f92672">)&lt;/span>, &lt;span style="color:#ae81ff">2048&lt;/span> layers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum Layered 2D Texture Size, &lt;span style="color:#f92672">(&lt;/span>num&lt;span style="color:#f92672">)&lt;/span> layers 2D&lt;span style="color:#f92672">=(&lt;/span>32768, 32768&lt;span style="color:#f92672">)&lt;/span>, &lt;span style="color:#ae81ff">2048&lt;/span> layers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total amount of constant memory: &lt;span style="color:#ae81ff">65536&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total amount of shared memory per block: &lt;span style="color:#ae81ff">49152&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total number of registers available per block: &lt;span style="color:#ae81ff">65536&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Warp size: &lt;span style="color:#ae81ff">32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum number of threads per multiprocessor: &lt;span style="color:#ae81ff">1024&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum number of threads per block: &lt;span style="color:#ae81ff">1024&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Max dimension size of a thread block &lt;span style="color:#f92672">(&lt;/span>x,y,z&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#f92672">(&lt;/span>1024, 1024, 64&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Max dimension size of a grid size &lt;span style="color:#f92672">(&lt;/span>x,y,z&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#f92672">(&lt;/span>2147483647, 65535, 65535&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum memory pitch: &lt;span style="color:#ae81ff">2147483647&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Texture alignment: &lt;span style="color:#ae81ff">512&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Concurrent copy and kernel execution: Yes with &lt;span style="color:#ae81ff">3&lt;/span> copy engine&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Run time limit on kernels: No
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Integrated GPU sharing Host Memory: No
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Support host page-locked memory mapping: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Alignment requirement &lt;span style="color:#66d9ef">for&lt;/span> Surfaces: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device has ECC support: Disabled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device supports Unified Addressing &lt;span style="color:#f92672">(&lt;/span>UVA&lt;span style="color:#f92672">)&lt;/span>: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device supports Compute Preemption: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Supports Cooperative Kernel Launch: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Supports MultiDevice Co-op Kernel Launch: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device PCI Domain ID / Bus ID / location ID: &lt;span style="color:#ae81ff">0&lt;/span> / &lt;span style="color:#ae81ff">1&lt;/span> / &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Compute Mode:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt; Default &lt;span style="color:#f92672">(&lt;/span>multiple host threads can use ::cudaSetDevice&lt;span style="color:#f92672">()&lt;/span> with device simultaneously&lt;span style="color:#f92672">)&lt;/span> &amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Device 1: &lt;span style="color:#e6db74">&amp;#34;GeForce RTX 2080 Ti&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CUDA Driver Version / Runtime Version 10.1 / 10.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CUDA Capability Major/Minor version number: 7.5
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total amount of global memory: &lt;span style="color:#ae81ff">11019&lt;/span> MBytes &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#ae81ff">11554717696&lt;/span> bytes&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">(&lt;/span>68&lt;span style="color:#f92672">)&lt;/span> Multiprocessors, &lt;span style="color:#f92672">(&lt;/span> 64&lt;span style="color:#f92672">)&lt;/span> CUDA Cores/MP: &lt;span style="color:#ae81ff">4352&lt;/span> CUDA Cores
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GPU Max Clock rate: &lt;span style="color:#ae81ff">1545&lt;/span> MHz &lt;span style="color:#f92672">(&lt;/span>1.54 GHz&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Memory Clock rate: &lt;span style="color:#ae81ff">7000&lt;/span> Mhz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Memory Bus Width: 352-bit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> L2 Cache Size: &lt;span style="color:#ae81ff">5767168&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum Texture Dimension Size &lt;span style="color:#f92672">(&lt;/span>x,y,z&lt;span style="color:#f92672">)&lt;/span> 1D&lt;span style="color:#f92672">=(&lt;/span>131072&lt;span style="color:#f92672">)&lt;/span>, 2D&lt;span style="color:#f92672">=(&lt;/span>131072, 65536&lt;span style="color:#f92672">)&lt;/span>, 3D&lt;span style="color:#f92672">=(&lt;/span>16384, 16384, 16384&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum Layered 1D Texture Size, &lt;span style="color:#f92672">(&lt;/span>num&lt;span style="color:#f92672">)&lt;/span> layers 1D&lt;span style="color:#f92672">=(&lt;/span>32768&lt;span style="color:#f92672">)&lt;/span>, &lt;span style="color:#ae81ff">2048&lt;/span> layers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum Layered 2D Texture Size, &lt;span style="color:#f92672">(&lt;/span>num&lt;span style="color:#f92672">)&lt;/span> layers 2D&lt;span style="color:#f92672">=(&lt;/span>32768, 32768&lt;span style="color:#f92672">)&lt;/span>, &lt;span style="color:#ae81ff">2048&lt;/span> layers
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total amount of constant memory: &lt;span style="color:#ae81ff">65536&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total amount of shared memory per block: &lt;span style="color:#ae81ff">49152&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Total number of registers available per block: &lt;span style="color:#ae81ff">65536&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Warp size: &lt;span style="color:#ae81ff">32&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum number of threads per multiprocessor: &lt;span style="color:#ae81ff">1024&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum number of threads per block: &lt;span style="color:#ae81ff">1024&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Max dimension size of a thread block &lt;span style="color:#f92672">(&lt;/span>x,y,z&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#f92672">(&lt;/span>1024, 1024, 64&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Max dimension size of a grid size &lt;span style="color:#f92672">(&lt;/span>x,y,z&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#f92672">(&lt;/span>2147483647, 65535, 65535&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Maximum memory pitch: &lt;span style="color:#ae81ff">2147483647&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Texture alignment: &lt;span style="color:#ae81ff">512&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Concurrent copy and kernel execution: Yes with &lt;span style="color:#ae81ff">3&lt;/span> copy engine&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Run time limit on kernels: No
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Integrated GPU sharing Host Memory: No
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Support host page-locked memory mapping: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Alignment requirement &lt;span style="color:#66d9ef">for&lt;/span> Surfaces: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device has ECC support: Disabled
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device supports Unified Addressing &lt;span style="color:#f92672">(&lt;/span>UVA&lt;span style="color:#f92672">)&lt;/span>: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device supports Compute Preemption: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Supports Cooperative Kernel Launch: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Supports MultiDevice Co-op Kernel Launch: Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Device PCI Domain ID / Bus ID / location ID: &lt;span style="color:#ae81ff">0&lt;/span> / &lt;span style="color:#ae81ff">2&lt;/span> / &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Compute Mode:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt; Default &lt;span style="color:#f92672">(&lt;/span>multiple host threads can use ::cudaSetDevice&lt;span style="color:#f92672">()&lt;/span> with device simultaneously&lt;span style="color:#f92672">)&lt;/span> &amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; Peer access from GeForce RTX &lt;span style="color:#ae81ff">2080&lt;/span> Ti &lt;span style="color:#f92672">(&lt;/span>GPU0&lt;span style="color:#f92672">)&lt;/span> -&amp;gt; GeForce RTX &lt;span style="color:#ae81ff">2080&lt;/span> Ti &lt;span style="color:#f92672">(&lt;/span>GPU1&lt;span style="color:#f92672">)&lt;/span> : Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;gt; Peer access from GeForce RTX &lt;span style="color:#ae81ff">2080&lt;/span> Ti &lt;span style="color:#f92672">(&lt;/span>GPU1&lt;span style="color:#f92672">)&lt;/span> -&amp;gt; GeForce RTX &lt;span style="color:#ae81ff">2080&lt;/span> Ti &lt;span style="color:#f92672">(&lt;/span>GPU0&lt;span style="color:#f92672">)&lt;/span> : Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deviceQuery, CUDA Driver &lt;span style="color:#f92672">=&lt;/span> CUDART, CUDA Driver Version &lt;span style="color:#f92672">=&lt;/span> 10.1, CUDA Runtime Version &lt;span style="color:#f92672">=&lt;/span> 10.1, NumDevs &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="源码">
 源码
 &lt;a class="anchor" href="#%e6%ba%90%e7%a0%81">#&lt;/a>
&lt;/h2>
&lt;p>&lt;a href="https://github.com/NVIDIA/cuda-samples/tree/master/Samples/deviceQuery">https://github.com/NVIDIA/cuda-samples/tree/master/Samples/deviceQuery&lt;/a>&lt;/p></description></item><item><title>mediainfo 静态编译脚本</title><link>https://notes.zhangwenbing.com/blog/linux/roH7hpe6L/</link><pubDate>Tue, 13 Aug 2019 01:38:19 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/roH7hpe6L/</guid><description>&lt;blockquote>
&lt;p>因为需要mediainfo支持http协议，在老的版本中是不支持的，所以只能自己动手编译了。&lt;/p>
&lt;/blockquote>
&lt;h2 id="说明">
 说明
 &lt;a class="anchor" href="#%e8%af%b4%e6%98%8e">#&lt;/a>
&lt;/h2>
&lt;p>系统：ubuntu 14.04 (其他版本可能会有少许改动)&lt;/p></description></item><item><title>ssh免秘钥登陆常见问题</title><link>https://notes.zhangwenbing.com/blog/linux/RRaHkWbSu/</link><pubDate>Fri, 02 Aug 2019 02:04:27 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/RRaHkWbSu/</guid><description>&lt;blockquote>
&lt;p>收集一些ssh登陆常见的问题，方便快速解决问题。&lt;/p>
&lt;/blockquote>
&lt;h2 id="重要事情">
 重要事情
 &lt;a class="anchor" href="#%e9%87%8d%e8%a6%81%e4%ba%8b%e6%83%85">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>cat /var/log/secure
cat /var/log/message
&lt;/code>&lt;/pre>&lt;p>无论你遇到任何奇葩的sshd问题，你先执行上面的命令查看下日志。&lt;/p>
&lt;h2 id="错误一">
 错误一
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e4%b8%80">#&lt;/a>
&lt;/h2>
&lt;h3 id="问题描述">
 问题描述
 &lt;a class="anchor" href="#%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>Authentication refused:bad ownership or modes for dircetory /root
&lt;/code>&lt;/pre>&lt;h3 id="解决方法">
 解决方法
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>chmod 700 /root
&lt;/code>&lt;/pre>&lt;h3 id="其他相关">
 其他相关
 &lt;a class="anchor" href="#%e5%85%b6%e4%bb%96%e7%9b%b8%e5%85%b3">#&lt;/a>
&lt;/h3>
&lt;p>id_ras 权限为600&lt;/p></description></item><item><title>openssl - https SAN自签名证书</title><link>https://notes.zhangwenbing.com/blog/linux/JQIo7dGc1/</link><pubDate>Tue, 02 Jul 2019 12:15:46 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/JQIo7dGc1/</guid><description>&lt;blockquote>
&lt;p>使用openssl生产自签名证书，用于https测试。&lt;/p>
&lt;/blockquote>
&lt;h2 id="ca根证书制作">
 CA根证书制作
 &lt;a class="anchor" href="#ca%e6%a0%b9%e8%af%81%e4%b9%a6%e5%88%b6%e4%bd%9c">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>#1.生成根证书密钥
$ openssl genrsa -out ca.key 4096 #建议长度为4096,1024长度已经被列为不安全。
#2.生成自签名根证书
$ openssl req -new -x509 -days 3650 -key ca.key -out ca.crt #这里在输入CommonName的时候输入名称而不是域名或者ip,就是证书上显示的颁发者，虽然是自签名证书，但是尽量让证书看起来标准一些
&lt;/code>&lt;/pre>&lt;h2 id="使用根证书来签名其它证书">
 使用根证书来签名其它证书
 &lt;a class="anchor" href="#%e4%bd%bf%e7%94%a8%e6%a0%b9%e8%af%81%e4%b9%a6%e6%9d%a5%e7%ad%be%e5%90%8d%e5%85%b6%e5%ae%83%e8%af%81%e4%b9%a6">#&lt;/a>
&lt;/h2>
&lt;h3 id="1生成证书密钥">
 &lt;strong>1.生成证书密钥&lt;/strong>
 &lt;a class="anchor" href="#1%e7%94%9f%e6%88%90%e8%af%81%e4%b9%a6%e5%af%86%e9%92%a5">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>$ openssl genrsa -out server.key 4096
&lt;/code>&lt;/pre>&lt;h2 id="2-subject-alt-namesan">
 &lt;strong>2. Subject Alt Name(SAN)&lt;/strong>
 &lt;a class="anchor" href="#2-subject-alt-namesan">#&lt;/a>
&lt;/h2>
&lt;p>高版本的Chrome浏览器会要求设置 &lt;code>subjectAltName&lt;/code>,如果没有设置SAN会报证书错误&lt;/p></description></item><item><title>Centos7-yum安装MySQL5.6</title><link>https://notes.zhangwenbing.com/blog/linux/yhK4y-gaU/</link><pubDate>Thu, 27 Jun 2019 01:22:50 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/yhK4y-gaU/</guid><description>&lt;blockquote>
&lt;p>centos自带的repo是不会自动更新每个软件的新版本，所以无法通过yum方式安装MySQL的高版本，所以一般通过社区rpm包安装。&lt;/p>
&lt;/blockquote>
&lt;h2 id="安装yum源">
 安装yum源
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85yum%e6%ba%90">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm
&lt;/code>&lt;/pre>&lt;h2 id="查看mysql安装源">
 查看mysql安装源
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8bmysql%e5%ae%89%e8%a3%85%e6%ba%90">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>yum repolist enabled | grep &amp;#34;mysql.*-community.*&amp;#34;
&lt;/code>&lt;/pre>&lt;h2 id="安装mysql56">
 安装mysql56
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85mysql56">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>yum -y install mysql-community-server
&lt;/code>&lt;/pre>&lt;h2 id="开机启动">
 开机启动
 &lt;a class="anchor" href="#%e5%bc%80%e6%9c%ba%e5%90%af%e5%8a%a8">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>systemctl enable mysqld
&lt;/code>&lt;/pre>&lt;h2 id="启动服务">
 启动服务
 &lt;a class="anchor" href="#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>systemctl start mysqld
&lt;/code>&lt;/pre>&lt;h2 id="重置密码">
 重置密码
 &lt;a class="anchor" href="#%e9%87%8d%e7%bd%ae%e5%af%86%e7%a0%81">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL
 SERVERS IN PRODUCTION USE! PLEASE READ EACH STEP CAREFULLY!

In order to log into MySQL to secure it, we&amp;#39;ll need the current
password for the root user. If you&amp;#39;ve just installed MySQL, and
you haven&amp;#39;t set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none):
ERROR 1045 (28000): Access denied for user &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; (using password: YES)
Enter current password for root (enter for none):
ERROR 1045 (28000): Access denied for user &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; (using password: YES)
Enter current password for root (enter for none):
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MySQL
root user without the proper authorisation.

Set root password? [Y/n] y
New password:
Re-enter new password:
Password updated successfully!
Reloading privilege tables..
 ... Success!

By default, a MySQL installation has an anonymous user, allowing anyone
to log into MySQL without having to have a user account created for
them. This is intended only for testing, and to make the installation
go a bit smoother. You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] Y
 ... Success!

Normally, root should only be allowed to connect from &amp;#39;localhost&amp;#39;. This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] n
 ... skipping.

By default, MySQL comes with a database named &amp;#39;test&amp;#39; that anyone can
access. This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] n
 ... skipping.

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] Y
 ... Success!

All done! If you&amp;#39;ve completed all of the above steps, your MySQL
installation should now be secure.

Thanks for using MySQL!

Cleaning up...
&lt;/code>&lt;/pre></description></item><item><title>supervisor 安装和使用方法</title><link>https://notes.zhangwenbing.com/blog/linux/B1G3FwCaN/</link><pubDate>Fri, 31 May 2019 09:20:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1G3FwCaN/</guid><description>&lt;blockquote>
&lt;p>Supervisor是用Python开发的一套通用的进程管理程序，能将一个普通的命令行进程变为后台daemon，并监控进程状态，异常退出时能自动重启。&lt;/p></description></item><item><title>error while loading shared libraries: libc.so.6: cannot open shared object file: No such file or directory</title><link>https://notes.zhangwenbing.com/blog/linux/HkCTnskvV/</link><pubDate>Fri, 08 Mar 2019 09:24:10 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HkCTnskvV/</guid><description>&lt;blockquote>
&lt;p>不小心误删libc.so.6&lt;/p>
&lt;/blockquote>
&lt;p>安装完成后, 建立软链指向glibc-2.14, 执行如下命令:&lt;/p>
&lt;pre tabindex="0">&lt;code>$ rm -rf /lib64/libc.so.6
&lt;/code>&lt;/pre>&lt;p>// 先删除先前的libc.so.6软链&lt;/p>
&lt;pre tabindex="0">&lt;code>$ ln -s /opt/glibc-2.14/lib/libc-2.14.so /lib64/libc.so.6
&lt;/code>&lt;/pre>&lt;p>注意：删除libc.so.6之后可能导致系统命令不可用的情况, 可使用如下方法解决:&lt;/p></description></item><item><title>yum错误:problem making ssl connection Trying other mirror</title><link>https://notes.zhangwenbing.com/blog/linux/rk-lmMGL4/</link><pubDate>Tue, 26 Feb 2019 01:20:26 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rk-lmMGL4/</guid><description>&lt;blockquote>
&lt;p>yum无法使用带https的源&lt;/p>
&lt;/blockquote>
&lt;h2 id="环境">
 环境
 &lt;a class="anchor" href="#%e7%8e%af%e5%a2%83">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>yum install epel-release
&lt;/code>&lt;/pre>&lt;p>运行以上命令之后，安装其他软件就报错。&lt;/p>
&lt;h2 id="错误提示">
 错误提示
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e6%8f%90%e7%a4%ba">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>[Errno 14] problem making ssl connection Trying other mirror.
Trying other mirror
Error: Cannot retrieve repository metadata (repomd.xml) for repository: xxxx. Please verify its path and try again
&lt;/code>&lt;/pre>&lt;p>经过google查询，发现似乎是ssl证书的原因。&lt;/p></description></item><item><title>CentOS7 php5.6 编译安装amqp扩展</title><link>https://notes.zhangwenbing.com/blog/linux/H10_K-VQ4/</link><pubDate>Tue, 22 Jan 2019 03:21:18 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H10_K-VQ4/</guid><description>&lt;blockquote>
&lt;p>php 安装最新rabbitmq扩展&lt;/p>
&lt;/blockquote>
&lt;h2 id="1安装编译环境">
 1、安装编译环境
 &lt;a class="anchor" href="#1%e5%ae%89%e8%a3%85%e7%bc%96%e8%af%91%e7%8e%af%e5%a2%83">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum install cmake gcc gcc-c++ make openssl-devel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="2安装rabbitmq-c">
 2、安装rabbitmq-c
 &lt;a class="anchor" href="#2%e5%ae%89%e8%a3%85rabbitmq-c">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wget https://github.com/alanxz/rabbitmq-c/archive/v0.9.0.zip
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>unzip v0.9.0.zip
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd rabbitmq-c-0.9.0/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cmake -DCMAKE_INSTALL_PREFIX&lt;span style="color:#f92672">=&lt;/span>/usr/local/rabbitmq-c-0.9.0/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>make &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> make install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="3安装amqp">
 3、安装amqp
 &lt;a class="anchor" href="#3%e5%ae%89%e8%a3%85amqp">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wget http://pecl.php.net/get/amqp-1.9.4.tgz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tar zxf amqp-1.9.4.tgz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd amqp-1.9.4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/usr/bin/phpize
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>./configure --with-php-config&lt;span style="color:#f92672">=&lt;/span>/usr/bin/php-config --with-amqp --with-librabbitmq-dir&lt;span style="color:#f92672">=&lt;/span>/usr/local/rabbitmq-c-0.9.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#由于rabbitmq-c编译出来的lib目录是lib64，所以我们要做一些小的修改&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim Makefile
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#将 AMQP_SHARED_LIBADD = -Wl,-rpath,/usr/local/rabbitmq-c-0.9.0/lib -L/usr/local/rabbitmq-c-0.9.0/lib -lrabbitmq&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#修改为 AMQP_SHARED_LIBADD = -Wl,-rpath,/usr/local/rabbitmq-c-0.9.0/lib64 -L/usr/local/rabbitmq-c-0.9.0/lib64 -lrabbitmq&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>make &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> make install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="4phpini-添加模块">
 4、php.ini 添加模块
 &lt;a class="anchor" href="#4phpini-%e6%b7%bb%e5%8a%a0%e6%a8%a1%e5%9d%97">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vi /usr/local/php/etc/php.ini
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#增加&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>extension &lt;span style="color:#f92672">=&lt;/span> /usr/lib64/php/modules/amqp.so
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="5重启服务">
 5、重启服务
 &lt;a class="anchor" href="#5%e9%87%8d%e5%90%af%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>systemctl restart php-fpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>hadoop下载文件遇到的坑</title><link>https://notes.zhangwenbing.com/blog/linux/S1wDPAKf4/</link><pubDate>Mon, 14 Jan 2019 09:38:20 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/S1wDPAKf4/</guid><description>&lt;blockquote>
&lt;p>hadoop fs -get 下载带特殊字符文件失败的一些解决方法。&lt;/p>
&lt;/blockquote>
&lt;h2 id="错误范例">
 错误范例
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e8%8c%83%e4%be%8b">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>hadoop fs -get &amp;#34;/xxx/xxx分类/动漫Y/2005/蓝猫淘气3000问 航天系列（太空历险记）/第363集 协议.ts&amp;#34; &amp;#34;/media/bak/媒资源素材分类/动漫Y/2005/蓝猫淘气3000问 航天系列（太空历险记）/第363集 协议.ts&amp;#34;
&lt;/code>&lt;/pre>&lt;p>运行以上命令就报“unexpexted URISyntaxException”&lt;/p></description></item><item><title>linux-iftop实时流量监控</title><link>https://notes.zhangwenbing.com/blog/linux/B1rSV2FzE/</link><pubDate>Mon, 14 Jan 2019 07:06:13 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1rSV2FzE/</guid><description>&lt;blockquote>
&lt;p>iftop是类似于top的实时流量监控工具。可以用来监控网卡的实时流量（可以指定网段）、反向解析IP、显示端口信息等。&lt;/p>
&lt;/blockquote>
&lt;h2 id="安装">
 安装
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85">#&lt;/a>
&lt;/h2>
&lt;p>Debian/Ubuntu/Deepin：&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo apt update
sudo apt -y install iftop
&lt;/code>&lt;/pre>&lt;p>CentOS/RHEL：&lt;/p></description></item><item><title>Centos7+Python2.7下yum安装软件报错解决办法</title><link>https://notes.zhangwenbing.com/blog/linux/H1xaQL3-N/</link><pubDate>Fri, 04 Jan 2019 03:42:18 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H1xaQL3-N/</guid><description>&lt;blockquote>
&lt;p>yum安装软件报错，但可以下载文件。&lt;/p>
&lt;/blockquote>
&lt;h2 id="错误信息">
 错误信息
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>Downloading packages:
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
Traceback (most recent call last):
 File &amp;#34;/usr/bin/yum&amp;#34;, line 29, in &amp;lt;module&amp;gt;
 yummain.user_main(sys.argv[1:], exit_code=True)
 File &amp;#34;/usr/share/yum-cli/yummain.py&amp;#34;, line 365, in user_main
 errcode = main(args)
 File &amp;#34;/usr/share/yum-cli/yummain.py&amp;#34;, line 271, in main
 return_code = base.doTransaction()
 File &amp;#34;/usr/share/yum-cli/cli.py&amp;#34;, line 773, in doTransaction
 resultobject = self.runTransaction(cb=cb)
 File &amp;#34;/usr/lib/python2.7/site-packages/yum/__init__.py&amp;#34;, line 1736, in runTransaction
 if self.fssnap.available and ((self.conf.fssnap_automatic_pre or
 File &amp;#34;/usr/lib/python2.7/site-packages/yum/__init__.py&amp;#34;, line 1126, in &amp;lt;lambda&amp;gt;
 fssnap = property(fget=lambda self: self._getFSsnap(),
 File &amp;#34;/usr/lib/python2.7/site-packages/yum/__init__.py&amp;#34;, line 1062, in _getFSsnap
 devices=devices)
 File &amp;#34;/usr/lib/python2.7/site-packages/yum/fssnapshots.py&amp;#34;, line 158, in __init__
 self._vgnames = _list_vg_names() if self.available else []
 File &amp;#34;/usr/lib/python2.7/site-packages/yum/fssnapshots.py&amp;#34;, line 56, in _list_vg_names
 names = lvm.listVgNames()
lvm.LibLVMError: (0, &amp;#39;&amp;#39;)
&lt;/code>&lt;/pre>&lt;h2 id="解决方法">
 解决方法
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>mkdir /tmp/down/
yum install --downloadonly --downloaddir=/tmp/down/ yum
cd /tmp/down/
rpm -Uvh *

yum clean metadata
yum clean all
&lt;/code>&lt;/pre></description></item><item><title>记一次时间同步引起的故障</title><link>https://notes.zhangwenbing.com/blog/linux/B11j0sF-N/</link><pubDate>Wed, 02 Jan 2019 04:24:43 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B11j0sF-N/</guid><description>&lt;blockquote>
&lt;p>ntpdate同步时间，时间跳跃，引起服务中断。&lt;/p>
&lt;/blockquote>
&lt;h2 id="计划任务">
 计划任务
 &lt;a class="anchor" href="#%e8%ae%a1%e5%88%92%e4%bb%bb%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>0 4 * * * /usr/sbin/ntpdate 10.200.3.71
&lt;/code>&lt;/pre>&lt;h2 id="日志">
 日志
 &lt;a class="anchor" href="#%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>Dec 30 04:00:01 localhost systemd: Created slice user-0.slice.
Dec 30 04:00:01 localhost systemd: Starting user-0.slice.
Dec 30 04:00:01 localhost systemd: Started Session 16 of user root.
Dec 30 04:00:01 localhost systemd: Starting Session 16 of user root.
Dec 29 20:09:59 localhost systemd: Time has been changed
Dec 29 20:09:59 localhost systemd: Removed slice user-0.slice.
Dec 29 20:09:59 localhost systemd: Stopping user-0.slice.
&lt;/code>&lt;/pre>&lt;h2 id="故障">
 故障
 &lt;a class="anchor" href="#%e6%95%85%e9%9a%9c">#&lt;/a>
&lt;/h2>
&lt;p>因为跳跃的时间太大，导致系统的各种服务中断（网络中断和systemctl管理的服务也有问题）。&lt;/p></description></item><item><title>solr7.3.1单机版添加core</title><link>https://notes.zhangwenbing.com/blog/linux/SJ10UoTom/</link><pubDate>Wed, 24 Oct 2018 08:07:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SJ10UoTom/</guid><description>&lt;blockquote>
&lt;p>Solr是一个独立的企业级搜索应用服务器，它对外提供类似于Web-service的API接口。用户可以通过http请求，向搜索引擎服务器提交一定格式的XML文件，生成索引；也可以通过Http Get操作提出查找请求，并得到XML格式的返回结果。&lt;/p></description></item><item><title>solr-7.3.1 单机安装教程</title><link>https://notes.zhangwenbing.com/blog/linux/BkKKGWnsQ/</link><pubDate>Tue, 23 Oct 2018 02:26:38 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/BkKKGWnsQ/</guid><description>&lt;blockquote>
&lt;p>Solr是一个独立的企业级搜索应用服务器，它对外提供类似于Web-service的API接口。用户可以通过http请求，向搜索引擎服务器提交一定格式的XML文件，生成索引；也可以通过Http Get操作提出查找请求，并得到XML格式的返回结果。&lt;/p></description></item><item><title>解决rabbitmq依赖问题</title><link>https://notes.zhangwenbing.com/blog/linux/HJJ4wWwim/</link><pubDate>Fri, 19 Oct 2018 07:30:49 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HJJ4wWwim/</guid><description>&lt;blockquote>
&lt;p>MQ全称为Message Queue, 消息队列（MQ）是一种应用程序对应用程序的通信方法。&lt;/p>
&lt;/blockquote>
&lt;h2 id="错误提示">
 错误提示
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e6%8f%90%e7%a4%ba">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>warning: rabbitmq-server-3.6.6-1.el6.noarch.rpm: Header V4 RSA/SHA1 Signature, key ID 6026dfca: NOKEYerror: Failed dependencies:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> erlang &amp;gt;&lt;span style="color:#f92672">=&lt;/span> R16B-03 is needed by rabbitmq-server-3.6.6-1.el6.noarch
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> socat is needed by rabbitmq-server-3.6.6-1.el6.noarch
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="解决方法">
 解决方法
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /etc/yum.repos.d/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cat erlang.repo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>erlang-solutions&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&lt;span style="color:#f92672">=&lt;/span>Centos $releasever - $basearch - Erlang Solutions
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>baseurl&lt;span style="color:#f92672">=&lt;/span>http://packages.erlang-solutions.com/rpm/centos/$releasever/$basearch
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgcheck&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>gpgkey&lt;span style="color:#f92672">=&lt;/span>http://packages.erlang-solutions.com/debian/erlang_solutions.asc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>enabled&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后再安装rabbitmq&lt;/p></description></item><item><title>grafana重置管理员密码</title><link>https://notes.zhangwenbing.com/blog/linux/SJWuUJwsQ/</link><pubDate>Fri, 19 Oct 2018 05:13:46 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SJWuUJwsQ/</guid><description>&lt;blockquote>
&lt;p>Grafana是一个可视化面板（Dashboard），有着非常漂亮的图表和布局展示，功能齐全的度量仪表盘和图形编辑器，支持Graphite、zabbix、InfluxDB、Prometheus和OpenTSDB作为数据源。Grafana主要特性：灵活丰富的图形化选项；可以混合多种风格；支持白天和夜间模式；多个数据源。&lt;/p></description></item><item><title>Linux bash 提取文件名和目录名</title><link>https://notes.zhangwenbing.com/blog/linux/SJyvgQAOm/</link><pubDate>Tue, 18 Sep 2018 07:01:06 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SJyvgQAOm/</guid><description>&lt;blockquote>
&lt;p>在Linux Bash中分别使用basename、dirname、${}，提取文件名和目录名。&lt;/p>
&lt;/blockquote>
&lt;h2 id="通过变量方式">
 通过变量方式
 &lt;a class="anchor" href="#%e9%80%9a%e8%bf%87%e5%8f%98%e9%87%8f%e6%96%b9%e5%bc%8f">#&lt;/a>
&lt;/h2>
&lt;p>${}用于字符串的读取，提取和替换功能，可以使用${} 提取字符串&lt;/p></description></item><item><title>nginx auth_basic登录验证遇到的坑</title><link>https://notes.zhangwenbing.com/blog/linux/ByaB7yPSQ/</link><pubDate>Tue, 07 Aug 2018 09:26:11 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/ByaB7yPSQ/</guid><description>&lt;blockquote>
&lt;p>htpasswd默认使用crypt()加密，创建的密码只有前8位有效&lt;/p>
&lt;/blockquote>
&lt;h2 id="问题">
 问题
 &lt;a class="anchor" href="#%e9%97%ae%e9%a2%98">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>htpasswd -c /etc/nginx/.htpasswd test
&lt;/code>&lt;/pre>&lt;p>假如，密码为abcd12345&lt;/p>
&lt;p>那么在登录的时候，不管是输入“abcd1234”、”abcd12345“或”abcd123456789sdjkal“ 都能通过验证。&lt;/p></description></item><item><title>solr oom_killer</title><link>https://notes.zhangwenbing.com/blog/linux/rJa7oi0EQ/</link><pubDate>Wed, 01 Aug 2018 04:18:18 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rJa7oi0EQ/</guid><description>&lt;blockquote>
&lt;p>记录oom_solr触发的问题分析及解决方法&lt;/p>
&lt;/blockquote>
&lt;p>昨天在测试solr_cloud的时候，看到$solr_home/logs下面有一个这样的日志&lt;/p>
&lt;pre tabindex="0">&lt;code>solr_oom_killer-8983-2018-07-31_10_45_56.log
&lt;/code>&lt;/pre>&lt;p>刚开始还以为是Linux系统的oom_killer,然后在/var/log/message中找日志，发现没有，当时就奇怪了，触发了oom_killer但是没记录日志？于是经过一番折腾终于发现问题了。&lt;/p></description></item><item><title>centos6 heartbeat双机热备</title><link>https://notes.zhangwenbing.com/blog/linux/Skl7i90EQ/</link><pubDate>Wed, 01 Aug 2018 02:54:29 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/Skl7i90EQ/</guid><description>&lt;blockquote>
&lt;p>heartbeat （Linux-HA）的工作原理：heartbeat最核心的包括两个部分，心跳监测部分和资源接管部分，心跳监测可以通过网络链路和串口进行，而且支持冗 余链路，它们之间相互发送报文来告诉对方自己当前的状态，如果在指定的时间内未收到对方发送的报文，那么就认为对方失效，这时需启动资源接管模块来接管运 行在对方主机上的资源或者服务。&lt;/p></description></item><item><title>solrcloud上传配置文件</title><link>https://notes.zhangwenbing.com/blog/linux/S1ywxQEN7/</link><pubDate>Tue, 24 Jul 2018 04:15:05 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/S1ywxQEN7/</guid><description>&lt;blockquote>
&lt;p>使用solr自带的工具zkcli.sh上传配置文件&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>chmod +x /opt/solr/server/scripts/cloud-scripts/zkcli.sh
cp -r /opt/solr-7.3.1/server/solr/configsets/_default/conf /opt/solr-7.3.1/server/solr/_test1b/
/opt/solr/server/scripts/cloud-scripts/zkcli.sh -cmd upconfig -zkhost 10.1.201.49:2181,10.1.201.50:2181 -confname test1b -confdir /opt/solr-7.3.1/server/solr/_test1b/
&lt;/code>&lt;/pre>&lt;p>复制的时候一定要复制server/solr/configsets/_default/conf目录，而不是server/solr/configsets/_default&lt;/p></description></item><item><title>Schema Parsing Failed: unknown field id [Zookeeper, SolrCloud]</title><link>https://notes.zhangwenbing.com/blog/linux/HkgnaWVNm/</link><pubDate>Tue, 24 Jul 2018 02:31:15 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HkgnaWVNm/</guid><description>&lt;blockquote>
&lt;p>不小心删除solr的主键id，导致报错Schema Parsing Failed: unknown field ‘id’&lt;/p>
&lt;/blockquote>
&lt;h2 id="问题描述">
 问题描述
 &lt;a class="anchor" href="#%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0">#&lt;/a>
&lt;/h2>
&lt;p>Schema Parsing Failed: unknown field ‘id’&lt;/p>
&lt;h2 id="解决方法">
 解决方法
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;p>关闭zookeeper、solr服务并删除zookeeper数据，然后重新启动zookeeper、solr服务。&lt;/p></description></item><item><title>Nginx的connect() to xxx failed (13: Permission denied) 和 Nginx 403 forbidden</title><link>https://notes.zhangwenbing.com/blog/linux/HJlvWaG47/</link><pubDate>Mon, 23 Jul 2018 02:53:40 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HJlvWaG47/</guid><description>&lt;blockquote>
&lt;p>解决Nginx的connect() to xxx failed (13: Permission denied) 和 Nginx 403 forbidden 错误&lt;/p>
&lt;/blockquote>
&lt;h2 id="查看selinux状态">
 查看SeLinux状态
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8bselinux%e7%8a%b6%e6%80%81">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>getenforce
&lt;/code>&lt;/pre>&lt;p>如果是enabled则继续往下看。&lt;/p>
&lt;h2 id="临时关闭不需要重启机器">
 临时关闭（不需要重启机器）
 &lt;a class="anchor" href="#%e4%b8%b4%e6%97%b6%e5%85%b3%e9%97%ad%e4%b8%8d%e9%9c%80%e8%a6%81%e9%87%8d%e5%90%af%e6%9c%ba%e5%99%a8">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>setenforce 0
&lt;/code>&lt;/pre>&lt;h2 id="修改配置">
 修改配置
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>vim /etc/selinux/config #将SELINUX=enforcing改为SELINUX=disabled
&lt;/code>&lt;/pre>&lt;p>如果你执行了临时关闭SeLinux并机器上跑了重要的业务，那可以不需要马上重启机器，等待下次重启配置生效即可。&lt;/p></description></item><item><title>删除除link(软连接)对应的文件以外的所有文件</title><link>https://notes.zhangwenbing.com/blog/linux/H10wzCxGX/</link><pubDate>Wed, 27 Jun 2018 09:08:21 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H10wzCxGX/</guid><description>&lt;blockquote>
&lt;p>使用find和readlink删除除link(软连接)对应的文件以外的所有文件，一般用于自动删除日志文件。&lt;/p>
&lt;/blockquote>
&lt;h2 id="脚本">
 脚本
 &lt;a class="anchor" href="#%e8%84%9a%e6%9c%ac">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>#!/bin/bash

linkArr=`find $1 -type l -exec readlink {} \;`
fileArr=`find $1 -type f -name &amp;#34;*${2}*&amp;#34;`

for f in $fileArr;do
 isLink=false
 for l in $linkArr;do
 #判断当前文件是否为link对应的文件
 if [ &amp;#34;${f##*/}&amp;#34; == &amp;#34;$l&amp;#34; ];then
 isLink=true
 break
 fi
 done
 if [ $isLink == false ];then
 rm -f $f
 fi
done
&lt;/code>&lt;/pre>&lt;h2 id="说明">
 说明
 &lt;a class="anchor" href="#%e8%af%b4%e6%98%8e">#&lt;/a>
&lt;/h2>
&lt;h3 id="功能">
 功能
 &lt;a class="anchor" href="#%e5%8a%9f%e8%83%bd">#&lt;/a>
&lt;/h3>
&lt;p>删除除link对应的文件以外的所有文件&lt;/p></description></item><item><title>centos 6 搭建 SolrCloud 7.3.1 集群服务</title><link>https://notes.zhangwenbing.com/blog/linux/S1cZ9qilm/</link><pubDate>Mon, 11 Jun 2018 07:10:59 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/S1cZ9qilm/</guid><description>&lt;blockquote>
&lt;p>Solr是一个独立的企业级搜索应用服务器，它对外提供类似于Web-service的API接口。用户可以通过http请求，向搜索引擎服务器提交一定格式的XML文件，生成索引；也可以通过Http Get操作提出查找请求，并得到XML格式的返回结果。&lt;/p></description></item><item><title>Mediainfo开启http ftp支持</title><link>https://notes.zhangwenbing.com/blog/linux/H1BwMFoy7/</link><pubDate>Wed, 30 May 2018 01:48:13 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H1BwMFoy7/</guid><description>&lt;blockquote>
&lt;p>Libcurl support is disabled due to compilation options&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>./CLI_Compile.sh --with-libcurl
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>centos7 rdate 时间同步服务</title><link>https://notes.zhangwenbing.com/blog/linux/rJY7U8E9U0z/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rJY7U8E9U0z/</guid><description>&lt;h2 id="安装软件">
 安装软件
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85%e8%bd%af%e4%bb%b6">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum install -y xinetd rdate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="修改配制">
 修改配制
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e9%85%8d%e5%88%b6">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/xinetd.d/time-stream
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 将disable = yes 改为 disable = no&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="启动服务">
 启动服务
 &lt;a class="anchor" href="#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 启动xinetd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl start xinetd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 添加开启启动&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl enable xinetd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="同步时间">
 同步时间
 &lt;a class="anchor" href="#%e5%90%8c%e6%ad%a5%e6%97%b6%e9%97%b4">#&lt;/a>
&lt;/h2>
&lt;h3 id="服务端">
 服务端
 &lt;a class="anchor" href="#%e6%9c%8d%e5%8a%a1%e7%ab%af">#&lt;/a>
&lt;/h3>
&lt;p>首先在服务端执行以下命令（到底哪个是服务端呢？就是你在哪台机器上面执行了以上三个步骤就是服务端），在服务端上同步网络标准时间，然后再同步到内网各台机器上。&lt;/p></description></item><item><title>centos7 双ip策略路由配置方法</title><link>https://notes.zhangwenbing.com/blog/linux/HyEL84qI0M/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HyEL84qI0M/</guid><description>&lt;blockquote>
&lt;p>服务器配置多网卡多网关时，为了避免时不时的去添加相关回程路由，因此需要配置一下策略路由。&lt;/p>
&lt;/blockquote>
&lt;p>原文地址 &lt;a href="https://blog.csdn.net/pyxllq/article/details/105817064">blog.csdn.net&lt;/a>&lt;/p>
&lt;p>服务器系统版本：CentOS Linux release 7.3.1611&lt;/p>
&lt;h2 id="1添加路由表">
 1.添加路由表
 &lt;a class="anchor" href="#1%e6%b7%bb%e5%8a%a0%e8%b7%af%e7%94%b1%e8%a1%a8">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vi /etc/iproute2/rt_tables
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>101     innerRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>102     globalRoute
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="2-添加路由配置脚本">
 2. 添加路由配置脚本
 &lt;a class="anchor" href="#2-%e6%b7%bb%e5%8a%a0%e8%b7%af%e7%94%b1%e9%85%8d%e7%bd%ae%e8%84%9a%e6%9c%ac">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ip route flush table globalRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip rule add dev eth1 table globalRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> ! ip rule show | grep x.x.x.x ; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ip rule add from x.x.x.x table globalRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip route add default via y.y.y.y dev eth1 table globalRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip route flush table innerRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip rule add dev eth2 table innerRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> ! ip rule show | grep 172.16.x.x ; &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ip rule add from 172.16.x.x table innerRoute
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ip route add default via 172.16.y.y dev eth2 table innerRoute
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上面 x.x.x.x 是配置在网口 eth1 上的 ip，y.y.y.y 是该 ip 的网关，172.16.x.x 是 eth2 的 ip，我这里是内网 ip，172.16.y.y 是 172 网关的网关。&lt;/p></description></item><item><title>centos7 修改内核引导顺序</title><link>https://notes.zhangwenbing.com/blog/linux/rytGLI49LCf/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rytGLI49LCf/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="查看内核">
 查看内核
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e5%86%85%e6%a0%b8">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>cat /boot/grub2/grub.cfg |grep menuentry

menuentry &amp;#39;CentOS Linux (3.10.0-327.36.3.el7.x86_64) 7 (Core)&amp;#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option &amp;#39;gnulinux-3.10.0-327.el7.x86_64-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97&amp;#39; {
menuentry &amp;#39;CentOS Linux (3.10.0-327.22.2.el7.x86_64) 7 (Core)&amp;#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option &amp;#39;gnulinux-3.10.0-327.el7.x86_64-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97&amp;#39; {
menuentry &amp;#39;CentOS Linux (3.10.0-327.el7.x86_64) 7 (Core)&amp;#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option &amp;#39;gnulinux-3.10.0-327.el7.x86_64-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97&amp;#39; {
menuentry &amp;#39;CentOS Linux (0-rescue-7d26c16f128042a684ea474c9e2c240f) 7 (Core)&amp;#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option &amp;#39;gnulinux-0-rescue-7d26c16f128042a684ea474c9e2c240f-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97&amp;#39;
&lt;/code>&lt;/pre>&lt;h2 id="修改默认">
 修改默认
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e9%bb%98%e8%ae%a4">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>grub2-set-default &amp;#34;CentOS Linux (3.10.0-327.22.2.el7.x86_64) 7 (Core)&amp;#34;
&lt;/code>&lt;/pre>&lt;h2 id="查看生效">
 查看生效
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e7%94%9f%e6%95%88">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>grub2-editenv list
saved_entry=CentOS Linux (3.10.0-327.22.2.el7.x86_64) 7 (Core)
&lt;/code>&lt;/pre></description></item><item><title>Centos7搭建vpn</title><link>https://notes.zhangwenbing.com/blog/linux/B1AMUL45ICM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1AMUL45ICM/</guid><description>&lt;h2 id="准备环境">
 准备环境
 &lt;a class="anchor" href="#%e5%87%86%e5%a4%87%e7%8e%af%e5%a2%83">#&lt;/a>
&lt;/h2>
&lt;h3 id="首先查看系统是否支持pptpd服务">
 首先查看系统是否支持pptpd服务：
 &lt;a class="anchor" href="#%e9%a6%96%e5%85%88%e6%9f%a5%e7%9c%8b%e7%b3%bb%e7%bb%9f%e6%98%af%e5%90%a6%e6%94%af%e6%8c%81pptpd%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>modprobe ppp-compress-18 &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> echo yes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="安装ppp--pptpdiptables">
 安装ppp , pptpd，iptables
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85ppp--pptpdiptables">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum install -y ppp pptpd iptables
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl mask firewalld
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl stop firewalld
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="修改配制">
 修改配制
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e9%85%8d%e5%88%b6">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vi /etc/pptpd.conf &lt;span style="color:#75715e">#找到配制文件中默认的值，去掉注释即可&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>localip 192.168.0.1 &lt;span style="color:#75715e">#本机VPN IP&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>remoteip 192.168.0.234-238,192.168.0.245 客户端可以获取到的ip网段
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#修改DNS&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vi /etc/ppp/options.pptpd &lt;span style="color:#75715e">#末尾添加dns&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ms-dns 8.8.8.8
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ms-dns 114.114.114.114
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#添加vpn账户&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vi /etc/ppp/chap-secrets
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># client server secret IP addresses&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> user pptpd passwd *
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#开启路由转发&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vi /etc/sysctl.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>net.ipv4.ip_forward &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#75715e">#添加在配制文件的末尾即可&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sysctl -p &lt;span style="color:#75715e">#运行这个命令会输出上面添加的那一行信息，意思是使内核修改生效&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#在防火墙上开启nat转发&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE &lt;span style="color:#75715e">#IP和网口根据实际情况修改即可&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="开启服务">
 开启服务
 &lt;a class="anchor" href="#%e5%bc%80%e5%90%af%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>service iptables save
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl restart iptables
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>systemctl restart pptpd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Centos多网卡绑定(bonding)</title><link>https://notes.zhangwenbing.com/blog/linux/rJFUIE5I0G/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rJFUIE5I0G/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="内核模块">
 内核模块
 &lt;a class="anchor" href="#%e5%86%85%e6%a0%b8%e6%a8%a1%e5%9d%97">#&lt;/a>
&lt;/h2>
&lt;p>通过modinfo bonding命令查看Linux是否支持bonding&lt;/p>
&lt;pre tabindex="0">&lt;code>lsmod |grep bonding
#载入bonding模块
modprobe bonding
&lt;/code>&lt;/pre>&lt;h2 id="配置bonding">
 配置bonding
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%aebonding">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code># cat /etc/modprobe.d/bond0.conf
alias bond0 bonding
cd /etc/sysconfig/network-scripts/
# grep -v &amp;#34;^#&amp;#34; ifcfg-bond0
DEVICE=bond0
BOOTPROTO=static
ONBOOT=yes
IPADDR=192.168.5.88
NETMASK=255.255.255.0
GATEWAY=192.168.5.1
USERCTL=no
====================================================
BONDING_OPTS=&amp;#34;mode=0 miimon=100&amp;#34;
说明：这里使用了BONDING_OPTS选项，则不需要再使用 /etc/modprobe.d/bond0.conf 配置文件对绑定设备进行配置。参数mode=0，指负载均衡模式，详见下文。miimon是用来进行链路监测的，其原理是检测网上的链路状态，一般将miimon值设为100，表示系统每100ms监测一次链路连接状态，如果有一条线路不通就转入另一条线路。
====================================================
# grep -v &amp;#34;^#&amp;#34; ifcfg-eth1
DEVICE=eth1
ONBOOT=yes
BOOTPROTO=static
MASTER=bond0
SLAVE=yes
USERCTL=no
# grep -v &amp;#34;^#&amp;#34; ifcfg-eth0
DEVICE=eth0
BOOTPROTO=static
ONBOOT=yes
MASTER=bond0
SLAVE=yes
USERCTL=no
注意：建议不要指定MAC地址
# echo 100 &amp;gt; /sys/class/net/bond0/bonding/miimon
# echo 6 &amp;gt; /sys/class/net/bond0/bonding/mode
Mode of operation : 0 for balance-rr, 1 for active-backup, 2 for balance-xor；
3 for broadcast, 4 for 802.3ad, 5 for balance-tlb, 6 for balance-alb (charp)
重启网络
# /etc/init.d/network restart
检查下
ifconfig
cat /proc/net/bonding/bond0
&lt;/code>&lt;/pre>&lt;h2 id="bonding模式">
 bonding模式
 &lt;a class="anchor" href="#bonding%e6%a8%a1%e5%bc%8f">#&lt;/a>
&lt;/h2>
&lt;p>bonding的模式：0-6，即：7种模式&lt;/p></description></item><item><title>centos升级 排除不想升级的软件包</title><link>https://notes.zhangwenbing.com/blog/linux/r1bIUL458Cz/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/r1bIUL458Cz/</guid><description>&lt;h2 id="方法一">
 方法一
 &lt;a class="anchor" href="#%e6%96%b9%e6%b3%95%e4%b8%80">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum --exclude&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;kernel*&amp;#34;&lt;/span> update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="方法二">
 方法二
 &lt;a class="anchor" href="#%e6%96%b9%e6%b3%95%e4%ba%8c">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/yum.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>main&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>......
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>exclude&lt;span style="color:#f92672">=&lt;/span>kernel*
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>修改/etc/yum.conf，在“[main]”的最后加上“exclude=kernel*”即可。&lt;/p>
&lt;h2 id="总结">
 总结
 &lt;a class="anchor" href="#%e6%80%bb%e7%bb%93">#&lt;/a>
&lt;/h2>
&lt;p>方法一为零时的，也就是只在当次有效，而方法二为永久有效。可根据不同情况选择。&lt;/p></description></item><item><title>linux apache mysql php 优化</title><link>https://notes.zhangwenbing.com/blog/linux/SkaWUIN5U0z/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SkaWUIN5U0z/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="一准备环境">
 一、准备环境
 &lt;a class="anchor" href="#%e4%b8%80%e5%87%86%e5%a4%87%e7%8e%af%e5%a2%83">#&lt;/a>
&lt;/h2>
&lt;h3 id="1安装mysql">
 1、安装mysql
 &lt;a class="anchor" href="#1%e5%ae%89%e8%a3%85mysql">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>#cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql5.5 -DMYSQL_DATADIR=/usr/local/mysql5.5/data -DSYSCONFDIR=/usr/local/mysql5.5/etc -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_ARCHIVE_STORAGE_ENGINE=1 -DWITH_PERFSCHEMA_STORAGE_ENGINE=1 -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DENABLED_LOCAL_INFILE=1 -DWITH_EXTRA_CHARSETS=all
#make
#make install
&lt;/code>&lt;/pre>&lt;h3 id="2安装nginx">
 2、安装nginx
 &lt;a class="anchor" href="#2%e5%ae%89%e8%a3%85nginx">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>#./configure --prefix=/usr/local/nginx --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --pid-path=/var/run/nginx/nginx.pid --user=daemon --group=daemon --with-pcre
#make &amp;amp;&amp;amp; make install
&lt;/code>&lt;/pre>&lt;h3 id="3安装php">
 3、安装php
 &lt;a class="anchor" href="#3%e5%ae%89%e8%a3%85php">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>#./configure --prefix=/usr/local/php5 --enable-bcmath --with-mysql=/usr/local/mysql5.5 --enable-fpm --with-fpm-user=daemon --with-fpm-group=daemon --with-config-file-path=/usr/local/php5
#make &amp;amp;&amp;amp; make install
&lt;/code>&lt;/pre>&lt;h3 id="4使nginx支持php">
 4、使nginx支持php
 &lt;a class="anchor" href="#4%e4%bd%bfnginx%e6%94%af%e6%8c%81php">#&lt;/a>
&lt;/h3>
&lt;h4 id="1nginx配置">
 (1)nginx配置
 &lt;a class="anchor" href="#1nginx%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h4>
&lt;pre tabindex="0">&lt;code>location ~ \.php$ {
root html;
fastcgi_pass 127.0.0.1:9000;
fastcgi_index index.php;
fastcgi_param SCRIPT_FILENAME /usr/local/nginx/html$fastcgi_script_name;
include fastcgi_params;
}
&lt;/code>&lt;/pre>&lt;h4 id="2php配置">
 (2)php配置
 &lt;a class="anchor" href="#2php%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h4>
&lt;pre tabindex="0">&lt;code>#vim /usr/local/php5/etc/php-fpm.conf
#cd /usr/local/php5/sbin
#./php-fpm -c /usr/local/php5/etc/php-fpm.conf
&lt;/code>&lt;/pre>&lt;h2 id="二php优化">
 二、php优化
 &lt;a class="anchor" href="#%e4%ba%8cphp%e4%bc%98%e5%8c%96">#&lt;/a>
&lt;/h2>
&lt;p>注意：如何添加php功能模块 例：安装mbstring多字节支持功能模块&lt;/p></description></item><item><title>linux bash截取字符串的几种方法</title><link>https://notes.zhangwenbing.com/blog/linux/HJi_UUE5ICG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HJi_UUE5ICG/</guid><description>&lt;blockquote>
&lt;h1 id="号截取删除左边字符保留右边字符">
 号截取，删除左边字符，保留右边字符
 &lt;a class="anchor" href="#%e5%8f%b7%e6%88%aa%e5%8f%96%e5%88%a0%e9%99%a4%e5%b7%a6%e8%be%b9%e5%ad%97%e7%ac%a6%e4%bf%9d%e7%95%99%e5%8f%b3%e8%be%b9%e5%ad%97%e7%ac%a6">#&lt;/a>
&lt;/h1>
&lt;/blockquote>
&lt;p>var=http://www.aaa.com/123.htm&lt;/p>
&lt;p>echo ${var#*//}&lt;/p>
&lt;p>其中var是变量名，…&lt;/p>
&lt;h3 id="-号截取删除左边字符保留右边字符">
 # 号截取，删除左边字符，保留右边字符
 &lt;a class="anchor" href="#-%e5%8f%b7%e6%88%aa%e5%8f%96%e5%88%a0%e9%99%a4%e5%b7%a6%e8%be%b9%e5%ad%97%e7%ac%a6%e4%bf%9d%e7%95%99%e5%8f%b3%e8%be%b9%e5%ad%97%e7%ac%a6">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>var=http://www.aaa.com/123.htm
echo ${var#*//}
&lt;/code>&lt;/pre>&lt;p>其中var是变量名，#号是运算符， &lt;em>号是通配符，&lt;/em>//表示从左边开始删除第一个到//处的所有字符即删除http://&lt;/p></description></item><item><title>linux crontab计划任务详解</title><link>https://notes.zhangwenbing.com/blog/linux/rJvbIUV580z/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rJvbIUV580z/</guid><description>&lt;blockquote>
&lt;p>crontab命令常见于Unix和类Unix的操作系统之中，用于设置周期性被执行的指令&lt;/p>
&lt;/blockquote>
&lt;h2 id="配置文件">
 配置文件
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cat /etc/crontab
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SHELL&lt;span style="color:#f92672">=&lt;/span>/bin/bash 计划任务的默认脚本bash shell
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PATH&lt;span style="color:#f92672">=&lt;/span>/sbin:/bin:/usr/sbin:/usr/bin 默认搜索路径
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MAILTO&lt;span style="color:#f92672">=&lt;/span>root 当计划任务有标准输出或标准错误输出时，会将结果发邮件给root
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>HOME&lt;span style="color:#f92672">=&lt;/span>/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># run-parts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">01&lt;/span> * * * * root run-parts /etc/cron.hourly /etc/ 后面一定是个文件夹，每小时执行
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">02&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> * * * root run-parts /etc/cron.daily
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">22&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> * * &lt;span style="color:#ae81ff">0&lt;/span> root run-parts /etc/cron.weekly
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">42&lt;/span> &lt;span style="color:#ae81ff">4&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> * * root run-parts /etc/cron.monthly
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="注意事项">
 注意事项
 &lt;a class="anchor" href="#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9">#&lt;/a>
&lt;/h2>
&lt;p>多个计划任务不宜同时进行防止有非法计划任务周和日，月不可同时并存，容易导致计划任务时间混乱&lt;/p></description></item><item><title>linux DHCP简单使用方法</title><link>https://notes.zhangwenbing.com/blog/linux/B1CLLE98CG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1CLLE98CG/</guid><description>&lt;p>配置&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/dhcpd.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>default-lease-time 1296000;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>max-lease-time 4000000;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#IP最长失效时间&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>option subnet-mask 255.255.255.0;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#子网的掩码&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>option broadcast-address 192.168.0.255;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#网络的广播地址&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>option routers 192.168.0.254;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#网关的地址&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>option domain-name-servers 211.151.48.59,211.151.48.47;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#域名解析地址&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ddns-update-style ad-hoc;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>subnet 192.168.0.0 netmask 255.255.255.0 &lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#定义IP池的内容&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>range 192.168.0.100 192.168.0.240;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#地址范围为 100-240 共140个IP地址。&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#也可以象下面一样按MAC地址指定IP&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#host Jephe {hardware ethernet 00:a0:c9:a6:96:33;fixed-address 192.168.1.12;}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="详解">
 详解
 &lt;a class="anchor" href="#%e8%af%a6%e8%a7%a3">#&lt;/a>
&lt;/h2>
&lt;h3 id="parameters参数">
 parameters（参数）
 &lt;a class="anchor" href="#parameters%e5%8f%82%e6%95%b0">#&lt;/a>
&lt;/h3>
&lt;p>ddns-update-style 配置DHCP-DNS互动更新模式 default-lease-time 指定缺省租赁时间的长度，单位是秒 max-&lt;/p></description></item><item><title>linux dns（named）最小配置</title><link>https://notes.zhangwenbing.com/blog/linux/HkiLUE5UCf/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HkiLUE5UCf/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="一简介">
 一、简介
 &lt;a class="anchor" href="#%e4%b8%80%e7%ae%80%e4%bb%8b">#&lt;/a>
&lt;/h2>
&lt;p>相对于存储和大数据领域，CDN是一个相对小的领域，但行行出状元，BIND就是CDN领域的蝉联N届的状元郎。BIND是一款非常常用的DNS开源服务器，全球有90%的DNS用BIND实现。值得一提的是，BIND9.8.1用C语言实现，代码量巨大，其设计实现几乎涵盖了服务器编程的所有细节。&lt;/p></description></item><item><title>linux mount命令详解</title><link>https://notes.zhangwenbing.com/blog/linux/B1OZ8INcIAM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1OZ8INcIAM/</guid><description>&lt;h2 id="功能">
 功能
 &lt;a class="anchor" href="#%e5%8a%9f%e8%83%bd">#&lt;/a>
&lt;/h2>
&lt;p>加载指定的文件系统。&lt;/p>
&lt;h2 id="语法">
 语法
 &lt;a class="anchor" href="#%e8%af%ad%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;p>mount [-afFhnrvVw] [-L] [-o] [-t] [设备名] [加载点]&lt;/p>
&lt;h2 id="用法">
 用法
 &lt;a class="anchor" href="#%e7%94%a8%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;p>说明：mount可将指定设备中指定的文件系统加载到Linux目录下（也就是装载点）。可将经常使用的设备写入文件/etc/fastab,以使系统在每次启动时自动加载。mount加载设备的信息记录在/etc/mtab文件中。使用umount命令卸载设备时，记录将被清除。&lt;/p></description></item><item><title>linux nfs配置及访问控制</title><link>https://notes.zhangwenbing.com/blog/linux/rJJe8UNcU0M/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rJJe8UNcU0M/</guid><description>&lt;h2 id="nfs软件包">
 NFS软件包
 &lt;a class="anchor" href="#nfs%e8%bd%af%e4%bb%b6%e5%8c%85">#&lt;/a>
&lt;/h2>
&lt;p>nfs-utils portmap (rhel6换成了rpcbind ,所以启动服务时需要注意)&lt;/p>
&lt;h2 id="nfs文件">
 NFS文件
 &lt;a class="anchor" href="#nfs%e6%96%87%e4%bb%b6">#&lt;/a>
&lt;/h2>
&lt;p>/etc/exports #NFS主配置文件 /etc/init.d/nfs #NFS启动脚本 /etc/init.d/protmap&lt;/p>
&lt;p>#portmap启动脚本 /var/lib/*tab #NFS日志文件&lt;/p></description></item><item><title>linux openssh 常见问题汇总</title><link>https://notes.zhangwenbing.com/blog/linux/SJ68UEcUCM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SJ68UEcUCM/</guid><description>&lt;blockquote>
&lt;p>软件包名&lt;/p>
&lt;/blockquote>
&lt;p>openssh-server openssh-clients&lt;/p>
&lt;p>服务名：sshd&lt;/p>
&lt;p>服务端配置文件：/etc/ssh/sshd.config 客户端…&lt;/p>
&lt;h2 id="软件包名">
 软件包名
 &lt;a class="anchor" href="#%e8%bd%af%e4%bb%b6%e5%8c%85%e5%90%8d">#&lt;/a>
&lt;/h2>
&lt;p>openssh-server openssh-clients&lt;/p>
&lt;h2 id="服务名sshd">
 服务名：sshd
 &lt;a class="anchor" href="#%e6%9c%8d%e5%8a%a1%e5%90%8dsshd">#&lt;/a>
&lt;/h2>
&lt;p>服务端配置文件：/etc/ssh/sshd.config 客户端配置文件：/etc/ssh/ssh.config&lt;/p></description></item><item><title>linux samba配置及乱码的解决方法</title><link>https://notes.zhangwenbing.com/blog/linux/rkxlI845IAz/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rkxlI845IAz/</guid><description>&lt;h2 id="简要说明">
 简要说明
 &lt;a class="anchor" href="#%e7%ae%80%e8%a6%81%e8%af%b4%e6%98%8e">#&lt;/a>
&lt;/h2>
&lt;p>samba：这个软体主要提供了SMB伺服器所需的各项服务程式(smbd及nmbd)、的文件档、以及其他与SAMBA相关的logrotate设定档及开机预设选项档案等；&lt;/p></description></item><item><title>Linux Screen命令</title><link>https://notes.zhangwenbing.com/blog/linux/B1muLLNcIRf/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1muLLNcIRf/</guid><description>&lt;p>Linux screen 命令用于多重视窗管理程序。&lt;/p>
&lt;p>screen 为多重视窗管理程序。此处所谓的视窗，是指一个全屏幕的文字模式画面。通常只有在使用 telnet 登入主机或是使用老式的终端机时，才有可能用到 screen 程序。&lt;/p></description></item><item><title>linux VM虚拟内存和BDP优化</title><link>https://notes.zhangwenbing.com/blog/linux/Hk2bI84c8Rz/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/Hk2bI84c8Rz/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="vm虚拟内存优化">
 VM虚拟内存优化
 &lt;a class="anchor" href="#vm%e8%99%9a%e6%8b%9f%e5%86%85%e5%ad%98%e4%bc%98%e5%8c%96">#&lt;/a>
&lt;/h2>
&lt;p>#getconf PAGESIZE&lt;/p>
&lt;p>vm.dirty_background_bytes 系统内所包含的脏数据总数&lt;/p>
&lt;p>vm.dirty_background_ratio 脏数据所占用内存的百分比&lt;/p>
&lt;p>vm.dirty_expire_centisecs 脏数据在内存中的存放时间&lt;/p>
&lt;p>vm.dirty_bytes 如果进程的脏数据超过该值时则要求写到磁盘&lt;/p>
&lt;h2 id="bdp优化">
 BDP优化
 &lt;a class="anchor" href="#bdp%e4%bc%98%e5%8c%96">#&lt;/a>
&lt;/h2>
&lt;p>BDP=Bandwidth*RRT net.core.rmem_max 最大缓冲区(窗口)大小&lt;/p></description></item><item><title>linux vnc简单配置</title><link>https://notes.zhangwenbing.com/blog/linux/H13UIE5LRM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H13UIE5LRM/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="vnc端口">
 VNC端口
 &lt;a class="anchor" href="#vnc%e7%ab%af%e5%8f%a3">#&lt;/a>
&lt;/h2>
&lt;p>vncserver监听端口 RFB协议：5900+桌面号 HTTP协议：5800+桌面号 X协议：6000+桌面号&lt;/p>
&lt;p>vncserver使用的桌面编号默认是从1开始，依次使用。&lt;/p></description></item><item><title>linux 常用系统资源查看命令</title><link>https://notes.zhangwenbing.com/blog/linux/S19ZLLE9I0G/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/S19ZLLE9I0G/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="一sar命令">
 一、sar命令
 &lt;a class="anchor" href="#%e4%b8%80sar%e5%91%bd%e4%bb%a4">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code># sar 1 10 监控CPU，每秒监控一次，共监控10次
# sar -P ALL 1 5 监控所有CPU
# sar -S 1 10 监控交换分区
# sar -d 1 10 监控磁盘IO
# sar -b 1 10 监控磁盘IO和速率
# sar -r 1 10 监控内存使用
# sar -n DEV 1 10 监控网络接口卡的数据传输
&lt;/code>&lt;/pre>&lt;h2 id="二mpstat">
 二、mpstat
 &lt;a class="anchor" href="#%e4%ba%8cmpstat">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code># mpstat -P ALL 1 10
&lt;/code>&lt;/pre>&lt;h2 id="三iostat">
 三、iostat
 &lt;a class="anchor" href="#%e4%b8%89iostat">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code># iostat -c 2
# iostat -d 1 100
# iostat 1 20
# iostat -p /dev/sda2 1 10
&lt;/code>&lt;/pre>&lt;h2 id="四vmstat">
 四、vmstat
 &lt;a class="anchor" href="#%e5%9b%9bvmstat">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>#vmstat -d 1 20
输出信息
r 运行队列中的进程数，不要长时间超过CPU核心总数
b 等待IO的进程数
si 每秒从交换分区写到内存的数据大小
so 每秒写入交换分区的数据大小
#vmstat -a 1 10
&lt;/code>&lt;/pre>&lt;h2 id="五其它常用监控命令">
 五、其它常用监控命令
 &lt;a class="anchor" href="#%e4%ba%94%e5%85%b6%e5%ae%83%e5%b8%b8%e7%94%a8%e7%9b%91%e6%8e%a7%e5%91%bd%e4%bb%a4">#&lt;/a>
&lt;/h2>
&lt;p>(1) top (2) free (3) iptraf&lt;/p></description></item><item><title>linux 防拒绝服务攻击</title><link>https://notes.zhangwenbing.com/blog/linux/H1sZIUN9I0f/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H1sZIUN9I0f/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="一使用脚本">
 一、使用脚本
 &lt;a class="anchor" href="#%e4%b8%80%e4%bd%bf%e7%94%a8%e8%84%9a%e6%9c%ac">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>wget http://www.inetbase.com/scripts/ddos/install.sh 安装脚本
wget http://www.inetbase.com/scripts/ddos/uninstall.sh 卸载脚本
&lt;/code>&lt;/pre>&lt;h2 id="二内核优化">
 二、内核优化
 &lt;a class="anchor" href="#%e4%ba%8c%e5%86%85%e6%a0%b8%e4%bc%98%e5%8c%96">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>net.ipv4.tcp_max_syn_backlog = 1024 #设定syn队列长度
net.ipv4.tcp_syncookies = 1 #设定是否启用cookies
net.ipv4.tcp_synack_retries = 3 #设定synack重试次数
net.ipv4.tcp_syn_retries = 2 #设定syn重试次数
net.ipv4.icmp_echo_ignore_all = 1 #不回应ping
net.ipv4.icmp_echo_ignore_broadcast = 1 #不回应广播ping
&lt;/code>&lt;/pre>&lt;h2 id="三防火墙配置">
 三、防火墙配置
 &lt;a class="anchor" href="#%e4%b8%89%e9%98%b2%e7%81%ab%e5%a2%99%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;h3 id="1基于数据包进行限制">
 1、基于数据包进行限制
 &lt;a class="anchor" href="#1%e5%9f%ba%e4%ba%8e%e6%95%b0%e6%8d%ae%e5%8c%85%e8%bf%9b%e8%a1%8c%e9%99%90%e5%88%b6">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>#iptables -A INPUT -p tcp --tcp-flags syn,ack,fin syn -m limit --limit 5/s --limit-burst 8 -j ACCEPT
#iptables -A INPUT -p tcp -m state --state ESTABLISHED,RELATED -j ACCEPT
&lt;/code>&lt;/pre>&lt;h3 id="2基于连接数进行限制">
 2、基于连接数进行限制
 &lt;a class="anchor" href="#2%e5%9f%ba%e4%ba%8e%e8%bf%9e%e6%8e%a5%e6%95%b0%e8%bf%9b%e8%a1%8c%e9%99%90%e5%88%b6">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>#iptables -A INPUT -s 192.168.0.0/24 -p tcp --dport 23 -m connlimit --connlimit-above 2 -j DROP
&lt;/code>&lt;/pre>&lt;h3 id="3基于地址列表进行限制">
 3、基于地址列表进行限制
 &lt;a class="anchor" href="#3%e5%9f%ba%e4%ba%8e%e5%9c%b0%e5%9d%80%e5%88%97%e8%a1%a8%e8%bf%9b%e8%a1%8c%e9%99%90%e5%88%b6">#&lt;/a>
&lt;/h3>
&lt;pre tabindex="0">&lt;code>#iptables -A INPUT -p tcp --dport 80 --tcp-flags syn,ack,fin syn -m recent --name webpool --rcheck --seconds 120 --hitcount 10 -j LOG --log-prefix=&amp;#34;ddos:&amp;#34; --log-ip-options
#iptables -A INPUT -p tcp --dport 80 --syn -m recent --name webpool --rcheck --seconds 120 --hitcount 10 -j DROP
#iptables -A INPUT -p tcp --dport 80 --syn -m recent --name webpool --set -j ACCEPT
&lt;/code>&lt;/pre></description></item><item><title>linux 防御SYN攻击</title><link>https://notes.zhangwenbing.com/blog/linux/HyYg884c80f/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HyYg884c80f/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="一默认syn配置">
 一、默认syn配置
 &lt;a class="anchor" href="#%e4%b8%80%e9%bb%98%e8%ae%a4syn%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>sysctl -a | grep _syn
net.ipv4.tcp_max_syn_backlog = 1024
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_synack_retries = 5
net.ipv4.tcp_syn_retries = 5
&lt;/code>&lt;/pre>&lt;p>tcp_max_syn_backlog 是SYN队列的长度，加大SYN队列长度可以容纳更多等待连接的网络连接数。&lt;/p>
&lt;p>tcp_syncookies是一个开关，是否打开SYN Cookie 功能，该功能可以防止部分SYN攻击。&lt;/p></description></item><item><title>linux（内核）oom kille vm.overcommit_memory参数详解</title><link>https://notes.zhangwenbing.com/blog/linux/HkGxI8VcL0f/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HkGxI8VcL0f/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="详细说明">
 详细说明
 &lt;a class="anchor" href="#%e8%af%a6%e7%bb%86%e8%af%b4%e6%98%8e">#&lt;/a>
&lt;/h2>
&lt;p>可选值：0、1、2。&lt;/p>
&lt;p>0， 表示内核将检查是否有足够的可用内存供应用进程使用；如果有足够的可用内存，内存申请允许；否则，内存申请失败，并把错误返回给应用进程。&lt;/p></description></item><item><title>linux代理地址失效导致的问题解析</title><link>https://notes.zhangwenbing.com/blog/linux/HJCOI8NqUAG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HJCOI8NqUAG/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="错误描述">
 错误描述
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e6%8f%8f%e8%bf%b0">#&lt;/a>
&lt;/h2>
&lt;p>任何需要使用http服务的程序都会存在假死或超时，包括wget、cur、yum等等。&lt;/p>
&lt;h2 id="初步发现">
 初步发现
 &lt;a class="anchor" href="#%e5%88%9d%e6%ad%a5%e5%8f%91%e7%8e%b0">#&lt;/a>
&lt;/h2>
&lt;p>使用sudo 可是正常访问。&lt;/p>
&lt;p>例如：&lt;/p>
&lt;pre tabindex="0">&lt;code>sudo yum install wget
&lt;/code>&lt;/pre>&lt;h2 id="然后发现">
 然后发现
 &lt;a class="anchor" href="#%e7%84%b6%e5%90%8e%e5%8f%91%e7%8e%b0">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>[root@jn6 tmp]# wget http://mirrors.163.com/.help/CentOS6-Base-163.repo
--2018-03-08 14:13:53-- http://mirrors.163.com/.help/CentOS6-Base-163.repo
Connecting to 10.1.205.242:3128...
&lt;/code>&lt;/pre>&lt;p>根据上面的提示发现了&lt;/p></description></item><item><title>linux内存清理释放命令</title><link>https://notes.zhangwenbing.com/blog/linux/S13z8UE5UCf/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/S13z8UE5UCf/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="命令">
 命令
 &lt;a class="anchor" href="#%e5%91%bd%e4%bb%a4">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>sync
echo 1 &amp;gt; /proc/sys/vm/drop_caches
echo 2 &amp;gt; /proc/sys/vm/drop_caches
echo 3 &amp;gt; /proc/sys/vm/drop_caches
&lt;/code>&lt;/pre>&lt;h2 id="解释">
 解释
 &lt;a class="anchor" href="#%e8%a7%a3%e9%87%8a">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>cache释放：
To free pagecache:
echo 1 &amp;gt; /proc/sys/vm/drop_caches

To free dentries and inodes:
echo 2 &amp;gt; /proc/sys/vm/drop_caches

To free pagecache, dentries and inodes:
echo 3 &amp;gt; /proc/sys/vm/drop_caches
&lt;/code>&lt;/pre>&lt;h2 id="说明">
 说明
 &lt;a class="anchor" href="#%e8%af%b4%e6%98%8e">#&lt;/a>
&lt;/h2>
&lt;p>释放前最好sync一下，防止丢数据。&lt;/p></description></item><item><title>Linux清除内存</title><link>https://notes.zhangwenbing.com/blog/linux/B1FO88V580M/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B1FO88V580M/</guid><description>&lt;h2 id="如何在-linux-中清除缓存cache">
 如何在 Linux 中清除缓存（Cache）？
 &lt;a class="anchor" href="#%e5%a6%82%e4%bd%95%e5%9c%a8-linux-%e4%b8%ad%e6%b8%85%e9%99%a4%e7%bc%93%e5%ad%98cache">#&lt;/a>
&lt;/h2>
&lt;p>每个 Linux 系统有三种选项来清除缓存而不需要中断任何进程或服务。&lt;/p>
&lt;p>（LCTT 译注：Cache，译作“缓存”，指 CPU&lt;/p></description></item><item><title>linux无人值守安装之找不到pxelinux.0文件的解决办法</title><link>https://notes.zhangwenbing.com/blog/linux/ryedLUN9UAf/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/ryedLUN9UAf/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="解决思路">
 解决思路
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e6%80%9d%e8%b7%af">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>yum search pxelinux
&lt;/code>&lt;/pre>&lt;p>通过上面的方法我们找到了syslinux包&lt;/p>
&lt;p>然后安装syslinux&lt;/p>
&lt;pre tabindex="0">&lt;code>yum install syslinux
&lt;/code>&lt;/pre>&lt;p>最后找到pxelinux.0文件&lt;/p>
&lt;pre tabindex="0">&lt;code>ls /usr/share/syslinux/pxelinux.0
&lt;/code>&lt;/pre></description></item><item><title>mediainfo获取ts文件大小和信息不准确（MPEG-TS：检测文件的序列）的解决办法</title><link>https://notes.zhangwenbing.com/blog/linux/Sky_LU458CM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/Sky_LU458CM/</guid><description>&lt;blockquote>
&lt;p>解决mediainfo获取ts媒体信息不准确问题&lt;/p>
&lt;/blockquote>
&lt;h2 id="场景">
 场景
 &lt;a class="anchor" href="#%e5%9c%ba%e6%99%af">#&lt;/a>
&lt;/h2>
&lt;p>在/opt/目录下总共有200多个文件文件名分别如下：&lt;/p>
&lt;p>/opt/2017LPL夏季赛第01集.ts&lt;/p></description></item><item><title>nginx 简单配置及使用教程</title><link>https://notes.zhangwenbing.com/blog/linux/SyqLL45IRz/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SyqLL45IRz/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="常用配置">
 常用配置
 &lt;a class="anchor" href="#%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>#运行用户
user nobody;
#启动进程,通常设置成和cpu的数量相等
worker_processes 1;

#全局错误日志及PID文件
#error_log logs/error.log;
#error_log logs/error.log notice;
#error_log logs/error.log info;

#pid logs/nginx.pid;

#工作模式及连接数上限
events {
 #epoll是多路复用IO(I/O Multiplexing)中的一种方式,
 #仅用于linux2.6以上内核,可以大大提高nginx的性能
 use epoll;

 #单个后台worker process进程的最大并发链接数
 worker_connections 1024;

 # 并发总数是 worker_processes 和 worker_connections 的乘积
 # 即 max_clients = worker_processes * worker_connections
 # 在设置了反向代理的情况下，max_clients = worker_processes * worker_connections / 4 为什么
 # 为什么上面反向代理要除以4，应该说是一个经验值
 # 根据以上条件，正常情况下的Nginx Server可以应付的最大连接数为：4 * 8000 = 32000
 # worker_connections 值的设置跟物理内存大小有关
 # 因为并发受IO约束，max_clients的值须小于系统可以打开的最大文件数
 # 而系统可以打开的最大文件数和内存大小成正比，一般1GB内存的机器上可以打开的文件数大约是10万左右
 # 我们来看看360M内存的VPS可以打开的文件句柄数是多少：
 # $ cat /proc/sys/fs/file-max
 # 输出 34336
 # 32000 &amp;lt; 34336，即并发连接总数小于系统可以打开的文件句柄总数，这样就在操作系统可以承受的范围之内
 # 所以，worker_connections 的值需根据 worker_processes 进程数目和系统可以打开的最大文件总数进行适当地进行设置
 # 使得并发总数小于操作系统可以打开的最大文件数目
 # 其实质也就是根据主机的物理CPU和内存进行配置
 # 当然，理论上的并发总数可能会和实际有所偏差，因为主机还有其他的工作进程需要消耗系统资源。
 # ulimit -SHn 65535

}

http {
 #设定mime类型,类型由mime.type文件定义
 include mime.types;
 default_type application/octet-stream;
 #设定日志格式
 log_format main &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;
 &amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;
 &amp;#39;&amp;#34;$http_user_agent&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;;

 access_log logs/access.log main;

 #sendfile 指令指定 nginx 是否调用 sendfile 函数（zero copy 方式）来输出文件，
 #对于普通应用，必须设为 on,
 #如果用来进行下载等应用磁盘IO重负载应用，可设置为 off，
 #以平衡磁盘与网络I/O处理速度，降低系统的uptime.
 sendfile on;
 #tcp_nopush on;

 #连接超时时间
 #keepalive_timeout 0;
 keepalive_timeout 65;
 tcp_nodelay on;

 #开启gzip压缩
 gzip on;
 gzip_disable &amp;#34;MSIE [1-6].&amp;#34;;

 #设定请求缓冲
 client_header_buffer_size 128k;
 large_client_header_buffers 4 128k;

 #设定虚拟主机配置
 server {
 #侦听80端口
 listen 80;
 #定义使用 www.nginx.cn访问
 server_name www.nginx.cn;

 #定义服务器的默认网站根目录位置
 root html;

 #设定本虚拟主机的访问日志
 access_log logs/nginx.access.log main;

 #默认请求
 location / {

 #定义首页索引文件的名称
 index index.php index.html index.htm;

 }

 # 定义错误提示页面
 error_page 500 502 503 504 /50x.html;
 location = /50x.html {
 }

 #静态文件，nginx自己处理
 location ~ ^/(images|javascript|js|css|flash|media|static)/ {

 #过期30天，静态文件不怎么更新，过期可以设大一点，
 #如果频繁更新，则可以设置得小一点。
 expires 30d;
 }

 #PHP 脚本请求全部转发到 FastCGI处理. 使用FastCGI默认配置.
 location ~ .php$ {
 fastcgi_pass 127.0.0.1:9000;
 fastcgi_index index.php;
 fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
 include fastcgi_params;
 }

 #禁止访问 .htxxx 文件
 location ~ /.ht {
 deny all;
 }

 }
}
&lt;/code>&lt;/pre>&lt;h2 id="其他配置">
 其他配置
 &lt;a class="anchor" href="#%e5%85%b6%e4%bb%96%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>#定义Nginx运行的用户和用户组
user www www;

#nginx进程数，建议设置为等于CPU总核心数。
worker_processes 8;

#全局错误日志定义类型，[ debug | info | notice | warn | error | crit ]
error_log /var/log/nginx/error.log info;

#进程文件
pid /var/run/nginx.pid;

#一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（系统的值ulimit -n）与nginx进程数相除，但是nginx分配请求并不均匀，所以建议与ulimit -n的值保持一致。
worker_rlimit_nofile 65535;

#工作模式与连接数上限
events
{
#参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型是Linux 2.6以上版本内核中的高性能网络I/O模型，如果跑在FreeBSD上面，就用kqueue模型。
use epoll;
#单个进程最大连接数（最大连接数=连接数*进程数）
worker_connections 65535;
}

#设定http服务器
http
{
include mime.types; #文件扩展名与文件类型映射表
default_type application/octet-stream; #默认文件类型
#charset utf-8; #默认编码
server_names_hash_bucket_size 128; #服务器名字的hash表大小
client_header_buffer_size 32k; #上传文件大小限制
large_client_header_buffers 4 64k; #设定请求缓
client_max_body_size 8m; #设定请求缓
sendfile on; #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。
autoindex on; #开启目录列表访问，合适下载服务器，默认关闭。
tcp_nopush on; #防止网络阻塞
tcp_nodelay on; #防止网络阻塞
keepalive_timeout 120; #长连接超时时间，单位是秒

#FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。
fastcgi_connect_timeout 300;
fastcgi_send_timeout 300;
fastcgi_read_timeout 300;
fastcgi_buffer_size 64k;
fastcgi_buffers 4 64k;
fastcgi_busy_buffers_size 128k;
fastcgi_temp_file_write_size 128k;

#gzip模块设置
gzip on; #开启gzip压缩输出
gzip_min_length 1k; #最小压缩文件大小
gzip_buffers 4 16k; #压缩缓冲区
gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）
gzip_comp_level 2; #压缩等级
gzip_types text/plain application/x-javascript text/css application/xml;
#压缩类型，默认就已经包含text/html，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。
gzip_vary on;
#limit_zone crawler $binary_remote_addr 10m; #开启限制IP连接数的时候需要使用

upstream blog.ha97.com {
#upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。
server 192.168.80.121:80 weight=3;
server 192.168.80.122:80 weight=2;
server 192.168.80.123:80 weight=3;
}

#虚拟主机的配置
server
{
#监听端口
listen 80;
#域名可以有多个，用空格隔开
server_name www.ha97.com ha97.com;
index index.html index.htm index.php;
root /data/www/ha97;
location ~ .*\.(php|php5)?$
{
fastcgi_pass 127.0.0.1:9000;
fastcgi_index index.php;
include fastcgi.conf;
}
#图片缓存时间设置
location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
{
expires 10d;
}
#JS和CSS缓存时间设置
location ~ .*\.(js|css)?$
{
expires 1h;
}
#日志格式设定
log_format access &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; &amp;#39;
&amp;#39;$status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#39;
&amp;#39;&amp;#34;$http_user_agent&amp;#34; $http_x_forwarded_for&amp;#39;;
#定义本虚拟主机的访问日志
access_log /var/log/nginx/ha97access.log access;

#对 &amp;#34;/&amp;#34; 启用反向代理
location / {
proxy_pass http://127.0.0.1:88;
proxy_redirect off;
proxy_set_header X-Real-IP $remote_addr;
#后端的Web服务器可以通过X-Forwarded-For获取用户真实IP
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#以下是一些反向代理的配置，可选。
proxy_set_header Host $host;
client_max_body_size 10m; #允许客户端请求的最大单文件字节数
client_body_buffer_size 128k; #缓冲区代理缓冲用户端请求的最大字节数，
proxy_connect_timeout 90; #nginx跟后端服务器连接超时时间(代理连接超时)
proxy_send_timeout 90; #后端服务器数据回传时间(代理发送超时)
proxy_read_timeout 90; #连接成功后，后端服务器响应时间(代理接收超时)
proxy_buffer_size 4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小
proxy_buffers 4 32k; #proxy_buffers缓冲区，网页平均在32k以下的设置
proxy_busy_buffers_size 64k; #高负荷下缓冲大小（proxy_buffers*2）
proxy_temp_file_write_size 64k;
#设定缓存文件夹大小，大于这个值，将从upstream服务器传
}

#设定查看Nginx状态的地址
location /NginxStatus {
stub_status on;
access_log on;
auth_basic &amp;#34;NginxStatus&amp;#34;;
auth_basic_user_file conf/htpasswd;
#htpasswd文件的内容可以用apache提供的htpasswd工具来产生。
}

#本地动静分离反向代理配置
#所有jsp的页面均交由tomcat或resin处理
location ~ .(jsp|jspx|do)?$ {
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_pass http://127.0.0.1:8080;
}
#所有静态文件由nginx直接读取不经过tomcat或resin
location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$
{ expires 15d; }
location ~ .*.(js|css)?$
{ expires 1h; }
}
}
&lt;/code>&lt;/pre></description></item><item><title>nginx+php+ThinkPHP环境常见错误总结</title><link>https://notes.zhangwenbing.com/blog/linux/ByS8884qI0M/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/ByS8884qI0M/</guid><description>&lt;blockquote>
&lt;p>错误一&lt;/p>
&lt;/blockquote>
&lt;p>2017/09/07 16:39:18 [error] 21753#0: *26 FastCGI sent in stderr: “Primary s…&lt;/p>
&lt;h2 id="错误一">
 错误一
 &lt;a class="anchor" href="#%e9%94%99%e8%af%af%e4%b8%80">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>2017/09/07 16:39:18 [error] 21753#0: *26 FastCGI sent in stderr: &amp;#34;Primary script unknown&amp;#34; while reading response header from upstream, client: 172.31.26.114, server: localhost, request: &amp;#34;GET /1.php HTTP/1.1&amp;#34;, upstream: &amp;#34;fastcgi://127.0.0.1:9000&amp;#34;, host: &amp;#34;10.200.8.220:8000&amp;#34;
&lt;/code>&lt;/pre>&lt;h3 id="解决版本">
 解决版本
 &lt;a class="anchor" href="#%e8%a7%a3%e5%86%b3%e7%89%88%e6%9c%ac">#&lt;/a>
&lt;/h3>
&lt;p>在server节点下添加以下配置&lt;/p></description></item><item><title>Nginx反向代理、镜像缓存加速及负载均衡的配置</title><link>https://notes.zhangwenbing.com/blog/linux/H1v8I4cLAf/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H1v8I4cLAf/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;p>Nginx已经具备Squid所拥有的Web缓存加速功能、清除指定URL缓存的功能。而在性能上，Nginx对多核CPU的利用，胜过Squid不少。另外，在反向代理、负载均衡、健康检查、后端服务器故障转移、Rewrite重写、易用性上，Nginx也比Squid强大得多。&lt;/p></description></item><item><title>nignx修改最大上传文件大小限制</title><link>https://notes.zhangwenbing.com/blog/linux/rykY88V58CG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rykY88V58CG/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;pre tabindex="0">&lt;code>location / {
 root html;
 index index.html index.htm;
 client_max_body_size 1000m;
 }
&lt;/code>&lt;/pre>&lt;p>“client_max_body_size”设置一下上传的最大上限,然后重启nginx即可。&lt;/p></description></item><item><title>rabbitmq 消息队列安装和配置</title><link>https://notes.zhangwenbing.com/blog/linux/HkXeLI4cIAG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HkXeLI4cIAG/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="erlang">
 erlang
 &lt;a class="anchor" href="#erlang">#&lt;/a>
&lt;/h2>
&lt;p>首先安装erlang语言环境&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum install erlang -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="rabbitmq">
 rabbitMQ
 &lt;a class="anchor" href="#rabbitmq">#&lt;/a>
&lt;/h2>
&lt;p>rabbitMQ下载地址：直达安装方法:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rpm -ivh --force --nodeps rabbitmq-server-3.6.0-1.noarch.rpm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>或者
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yum localinstall rabbitmq-server-3.6.0-1.noarch.rpm -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="启动服务">
 启动服务
 &lt;a class="anchor" href="#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>/etc/init.d/rabbitmq-server start
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmq-plugins enable rabbitmq_management
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="配置主备">
 配置主备
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%ae%e4%b8%bb%e5%a4%87">#&lt;/a>
&lt;/h2>
&lt;h3 id="同步cookie">
 同步cookie
 &lt;a class="anchor" href="#%e5%90%8c%e6%ad%a5cookie">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>chmod &lt;span style="color:#ae81ff">777&lt;/span> /var/lib/rabbitmq/.erlang.cookie
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>scp /var/lib/rabbitmq/.erlang.cookie Go02:/var/lib/rabbitmq/.erlang.cookie
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod &lt;span style="color:#ae81ff">400&lt;/span> /var/lib/rabbitmq/.erlang.cookie
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="添加节点">
 添加节点
 &lt;a class="anchor" href="#%e6%b7%bb%e5%8a%a0%e8%8a%82%e7%82%b9">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rabbitmqctl stop_app
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl reset
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl join_cluster &lt;span style="color:#f92672">[&lt;/span>--ram&lt;span style="color:#f92672">]&lt;/span> rabbit@Go01 //此处的Go01为主节点的hostname,需要在/etc/hosts中指定
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl start_app
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="删除节点">
 删除节点
 &lt;a class="anchor" href="#%e5%88%a0%e9%99%a4%e8%8a%82%e7%82%b9">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rabbitmqctl stop_app
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl forget_cluster_node rabbit@rabbit1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="修改类型">
 修改类型
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e7%b1%bb%e5%9e%8b">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rabbitmqctl stop_app
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl change_cluster_node_type ram
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl start_app
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="添加用户">
 添加用户
 &lt;a class="anchor" href="#%e6%b7%bb%e5%8a%a0%e7%94%a8%e6%88%b7">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>rabbitmqctl add_user admin admin
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>添加权限:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl set_permissions -p &lt;span style="color:#e6db74">&amp;#34;/&amp;#34;&lt;/span> admin &lt;span style="color:#e6db74">&amp;#34;.*&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;.*&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;.*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>删除测试用户:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl delete_user guest
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>赋予其administrator角色：
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbitmqctl set_user_tags admin administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="修改配置">
 修改配置
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>//防止服务端异常中断恢复后镜像队列不能恢复的问题
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim /etc/rabbitmq/rabbitmq.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">{&lt;/span>rabbit,&lt;span style="color:#f92672">[{&lt;/span>tcp_listeners,&lt;span style="color:#f92672">[&lt;/span>5672&lt;span style="color:#f92672">]}&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">{&lt;/span>cluster_partition_handling, autoheal&lt;span style="color:#f92672">}]}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">]&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#不要忘记最后面的那个点号哦！&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="环境变量">
 环境变量
 &lt;a class="anchor" href="#%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>touch /etc/rabbitmq/rabbitmq-env.conf#输入
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RABBITMQ_NODENAME&lt;span style="color:#f92672">=&lt;/span>FZTEC-240088 节点名称 RABBITMQ_NODE_IP_ADDRESS&lt;span style="color:#f92672">=&lt;/span>127.0.0.1 监听IP
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RABBITMQ_NODE_PORT&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">5672&lt;/span> 监听端口 RABBITMQ_LOG_BASE&lt;span style="color:#f92672">=&lt;/span>/data/rabbitmq/log 日志目录
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RABBITMQ_PLUGINS_DIR&lt;span style="color:#f92672">=&lt;/span>/data/rabbitmq/plugins 插件目录
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RABBITMQ_MNESIA_BASE&lt;span style="color:#f92672">=&lt;/span>/data/rabbitmq/mnesia 后端存储目录
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="rabbitmq的用户角色分类">
 RabbitMQ的用户角色分类
 &lt;a class="anchor" href="#rabbitmq%e7%9a%84%e7%94%a8%e6%88%b7%e8%a7%92%e8%89%b2%e5%88%86%e7%b1%bb">#&lt;/a>
&lt;/h3>
&lt;p>none、management、policymaker、monitoring、administrator&lt;/p></description></item><item><title>RabbitMQ三种Exchange模式(fanout,direct,topic)的性能比较</title><link>https://notes.zhangwenbing.com/blog/linux/HybPILE5U0z/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HybPILE5U0z/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;p>RabbitMQ中，所有生产者提交的消息都由Exchange来接受，然后Exchange按照特定的策略转发到Queue进行存储&lt;/p>
&lt;p>RabbitMQ提供了四种Exchange：fanout,direct,topic,header&lt;/p></description></item><item><title>RabbitMQ性能优化</title><link>https://notes.zhangwenbing.com/blog/linux/H1z5LL49I0z/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/H1z5LL49I0z/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="rabbitmqconfig">
 rabbitmq.config
 &lt;a class="anchor" href="#rabbitmqconfig">#&lt;/a>
&lt;/h2>
&lt;p>rabbitmq.config文件时rabbitmq的配置文件，他遵守Erlang配置文件定义。&lt;/p>
&lt;p>rabbitmq.config文件位置：&lt;/p></description></item><item><title>rabbitmq之机器机器全部断电恢复记录</title><link>https://notes.zhangwenbing.com/blog/linux/rkCKI84cLAG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/rkCKI84cLAG/</guid><description>&lt;p>今天遇到一个rabbitmq集群同时断电，当机器全部启动的时候发现rabbitmq无法正常启动，然后发现如下日志。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>INFO REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:07 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Starting RabbitMQ 3.5.3 on Erlang R16B03-1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Copyright &lt;span style="color:#f92672">(&lt;/span>C&lt;span style="color:#f92672">)&lt;/span> 2007-2014 GoPivotal, Inc.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Licensed under the MPL. See http://www.rabbitmq.com/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>INFO REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:07 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>node : rabbit@WIN-ACC2J7AGNM9
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>home dir : C:&lt;span style="color:#ae81ff">\U&lt;/span>sers&lt;span style="color:#ae81ff">\A&lt;/span>dministrator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>config file&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span> : e:/RabbitMQ Data/rabbitmq.config &lt;span style="color:#f92672">(&lt;/span>not found&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cookie hash : kR4NuIdBr2n8/4Qt9uIgqQ&lt;span style="color:#f92672">==&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>log : E:/RabbitMQ Data/log/rabbit@WIN-ACC2J7AGNM9.log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sasl log : E:/RabbitMQ Data/log/rabbit@WIN-ACC2J7AGNM9-sasl.log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>database dir : e:/RabbitMQ Data/db/rabbit@WIN-ACC2J7AGNM9-mnesia
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>WARNING REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:07 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Kernel poll &lt;span style="color:#f92672">(&lt;/span>epoll, kqueue, etc&lt;span style="color:#f92672">)&lt;/span> is disabled. Throughput and CPU utilization may worsen.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>INFO REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:08 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Memory limit set to 13095MB of 32738MB total.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>INFO REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:08 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk free limit set to 50MB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>INFO REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:08 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Limiting to approx &lt;span style="color:#ae81ff">8092&lt;/span> file handles &lt;span style="color:#f92672">(&lt;/span>&lt;span style="color:#ae81ff">7280&lt;/span> sockets&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">=&lt;/span>INFO REPORT&lt;span style="color:#f92672">====&lt;/span> 25-Apr-2018::11:11:38 &lt;span style="color:#f92672">===&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Timeout contacting cluster nodes: &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#e6db74">&amp;#39;rabbit@WIN-2W6NDAIZBIA&amp;#39;&lt;/span>&lt;span style="color:#f92672">]&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>BACKGROUND
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">==========&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>This cluster node was shut down &lt;span style="color:#66d9ef">while&lt;/span> other nodes were still running.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>To avoid losing data, you should start the other nodes first, &lt;span style="color:#66d9ef">then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>start this one. To force this node to start, first invoke
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">&amp;#34;rabbitmqctl force_boot&amp;#34;&lt;/span>. If you &lt;span style="color:#66d9ef">do&lt;/span> so, any changes made on other
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cluster nodes after this one was shut down may be lost.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DIAGNOSTICS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">===========&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>attempted to contact: &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#e6db74">&amp;#39;rabbit@WIN-2W6NDAIZBIA&amp;#39;&lt;/span>&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rabbit@WIN-2W6NDAIZBIA:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> * connected to epmd &lt;span style="color:#f92672">(&lt;/span>port 4369&lt;span style="color:#f92672">)&lt;/span> on WIN-2W6NDAIZBIA
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> * epmd reports: node &lt;span style="color:#e6db74">&amp;#39;rabbit&amp;#39;&lt;/span> not running at all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> no other nodes on WIN-2W6NDAIZBIA
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> * suggestion: start the node
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>current node details:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- node name: &lt;span style="color:#e6db74">&amp;#39;rabbit@WIN-ACC2J7AGNM9&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- home dir: C:&lt;span style="color:#ae81ff">\U&lt;/span>sers&lt;span style="color:#ae81ff">\A&lt;/span>dministrator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- cookie hash: kR4NuIdBr2n8/4Qt9uIgqQ&lt;span style="color:#f92672">==&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>关键的地方在于中间的这段说明：&lt;/p></description></item><item><title>rabbitmq之修改数据和log目录位置位置</title><link>https://notes.zhangwenbing.com/blog/linux/ry3FIUV58AM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/ry3FIUV58AM/</guid><description>&lt;blockquote>
&lt;p>vim /etc/rabbitmq/rabbitmq-env.conf&lt;/p>
&lt;/blockquote>
&lt;h1 id="i-am-a-complete-etcrabbitmqrabbitmq-e">
 I am a complete /etc/rabbitmq/rabbitmq-e…
 &lt;a class="anchor" href="#i-am-a-complete-etcrabbitmqrabbitmq-e">#&lt;/a>
&lt;/h1>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span> vim /etc/rabbitmq/rabbitmq-env.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># I am a complete /etc/rabbitmq/rabbitmq-env.conf file.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Comment lines start with a hash character.&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># This is a /bin/sh script file - use ordinary envt var syntax&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>MNESIA_BASE&lt;span style="color:#f92672">=&lt;/span>/data/rabbitmq/mnesia
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>LOG_BASE&lt;span style="color:#f92672">=&lt;/span>/data/logs/rabbitmq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Ubuntu 阿里云镜像源</title><link>https://notes.zhangwenbing.com/blog/linux/B11rILN5UAz/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/B11rILN5UAz/</guid><description>&lt;h2 id="准备工作">
 准备工作
 &lt;a class="anchor" href="#%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak &lt;span style="color:#75715e">#备份&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="修改配置">
 修改配置
 &lt;a class="anchor" href="#%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;h3 id="1404">
 14.04
 &lt;a class="anchor" href="#1404">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/apt/sources.list &lt;span style="color:#75715e">#修改&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="1604">
 16.04
 &lt;a class="anchor" href="#1604">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo vim /etc/apt/sources.list &lt;span style="color:#75715e">#修改&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://archive.ubuntu.com/ubuntu xenial main restricted &lt;span style="color:#75715e">#Added by software-properties&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe &lt;span style="color:#75715e">#Added by software-properties&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe &lt;span style="color:#75715e">#Added by software-properties&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial universe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse &lt;span style="color:#75715e">#Added by software-properties&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://archive.canonical.com/ubuntu xenial partner
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://archive.canonical.com/ubuntu xenial partner
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe &lt;span style="color:#75715e">#Added by software-properties&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="更新缓存">
 更新缓存
 &lt;a class="anchor" href="#%e6%9b%b4%e6%96%b0%e7%bc%93%e5%ad%98">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo apt-get update &lt;span style="color:#75715e">#更新列表&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ubuntu编译安装vim及配制方法</title><link>https://notes.zhangwenbing.com/blog/linux/HyGHL8E5LRM/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HyGHL8E5LRM/</guid><description>&lt;blockquote>
&lt;p>一个非常好用的vim配置文件&lt;/p>
&lt;/blockquote>
&lt;h2 id="vim简介">
 vim简介
 &lt;a class="anchor" href="#vim%e7%ae%80%e4%bb%8b">#&lt;/a>
&lt;/h2>
&lt;p>Vim是一个类似于Vi的著名的功能强大、高度可定制的文本编辑器，在Vi的基础上改进和增加了很多特性。VIM是自由软件。&lt;/p></description></item><item><title>vim 快速入门手册</title><link>https://notes.zhangwenbing.com/blog/linux/BJ8I8E9U0M/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/BJ8I8E9U0M/</guid><description>&lt;blockquote>
&lt;p>vim常见操作&lt;/p>
&lt;/blockquote>
&lt;h2 id="图示">
 图示
 &lt;a class="anchor" href="#%e5%9b%be%e7%a4%ba">#&lt;/a>
&lt;/h2>
&lt;p>![vi-vim-cheat-sheet-sch.png](/static/uploads/BJ8I8E9U0M/img/vi-vim-cheat-&lt;br>
sheet-sch_SyLsV8yY4.png)&lt;/p>
&lt;h2 id="一移动光标">
 一、移动光标
 &lt;a class="anchor" href="#%e4%b8%80%e7%a7%bb%e5%8a%a8%e5%85%89%e6%a0%87">#&lt;/a>
&lt;/h2>
&lt;p>1、左移h、右移l、下移j、上移k&lt;/p>
&lt;p>2、向下翻页ctrl + f，向上翻页ctrl + b&lt;/p>
&lt;p>3、向下翻半页ctrl + d，向上翻半页ctrl + u&lt;/p></description></item><item><title>vsftpd 配置方法及访问控制</title><link>https://notes.zhangwenbing.com/blog/linux/BJrx8LE98CG/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/BJrx8LE98CG/</guid><description>&lt;blockquote>
&lt;p>vsftpd 详细配置说明&lt;/p>
&lt;/blockquote>
&lt;h2 id="vsftpd常用配置">
 vsftpd常用配置
 &lt;a class="anchor" href="#vsftpd%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#关闭匿名用户访问权限&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>anonymous_enable&lt;span style="color:#f92672">=&lt;/span>NO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#开启本地用户权限&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>local_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#开启写权限&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>write_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#设置侦听端口&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>listen_port&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">21&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#写文件时的umask&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>local_umask&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">002&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#被动模式及开放端口段&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#pasv_enable=yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#pasv_min_port=30000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#pasv_max_port=50000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#超时时间&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#idle_session_timeout=6000000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#data_connection_timeout=6000000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dirmessage_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>xferlog_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>connect_from_port_20&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>xferlog_std_format&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chroot_local_user&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chroot_list_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chroot_list_file&lt;span style="color:#f92672">=&lt;/span>/etc/vsftpd/chroot_list
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>listen&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pam_service_name&lt;span style="color:#f92672">=&lt;/span>vsftpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>userlist_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tcp_wrappers&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>use_localtime&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>reverse_lookup_enable&lt;span style="color:#f92672">=&lt;/span>NO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#convert_charset_enable=0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#local_charset=UTF8&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#remote_charset=GB2312&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#double_377=1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>创建账户&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>useradd -M -s /sbin/nologin -d /mnt/usernamefile/ username
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> i in name1 name2 name3;&lt;span style="color:#66d9ef">do&lt;/span> useradd -M -s /sbin/nologin -d /mnt/$i/ $i;&lt;span style="color:#66d9ef">done&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> i in name1 name2 name3;&lt;span style="color:#66d9ef">do&lt;/span> echo &lt;span style="color:#e6db74">&amp;#34;&lt;/span>$i&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#ae81ff">123&lt;/span> | passwd --stdin $i ;&lt;span style="color:#66d9ef">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="创建目录">
 创建目录
 &lt;a class="anchor" href="#%e5%88%9b%e5%bb%ba%e7%9b%ae%e5%bd%95">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mkdir usernamefile
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chown username:username usernamefile
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> i in name1 name2 name3;&lt;span style="color:#66d9ef">do&lt;/span> mkdir /mnt/$i;&lt;span style="color:#66d9ef">done&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> i in name1 name2 name3;&lt;span style="color:#66d9ef">do&lt;/span> chown $i:$i /mnt/$i/;&lt;span style="color:#66d9ef">done&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod -R &lt;span style="color:#ae81ff">770&lt;/span> *
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="vsftpd被动模式">
 vsftpd被动模式
 &lt;a class="anchor" href="#vsftpd%e8%a2%ab%e5%8a%a8%e6%a8%a1%e5%bc%8f">#&lt;/a>
&lt;/h2>
&lt;h3 id="1开启被动模式">
 1、开启被动模式
 &lt;a class="anchor" href="#1%e5%bc%80%e5%90%af%e8%a2%ab%e5%8a%a8%e6%a8%a1%e5%bc%8f">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim vsftpd.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pasv_enable&lt;span style="color:#f92672">=&lt;/span>YES &lt;span style="color:#75715e">#开启被动模式&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pasv_min_port&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3000&lt;/span> &lt;span style="color:#75715e">#随机最小端口&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pasv_max_port&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">4000&lt;/span> &lt;span style="color:#75715e">#随机最大端口&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2加载内核">
 2、加载内核
 &lt;a class="anchor" href="#2%e5%8a%a0%e8%bd%bd%e5%86%85%e6%a0%b8">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>modprobe ip_conntrack_ftp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>modprobe ip_nat_ftp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3防火墙">
 3、防火墙
 &lt;a class="anchor" href="#3%e9%98%b2%e7%81%ab%e5%a2%99">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/sysconfig/iptables 在*filter下加入下
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -A OUTPUT -p tcp --sport 3000:4000 -j ACCEPT
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -A INPUT -p tcp --dport 3000:4000 -j ACCEPT
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>iptables-restore &amp;lt; /etc/sysconfig/iptables 加载iptables配置
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="vsftpd虚拟用户">
 vsftpd虚拟用户
 &lt;a class="anchor" href="#vsftpd%e8%99%9a%e6%8b%9f%e7%94%a8%e6%88%b7">#&lt;/a>
&lt;/h2>
&lt;h3 id="1vsftpd安装">
 1、vsftpd安装
 &lt;a class="anchor" href="#1vsftpd%e5%ae%89%e8%a3%85">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>yum -y install vsftpd &lt;span style="color:#75715e">#vsftpd软件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>yum -y install db4-utils &lt;span style="color:#75715e">#生成虚拟用户认证数据文件命令&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2配置vsftp">
 2、配置vsftp
 &lt;a class="anchor" href="#2%e9%85%8d%e7%bd%aevsftp">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vim /etc/vsftpd/vsftpd.conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> listen&lt;span style="color:#f92672">=&lt;/span>YES &lt;span style="color:#75715e">#独立运行vsftpd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> anonymous_enable&lt;span style="color:#f92672">=&lt;/span>NO &lt;span style="color:#75715e">#限制匿名用户登录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dirmessage_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> xferlog_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> xferlog_file&lt;span style="color:#f92672">=&lt;/span>/var/log/vsftpd.log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> xferlog_std_format&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> chroot_list_enable&lt;span style="color:#f92672">=&lt;/span>YES &lt;span style="color:#75715e">#限制虚拟用户切换目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> chroot_list_file&lt;span style="color:#f92672">=&lt;/span>/etc/vsftpd/chroot_list &lt;span style="color:#75715e">#限制切换目录的用户列表&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> chroot_local_user&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> guest_enable&lt;span style="color:#f92672">=&lt;/span>YES &lt;span style="color:#75715e">#开启虚拟用户认证&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> guest_username&lt;span style="color:#f92672">=&lt;/span>ftp &lt;span style="color:#75715e">#映射的真实用户&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> user_config_dir&lt;span style="color:#f92672">=&lt;/span>/etc/vsftpd/vsftpd_user_conf &lt;span style="color:#75715e">#虚拟用户配置目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pam_service_name&lt;span style="color:#f92672">=&lt;/span>vsftpd.vu &lt;span style="color:#75715e">#vsftpd认证的pam认证模块&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> local_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3虚拟用户db">
 3、虚拟用户db
 &lt;a class="anchor" href="#3%e8%99%9a%e6%8b%9f%e7%94%a8%e6%88%b7db">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /etc/vsftpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim user.txt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> yuangang &lt;span style="color:#75715e">#用户名&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">123456&lt;/span> &lt;span style="color:#75715e">#密码&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>db_load -T -t hash -f user.txt /etc/vsftpd/vsftpd_login.db
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod &lt;span style="color:#ae81ff">600&lt;/span> /etc/vsftpd/vsftpd_login.db
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 配置pam认证&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim /etc/pam.d/vsftpd.vu
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> auth required /lib/security/pam_userdb.so db&lt;span style="color:#f92672">=&lt;/span>/etc/vsftpd/vsftpd_login
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> account required /lib/security/pam_userdb.so db&lt;span style="color:#f92672">=&lt;/span>/etc/vsftpd/vsftpd_login
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim /etc/vsftpd/chroot_list &lt;span style="color:#75715e">#限制虚拟用户切换目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ftp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> yuangang
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="4配置虚拟用户">
 4、配置虚拟用户
 &lt;a class="anchor" href="#4%e9%85%8d%e7%bd%ae%e8%99%9a%e6%8b%9f%e7%94%a8%e6%88%b7">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /etc/vsftpd/vsftpd_user_conf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vim yuangang
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> write_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> anon_world_readable_only&lt;span style="color:#f92672">=&lt;/span>NO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> anon_upload_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> anon_mkdir_write_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> anon_other_write_enable&lt;span style="color:#f92672">=&lt;/span>YES
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> local_root&lt;span style="color:#f92672">=&lt;/span>/data/httpd/yuangang
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 建立虚拟用户ftp目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir /data/httpd/yuangang
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chown -R ftp.root /data/httpd
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>chmod o+rw /data/httpd/yuangang
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="vsftpd-cmds_allowed">
 vsftpd cmds_allowed
 &lt;a class="anchor" href="#vsftpd-cmds_allowed">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cmds_allowed&lt;span style="color:#f92672">=&lt;/span>ABOR,CWD,LIST,MDTM,MKD,NLST,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PASS,PASV,PORT,PWD,QUIT,RETR,RMD,RNFR,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>RNTO,SITE,SIZE,STOR,TYPE,USER,ACCT,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>APPE,CDUP,HELP,MODE,NOOP,REIN,STAT,STOU,STRU,SYST
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>注意:一定不能使用换行和空格，不然就没效果..&lt;/p></description></item><item><title>web运维相关查询命令</title><link>https://notes.zhangwenbing.com/blog/linux/SJ_88EqU0M/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SJ_88EqU0M/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="1-查看tcp连接状态">
 1. 查看TCP连接状态
 &lt;a class="anchor" href="#1-%e6%9f%a5%e7%9c%8btcp%e8%bf%9e%e6%8e%a5%e7%8a%b6%e6%80%81">#&lt;/a>
&lt;/h2>
&lt;pre tabindex="0">&lt;code>netstat -nat |awk &amp;#39;{print $6}&amp;#39;|sort|uniq -c|sort -rn
netstat -n | awk &amp;#39;/^tcp/ {++S[$NF]};END {for(a in S) print a, S[a]}&amp;#39; 或
netstat -n | awk &amp;#39;/^tcp/ {++state[$NF]}; END {for(key in state) print key,&amp;#34;\t&amp;#34;,state[key]}&amp;#39;
netstat -n | awk &amp;#39;/^tcp/ {++arr[$NF]};END {for(k in arr) print k,&amp;#34;\t&amp;#34;,arr[k]}&amp;#39;
netstat -n |awk &amp;#39;/^tcp/ {print $NF}&amp;#39;|sort|uniq -c|sort -rn
netstat -ant | awk &amp;#39;{print $NF}&amp;#39; | grep -v &amp;#39;[a-z]&amp;#39; | sort | uniq -c
&lt;/code>&lt;/pre>&lt;p>(以上每一行实现的效果基本相同，在此列出不同的写法，方便对脚本写法的更深理解）&lt;/p></description></item><item><title>zabbix之无法启动问题及解决办法</title><link>https://notes.zhangwenbing.com/blog/linux/Sykc8UNqICz/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/Sykc8UNqICz/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;p>1、&lt;/p>
&lt;p>错误提示&lt;/p>
&lt;pre tabindex="0">&lt;code>zabbix_agentd [1749]: cannot create PID file [/var/run/zabbix/zabbix_agentd.pid]: [2] No such file or directory
&lt;/code>&lt;/pre>&lt;p>解决方法&lt;/p>
&lt;pre tabindex="0">&lt;code>mkdir /var/run/zabbix/
chown zabbix.zabbix /var/run/zabbix/
chmod g+w /var/run/zabbix/
touch /var/run/zabbix/zabbix_agentd.pid
/etc/init.d/zabbix-agent restart
ps aux | grep zabbix
&lt;/code>&lt;/pre></description></item><item><title>阿里云ECS Linux的rc.local（开机启动）设置不生效</title><link>https://notes.zhangwenbing.com/blog/linux/SytNL84q8Af/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/SytNL84q8Af/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="使用场景">
 使用场景
 &lt;a class="anchor" href="#%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af">#&lt;/a>
&lt;/h2>
&lt;p>前段时间使用阿里云的ecs，将一些开机启动的命令写到/etc/rc.local里面，发现不生效。经过一番查询和搜索之后，最后发现一个坑，居然要给这个文件设置执行权限才生效。&lt;/p></description></item><item><title>排查linux根目录空间占用与实际空间不符</title><link>https://notes.zhangwenbing.com/blog/linux/HJqtULE5I0z/</link><pubDate>Mon, 14 May 2018 04:45:01 +0800</pubDate><guid>https://notes.zhangwenbing.com/blog/linux/HJqtULE5I0z/</guid><description>&lt;blockquote>
&lt;p>none&lt;/p>
&lt;/blockquote>
&lt;h2 id="发现问题">
 发现问题
 &lt;a class="anchor" href="#%e5%8f%91%e7%8e%b0%e9%97%ae%e9%a2%98">#&lt;/a>
&lt;/h2>
&lt;p>首先使用”df -Th”查看根目录的空间使用和”du -sh /“的结果进行对比。&lt;/p>
&lt;h2 id="排查问题">
 排查问题
 &lt;a class="anchor" href="#%e6%8e%92%e6%9f%a5%e9%97%ae%e9%a2%98">#&lt;/a>
&lt;/h2>
&lt;h3 id="第一种情况">
 第一种情况
 &lt;a class="anchor" href="#%e7%ac%ac%e4%b8%80%e7%a7%8d%e6%83%85%e5%86%b5">#&lt;/a>
&lt;/h3>
&lt;p>文件被删掉，但是写这个文件的进程没退出&lt;/p></description></item></channel></rss>