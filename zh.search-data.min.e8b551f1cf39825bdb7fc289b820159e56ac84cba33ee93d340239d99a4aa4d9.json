[{"id":0,"href":"/notes/2025/05/13/gfegatfpustuecdeaifds7/","title":"ğŸ“ deferå®ç°","section":"ğŸ”– Qt","content":" å®ç°ç±»ä¼¼Golangçš„deferçš„æ–¹å¼ # // // Created by å¼ æ–‡å…µ on 2025/5/13. // #ifndef DEFER_H #define DEFER_H #include \u0026lt;functional\u0026gt; class Defer { public: explicit Defer(const std::function\u0026lt;void()\u0026gt; \u0026amp;func) : m_func(func) { } ~Defer() { m_func(); } // ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨è°ƒç”¨ private: std::function\u0026lt;void()\u0026gt; m_func; }; #endif //DEFER_H ä½¿ç”¨æ–¹å¼ # m_mutex.lock(); Defer defer([=]() { m_mutex.unlock(); }); "},{"id":1,"href":"/notes/2025/04/28/akhjvrsank3gkyirsrxgtc/","title":"ğŸ“ è¿è¡Œæ˜¯å´©æºƒ","section":"ğŸ”– build","content":" å¯åŠ¨è½¯ä»¶æ—¶å´©æºƒ(crash) # æ­£å¸¸ç¼–è¯‘æ—¶æ²¡å‡ºç°æŠ¥é”™ï¼Œä½†æ˜¯è¿è¡Œæ—¶ç«‹å³æŠ¥æ®µé”™è¯¯ï¼Œä¸”åªæœ‰éƒ¨åˆ†ç¼–è¯‘å™¨å­˜åœ¨è¿™ä¸ªé—®é¢˜\nè§£å†³æ–¹æ¡ˆ # å‘ç°å¼•å…¥çš„sdkç¼–è¯‘çš„æ—¶å€™æ²¡æœ‰æ·»åŠ -fPICå‚æ•°ã€‚\n-fPICçš„ä½œç”¨ # -fPIC æ˜¯ Position Independent Codeï¼ˆä½ç½®æ— å…³ä»£ç ï¼‰ çš„æ„æ€ã€‚\nå®ƒå‘Šè¯‰ç¼–è¯‘å™¨ï¼šç”Ÿæˆçš„æœºå™¨ä»£ç ä¸èƒ½åŒ…å«ç¡¬ç¼–ç çš„ç»å¯¹åœ°å€ï¼Œè€Œæ˜¯è¦é€šè¿‡ç›¸å¯¹åœ°å€æˆ–è¡¨æ ¼è·³è½¬æ¥è®¿é—®æ•°æ®å’Œå‡½æ•°ã€‚è¿™æ ·ï¼Œç¼–è¯‘å¥½çš„ç›®æ ‡æ–‡ä»¶ï¼ˆæ¯”å¦‚ .o æ–‡ä»¶ï¼‰å°±å¯ä»¥è¢«æ”¾åˆ°å†…å­˜çš„ä»»ä½•ä½ç½®æ‰§è¡Œï¼Œä¸éœ€è¦åœ¨è¿è¡Œæ—¶ä¿®æ”¹ä»£ç æœ¬èº«ã€‚\nåŠ¨æ€é“¾æ¥åº“ï¼ˆ.soï¼‰ # åŠ¨æ€åº“åœ¨è¿è¡Œæ—¶ä¼šè¢«åŠ è½½åˆ°ä»»æ„çš„å†…å­˜ä½ç½®ï¼ˆå–å†³äºç³»ç»Ÿçš„è°ƒåº¦ã€å†…å­˜æƒ…å†µç­‰ï¼‰ã€‚\nå¦‚æœç›®æ ‡æ–‡ä»¶é‡Œæœ‰å›ºå®šåœ°å€ï¼ˆç»å¯¹åœ°å€ï¼‰ï¼Œé‚£ä¸€æ—¦åŠ è½½åˆ°ä¸åŒä½ç½®ï¼Œåœ°å€å°±é”™äº†ï¼Œç¨‹åºå°±å´©äº†ã€‚\næ‰€ä»¥ï¼Œç¼–è¯‘æˆåŠ¨æ€åº“çš„ .o æ–‡ä»¶å¿…é¡»åŠ  -fPICï¼Œä¿è¯å®ƒåœ¨ä»»ä½•ä½ç½®éƒ½èƒ½æ­£ç¡®æ‰§è¡Œã€‚\næ€»ç»“ï¼š # ç¼–åŠ¨æ€åº“æ—¶ï¼Œä¸€å®šè¦åŠ  -fPICï¼Œå¦åˆ™é“¾æ¥æ—¶å‡ºé”™ï¼Œæˆ–è€…è¿è¡Œæ—¶å´©æºƒã€‚\né™æ€é“¾æ¥åº“ï¼ˆ.aï¼‰ # é™æ€åº“åœ¨é“¾æ¥é˜¶æ®µç›´æ¥è¢«æ‰“åŒ…åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚\nå¯æ‰§è¡Œæ–‡ä»¶çš„é“¾æ¥å™¨ï¼ˆldï¼‰ä¼šçŸ¥é“æœ€ç»ˆç¨‹åºè¦åŠ è½½åˆ°å“ªå„¿ï¼Œå› æ­¤ç†è®ºä¸Šå¯ä»¥ä¸ç”¨ -fPICã€‚\nä½†æ˜¯ï¼å¦‚æœä½ æŠŠé™æ€åº“æ‹¿å»ç”ŸæˆåŠ¨æ€åº“ï¼ˆæ¯”å¦‚ gcc -shared é“¾æ¥ .a æ–‡ä»¶ï¼‰ï¼Œåˆå‡ºç°äº†åŒæ ·çš„é—®é¢˜\næ€»ç»“ï¼š # æ™®é€šç¨‹åºé“¾æ¥é™æ€åº“æ—¶å¯ä»¥ä¸åŠ  -fPICï¼Œä½†å¦‚æœè¦æŠŠ .a æ‰“åŒ…è¿› .soï¼Œé™æ€åº“ä¹Ÿå¿…é¡»æ˜¯ -fPIC ç¼–è¯‘çš„ã€‚\n"},{"id":2,"href":"/notes/2025/02/10/7auahqg8nnxm5ydhxzqrnr/","title":"ğŸ“ è°ƒç”¨Pythonä»£ç ","section":"ğŸ”– Python","content":"#include \u0026lt;cstdio\u0026gt; #include \u0026lt;iostream\u0026gt; #include \u0026lt;Python.h\u0026gt; // åŒ…å« Python å¤´æ–‡ä»¶ int main() { // åˆå§‹åŒ– Python è§£é‡Šå™¨ Py_Initialize(); // åˆ›å»ºä¸€ä¸ª Python å­—å…¸æ¥ä¼ é€’å‚æ•° PyObject* pName = PyUnicode_FromString(\u0026#34;__main__\u0026#34;); PyObject* pModule = PyImport_Import(pName); Py_XDECREF(pName); if (pModule != nullptr) { // åˆ›å»ºä¸€ä¸ªå…¨å±€å­—å…¸æ¥å­˜å‚¨å‚æ•° PyObject* pGlobals = PyModule_GetDict(pModule); // å°†å‚æ•°ä½œä¸º Python å¯¹è±¡æ·»åŠ åˆ°å…¨å±€å­—å…¸ä¸­ PyDict_SetItemString(pGlobals, \u0026#34;param1\u0026#34;, PyLong_FromLong(42)); // ç¤ºä¾‹å‚æ•°1 PyDict_SetItemString(pGlobals, \u0026#34;param2\u0026#34;, PyUnicode_FromString(\u0026#34;Hello from C++\u0026#34;)); // ç¤ºä¾‹å‚æ•°2 // å®šä¹‰å¹¶æ‰§è¡Œ Python ä»£ç  const char* script = R\u0026#34;( import platform import sys import os system_info = { \u0026#39;param1\u0026#39;: param1, \u0026#39;param2\u0026#39;: param2, \u0026#39;OS\u0026#39;: platform.system(), \u0026#39;OS Version\u0026#39;: platform.version(), \u0026#39;Release\u0026#39;: platform.release(), \u0026#39;Machine\u0026#39;: platform.machine(), \u0026#39;Processor\u0026#39;: platform.processor(), \u0026#39;Python Version\u0026#39;: sys.version, } print(system_info) )\u0026#34;; // æ‰§è¡Œ Python ä»£ç  const auto result = PyRun_SimpleString(script); std::cout \u0026lt;\u0026lt; \u0026#34;Result from Python: \u0026#34; \u0026lt;\u0026lt; result \u0026lt;\u0026lt; std::endl; Py_XDECREF(pModule); } else { PyErr_Print(); std::cerr \u0026lt;\u0026lt; \u0026#34;Failed to load the Python script\u0026#34; \u0026lt;\u0026lt; std::endl; } // å…³é—­ Python è§£é‡Šå™¨ Py_Finalize(); return 0; } "},{"id":3,"href":"/notes/2024/08/01/rnc4n7cfifidx8ca2rhjme/","title":"ğŸ“ QMLé¼ æ ‡äº‹ä»¶","section":"ğŸ”– QtQml","content":" ç¤ºä¾‹ä»£ç  # import QtQuick 2.15 import QtQuick.Controls 2.15 ApplicationWindow { visible: true width: 640 height: 480 Rectangle { id: container width: 200 height: 200 color: \u0026#34;lightblue\u0026#34; MouseArea { anchors.fill: parent onEntered: { console.log(\u0026#34;Mouse entered\u0026#34;) container.color = \u0026#34;lightgreen\u0026#34; } onExited: { console.log(\u0026#34;Mouse exited\u0026#34;) container.color = \u0026#34;lightblue\u0026#34; } } } } é—®é¢˜æè¿° # é¼ æ ‡è¿›å…¥çŸ©å½¢åŒºåŸŸæ—¶ï¼Œä¸ä¼šæ”¹å˜çŸ©å½¢çš„é¢œè‰²ã€‚\nè§£å†³æ–¹æ³• # éœ€è¦åœ¨MouseAreaä¸­è®¾ç½®hoverEnabled: trueå±æ€§ï¼Œè¿™æ ·é¼ æ ‡è¿›å…¥çŸ©å½¢åŒºåŸŸæ—¶ï¼Œä¼šè§¦å‘onEnteredäº‹ä»¶ï¼Œæ”¹å˜çŸ©å½¢çš„é¢œè‰²ã€‚\n"},{"id":4,"href":"/notes/2024/06/06/sf4ff6x8cuyhvzougj9dwg/","title":"ğŸ“ MacOSç­¾å","section":"ğŸ”– MacOS","content":" ä¸‹è½½æ ¹è¯ä¹¦ # https://www.apple.com/certificateauthority/DeveloperIDG2CA.cer\nå¯¼å…¥æ ¹è¯ä¹¦ # sudo security import ~/Downloads/DeveloperIDG2CA.cer \\ -k /Library/Keychains/System.keychain \\ -T /usr/bin/codesign \\ -T /usr/bin/security \\ -T /usr/bin/productbuild æŸ¥çœ‹å’Œæ¸…ç†ç‰¹æ®Šå±æ€§ # xattr -lr xxx.app xattr -cr xxx.app ç­¾å‘APP # codesign --deep --force --verbose --sign \u0026#34;xxxx\u0026#34; xxx.app éªŒè¯ç­¾å # spctl --assess --type execute --verbose=4 xxx.app å‚è€ƒæ–‡æ¡£ # https://testerhome.com/topics/33338\nhttps://www.apple.com/certificateauthority/\nhttps://www.jianshu.com/p/f420649fba42\n"},{"id":5,"href":"/notes/2024/03/11/j3c62fv8dglvf2kg975zlv/","title":"ğŸ“ æ ‡ç­¾æ“ä½œ","section":"ğŸ“” Git","content":" åˆ›å»ºæ ‡ç­¾ # git tag \u0026lt;tagname\u0026gt; æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ # git push origin \u0026lt;tagname\u0026gt; æ¨é€æ‰€æœ‰æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ # git push origin --tags æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰æ ‡ç­¾ # git tag æŸ¥çœ‹è¿œç¨‹æ‰€æœ‰æ ‡ç­¾ # git ls-remote --tags origin åˆ é™¤æœ¬åœ°æˆ–è¿œç¨‹æ ‡ç­¾ # git tag -d \u0026lt;tagname\u0026gt; # åˆ é™¤è¿œç¨‹æ ‡ç­¾ git push origin :refs/tags/\u0026lt;tagname\u0026gt; "},{"id":6,"href":"/notes/2024/03/06/e3ksq3zkmps14gcxuirwzx/","title":"ğŸ“ æ‰€æœ‰æƒ","section":"ğŸ”– å­¦ä¹ ç¬”è®°","content":" æ‰€æœ‰æƒ # æ‰€æœ‰æƒè§„åˆ™ # Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€‚ å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚ å½“æ‰€æœ‰è€…ï¼ˆå˜ï¥¾ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚ å¯Copyçš„ç±»å‹ # æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œæ¯”å¦‚ u32 ã€‚ å¸ƒå°”ç±»å‹ï¼Œbool ï¼Œå®ƒçš„å€¼æ˜¯ true å’Œ false ã€‚ æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹ï¼Œæ¯”å¦‚ f64 ã€‚ å­—ç¬¦ç±»å‹ï¼Œchar ã€‚ å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½å®ç° Copy çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ(i32, i32) å®ç°äº† Copy ï¼Œä½†(i32, String) å°±æ²¡æœ‰ã€‚ "},{"id":7,"href":"/notes/2025/05/13/6dhpyx7jyybzrnvw7qremy/","title":"ğŸ“ å¼‚æ­¥æ›´æ–°UI","section":"ğŸ”– Qt","content":" å¼‚æ­¥å®šæ—¶æ›´æ–°UI # å°½é‡çš„å‡å°‘å¡UIé—®é¢˜\n// // Created by å¼ æ–‡å…µ on 2025/5/13. // #ifndef TASKRUNNER_H #define TASKRUNNER_H #include \u0026lt;QFuture\u0026gt; #include \u0026lt;QElapsedTimer\u0026gt; #include \u0026lt;QtConcurrent\u0026gt; #include \u0026lt;atomic\u0026gt; #include \u0026lt;functional\u0026gt; #include \u0026lt;QThread\u0026gt; class TaskRunner { public: TaskRunner() = default; ~TaskRunner() { stop(); } void start(const int intervalMs, const std::function\u0026lt;void()\u0026gt; \u0026amp;task) { if (m_future.isRunning()) { return; } m_exit = false; m_future = QtConcurrent::run([=]() { QElapsedTimer timer; task(); // ç«‹å³æ‰§è¡Œä¸€æ¬¡ timer.start(); while (!m_exit) { if (timer.elapsed() \u0026gt;= intervalMs) { task(); // å‘¨æœŸæ‰§è¡Œ timer.restart(); } if (!m_exit) { QThread::msleep(100); // å¯è°ƒç²¾åº¦ } } }); } void stop() { m_exit = true; if (m_future.isRunning()) { m_future.waitForFinished(); } } private: std::atomic\u0026lt;bool\u0026gt; m_exit = false; QFuture\u0026lt;void\u0026gt; m_future; }; #endif //TASKRUNNER_H ä½¿ç”¨æ–¹å¼ # // è¿è¡Œä»»åŠ¡ m_taskRunner-\u0026gt;start(5000, [this]() { onUpdateTaskInfo(); }); // åœæ­¢ä»»åŠ¡ m_taskRunner-\u0026gt;stop(); "},{"id":8,"href":"/notes/2025/04/30/fqog2lfxmepcxbbyzucxeq/","title":"ğŸ“ å†…å­˜é‡å ","section":"ğŸ”– build","content":" sprintf/snprintf ä¸å†…å­˜é‡å é—®é¢˜åˆ†æï¼ˆUbuntu/Debianï¼‰ # èƒŒæ™¯ # åœ¨ Ubuntu/Debian ç³»ç»Ÿä¸­ï¼Œæœ€è¿‘é’ˆå¯¹ sprintf å’Œ snprintf å‡½æ•°åœ¨å†…å­˜é‡å æƒ…å†µä¸‹çš„è¡Œä¸ºå±•å¼€äº†è®¨è®ºã€‚å°¤å…¶æ˜¯åœ¨å¯ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–é€‰é¡¹åï¼Œè¿™ç±»é—®é¢˜å¯èƒ½å¯¼è‡´ç¨‹åºè¡Œä¸ºå¼‚å¸¸ï¼Œç”šè‡³å‡ºç°æ•°æ®ä¸¢å¤±ã€‚\nå‡½æ•°åŸå‹ä¸ restrict å…³é”®å­— # int sprintf(char *restrict s, const char *restrict format, ...); restrict æ˜¯ C99 å¼•å…¥çš„å…³é”®å­—ï¼Œç”¨äºå‘Šè¯‰ç¼–è¯‘å™¨è¯¥æŒ‡é’ˆæ˜¯è®¿é—®å…¶æŒ‡å‘å†…å­˜çš„å”¯ä¸€æ‰‹æ®µã€‚è¿™æ„å‘³ç€å¤šä¸ªå‚æ•°å¦‚æœæŒ‡å‘åŒä¸€å—å†…å­˜åŒºåŸŸï¼Œåˆ™è¡Œä¸ºæ˜¯æœªå®šä¹‰çš„ï¼ˆundefined behaviorï¼‰ã€‚\né—®é¢˜ç¤ºä¾‹ # è®¸å¤šç¨‹åºå‘˜åœ¨ä½¿ç”¨ sprintf æ—¶ï¼Œå°†å…¶ä½œä¸ºå¢å¼ºç‰ˆçš„ strcat ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š\nsprintf(buf, \u0026#34;%s foo %d %d\u0026#34;, buf, var1, var2); åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆbufï¼‰æŒ‡å‘åŒä¸€å†…å­˜åŒºåŸŸï¼Œè¿åäº† restrict è¯­ä¹‰ã€‚è¿™ç§ç”¨æ³•è™½ç„¶å¹¿æ³›å­˜åœ¨ï¼Œä½†å±äºæœªå®šä¹‰è¡Œä¸ºï¼Œå¯èƒ½åœ¨æŸäº›ç¼–è¯‘ç¯å¢ƒä¸‹å‡ºç°é—®é¢˜ã€‚\nç¤ºä¾‹ä»£ç  # ä»¥ä¸‹ç¨‹åºåœ¨ GCC ä¸­ï¼Œå¯ç”¨ä¼˜åŒ–ï¼ˆå¦‚ -O1, -O2ï¼‰åä¼šè¾“å‡º \u0026quot;fail\u0026quot;ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„ \u0026quot;not fail\u0026quot;ï¼š\n#include \u0026lt;stdio.h\u0026gt; char buf[80] = \u0026#34;not \u0026#34;; int main() { sprintf(buf, \u0026#34;%sfail\u0026#34;, buf); puts(buf); // è¾“å‡ºå¯èƒ½ä¸º \u0026#34;fail\u0026#34; return 0; } è§£é‡Š # åœ¨å¯ç”¨ä¼˜åŒ–æ—¶ï¼ŒGCC å‡è®¾ buf åªè¢« sprintf çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¿®æ”¹ï¼Œå› æ­¤å¯èƒ½å…ˆæ¸…ç©ºç›®æ ‡å†…å­˜ï¼Œä»è€Œå¯¼è‡´æºå­—ç¬¦ä¸²å†…å®¹ä¸¢å¤±ã€‚\næ¨èåšæ³• # ä¸ºäº†é¿å…æ­¤ç±»æœªå®šä¹‰è¡Œä¸ºï¼Œæ¨èä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼š\nsprintf(buf + strlen(buf), \u0026#34; foo %d %d\u0026#34;, var1, var2); è¿™æ ·å¯ä»¥ç¡®ä¿ç›®æ ‡å†…å­˜ä¸æºæ•°æ®ä¸é‡å ï¼Œç¬¦åˆ restrict çš„è¯­ä¹‰ã€‚\nå…³äº snprintf # snprintf åŒæ ·å­˜åœ¨ç±»ä¼¼é—®é¢˜ï¼Œå› ä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯å¸¦æœ‰ restrict é™å®šçš„æŒ‡é’ˆã€‚\næ€»ç»“ # sprintf å’Œ snprintf çš„å‚æ•°ä¸èƒ½æŒ‡å‘é‡å çš„å†…å­˜åŒºåŸŸã€‚ å¯ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–æ—¶ï¼Œä½¿ç”¨é‡å å†…å­˜çš„ sprintf è°ƒç”¨å¯èƒ½å¯¼è‡´æ„æ–™ä¹‹å¤–çš„ç»“æœã€‚ æ­£ç¡®åšæ³•æ˜¯å°†ç›®æ ‡åœ°å€ç§»è‡³å­—ç¬¦ä¸²æœ«å°¾ï¼Œé¿å…ä¸æºæ•°æ®å†²çªã€‚ å‚è€ƒ # C99 æ ‡å‡†æ–‡æ¡£ä¸­å…³äº restrict çš„å®šä¹‰ GCC ç¼–è¯‘å™¨è¡Œä¸ºä¸ä¼˜åŒ–ç­–ç•¥ "},{"id":9,"href":"/notes/2025/02/10/gqci9riugfetribe6j6fou/","title":"ğŸ“ è°ƒç”¨Pythonæ–¹æ³•","section":"ğŸ”– Python","content":"#include \u0026lt;Python.h\u0026gt; #include \u0026lt;iostream\u0026gt; int main() { // åˆå§‹åŒ– Python è§£é‡Šå™¨ Py_Initialize(); // åˆ›å»º Python å­—å…¸å¹¶å°†å‚æ•°ä¼ é€’ç»™ Python PyObject* pName = PyUnicode_FromString(\u0026#34;__main__\u0026#34;); PyObject* pModule = PyImport_Import(pName); Py_XDECREF(pName); if (pModule != nullptr) { // åˆ›å»ºä¸€ä¸ªå…¨å±€å­—å…¸æ¥å­˜å‚¨å‚æ•° PyObject* pGlobals = PyModule_GetDict(pModule); // åˆ›å»º Python å‡½æ•° const char* func_code = R\u0026#34;( def my_function(param1, param2): return f\u0026#34;Received param1: {param1}, param2: {param2}\u0026#34; )\u0026#34;; // æ‰§è¡Œå®šä¹‰å‡½æ•°çš„ä»£ç  PyRun_SimpleString(func_code); // è·å– Python å‡½æ•°å¯¹è±¡ PyObject* pFunc = PyDict_GetItemString(pGlobals, \u0026#34;my_function\u0026#34;); if (PyCallable_Check(pFunc)) { // å‡†å¤‡å‚æ•° PyObject* pArgs = PyTuple_Pack(2, PyLong_FromLong(42), PyUnicode_FromString(\u0026#34;Hello from C++\u0026#34;)); // è°ƒç”¨å‡½æ•° PyObject* pValue = PyObject_CallObject(pFunc, pArgs); if (pValue != nullptr) { // æ‰“å°å‡½æ•°è¿”å›å€¼ std::cout \u0026lt;\u0026lt; \u0026#34;Function returned: \u0026#34; \u0026lt;\u0026lt; PyUnicode_AsUTF8(pValue) \u0026lt;\u0026lt; std::endl; Py_XDECREF(pValue); } else { PyErr_Print(); } Py_XDECREF(pArgs); } else { PyErr_Print(); } } else { PyErr_Print(); std::cerr \u0026lt;\u0026lt; \u0026#34;Failed to load the Python module\u0026#34; \u0026lt;\u0026lt; std::endl; } // å…³é—­ Python è§£é‡Šå™¨ Py_Finalize(); return 0; } "},{"id":10,"href":"/notes/2024/08/06/ny773erqjgbzmzgfikfvds/","title":"ğŸ“ QMLè™šæ‹Ÿåˆ—è¡¨","section":"ğŸ”– QtQml","content":"import QtQuick 2.15 import QtQuick.Controls 2.15 ApplicationWindow { visible: true width: 640 height: 28 Flickable { id: flickable width: parent.width height: parent.height contentWidth: 51200 // æ ¹æ®éœ€è¦è°ƒæ•´åˆ»åº¦å°ºé•¿åº¦ï¼ˆ1000ä¸ªåˆ»åº¦ï¼Œæ¯ä¸ªåˆ»åº¦é—´éš”51.2ï¼‰ clip: true Component.onCompleted: updateVisibleRange() onContentXChanged: updateVisibleRange() onWidthChanged: updateVisibleRange() function updateVisibleRange() { var itemWidth = 51.2; var firstIndex = Math.floor(flickable.contentX / itemWidth); var visibleCount = Math.ceil(flickable.width / itemWidth) + 1; firstVisibleIndex = firstIndex; lastVisibleIndex = firstIndex + visibleCount; createVisibleItems(); } property int firstVisibleIndex: 0 property int lastVisibleIndex: 0 function createVisibleItems() { itemContainer.children.forEach(function(item) { item.destroy(); }); for (var i = firstVisibleIndex; i \u0026lt;= lastVisibleIndex; i++) { var item = itemComponent.createObject(itemContainer, { index: i, width: 1, height: flickable.height, x: i * 51.2 }); } } Item { id: itemContainer anchors.fill: parent } Component { id: itemComponent Item { property int index Rectangle { property int itemIndex: index anchors.bottom: parent.bottom width: 1 height: index % 10 === 0 ? 18 : index % 5 === 0 ? 9 : 4 color: \u0026#34;black\u0026#34; Repeater { model: index % 10 === 0 ? 1 : 0 Label { anchors.left: parent.right anchors.leftMargin: 2 anchors.bottom: parent.bottom anchors.bottomMargin: 4 // color: activePalette.windowText text: parent.itemIndex } } } } } } } "},{"id":11,"href":"/notes/2024/05/28/3txbbb7iruppjsg4p7rwnb/","title":"ğŸ“ MacOSå †æ ˆå¤§å°","section":"ğŸ”– MacOS","content":" é—®é¢˜ä»£ç  # char buffer[8*1024*1024]; é—®é¢˜åˆ†æ # macosç³»ç»Ÿé»˜è®¤çš„å †æ ˆå¤§å°ä¸º8MBï¼Œå¯ä»¥é€šè¿‡ulimitå‘½ä»¤æŸ¥çœ‹å’Œä¿®æ”¹ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä»£ç ä¸­ä½¿ç”¨äº†å¤§é‡çš„å †æ ˆå˜é‡ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚ # æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤çš„å †æ ˆå¤§å° ulimit -a # æˆ–è€… ulimit -s è§£å†³æ–¹æ¡ˆ # char *buffer = new char[8*1024*1024]; // è®°å¾—é‡Šæ”¾ delete[] buffer; "},{"id":12,"href":"/notes/2024/03/14/5kqlzqjqawbxf2t6vusxar/","title":"ğŸ“ åˆ é™¤Commit","section":"ğŸ“” Git","content":"# è·å–commitä¿¡æ¯ git log # commit-id è¦åˆ é™¤commitçš„ä¸‹ä¸€ä¸ªcommit-id git rebase -i (commit-id) # ç¼–è¾‘æ–‡ä»¶ï¼Œå°†è¦åˆ é™¤çš„commitä¹‹å‰çš„pickæ”¹ä¸ºdrop # ä¿å­˜æ–‡ä»¶é€€å‡º # å†æ¬¡æŸ¥çœ‹commitä¿¡æ¯ï¼Œç¡®è®¤åˆ é™¤æˆåŠŸ git log "},{"id":13,"href":"/notes/2024/03/06/o4arkqgfnqygr5ckif2gkk/","title":"ğŸ“ å€Ÿç”¨ä¸å¼•ç”¨","section":"ğŸ”– å­¦ä¹ ç¬”è®°","content":" å€Ÿç”¨ä¸å¼•ç”¨ # åˆ›å»ºä¸€ä¸ªå¼•ç”¨çš„ï¨ˆä¸ºç§°ä¸º å€Ÿç”¨ å…è®¸ä½¿ç”¨å€¼ä½†ï¥§è·å–å…¶æ‰€æœ‰æƒ å¼•ç”¨è§„åˆ™ # åœ¨ä»»æ„ç»™å®šæ—¶é—´ï¼Œè¦ä¹ˆ åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œè¦ä¹ˆ åªèƒ½æœ‰å¤šä¸ªï¥§å¯å˜å¼•ç”¨ã€‚ å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„ã€‚ å¯å˜å¼•ç”¨ # å…è®¸ä¿®æ”¹ä¸€ä¸ªå€Ÿç”¨çš„å€¼ï¼Œè¿™å°±æ˜¯å¯å˜å¼•ç”¨ï¼ˆ\u0026amp;mutï¼‰ã€‚\nfn main() { let mut s = String::from(\u0026#34;hello\u0026#34;); change(\u0026amp;mut s); } fn change(some_string: \u0026amp;mut String) { some_string.push_str(\u0026#34;, world\u0026#34;); } æ‚¬å‚å¼•ç”¨ï¼ˆDangling Referencesï¼‰ # fn main() { let reference_to_nothing = dangle(); } fn dangle() -\u0026gt; \u0026amp;String { // dangle è¿”å›ä¸€ä¸ªå­—ç¬¦ï¤…çš„å¼•ç”¨ let s = String::from(\u0026#34;hello\u0026#34;); // s æ˜¯ä¸€ä¸ªæ–°å­—ç¬¦ï¤… \u0026amp;s // è¿”å›å­—ç¬¦ï¤… s çš„å¼•ç”¨ } // è¿™ï§© s ç¦»å¼€ä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒã€‚å…¶å†…å­˜è¢«é‡Šæ”¾ã€‚ // å±é™©ï¼ "},{"id":14,"href":"/notes/2025/02/10/pkdrvn9md3ggfmbxahx4ef/","title":"ğŸ“ æ³¨å†ŒPythonæ¨¡å—","section":"ğŸ”– Python","content":"#include \u0026lt;Python.h\u0026gt; #include \u0026lt;iostream\u0026gt; // ç¤ºä¾‹ç»“æ„ä½“ï¼ˆC++å¯¹è±¡ï¼‰ struct MyStruct { int value; }; // C++ ä» Python è·å– `void*` å¹¶ä½¿ç”¨ static PyObject* use_object(PyObject* self, PyObject* args) { PyObject* capsule; if (!PyArg_ParseTuple(args, \u0026#34;O\u0026#34;, \u0026amp;capsule)) { return nullptr; } // å–å› `void*` å¹¶è½¬æ¢å› C++ æŒ‡é’ˆ auto* obj = static_cast\u0026lt;MyStruct*\u0026gt;(PyCapsule_GetPointer(capsule, \u0026#34;this\u0026#34;)); if (!obj) { PyErr_SetString(PyExc_RuntimeError, \u0026#34;Invalid capsule!\u0026#34;); return nullptr; } std::cout \u0026lt;\u0026lt; \u0026#34;Received C++ object with value: \u0026#34; \u0026lt;\u0026lt; obj-\u0026gt;value \u0026lt;\u0026lt; std::endl; return PyLong_FromLong(obj-\u0026gt;value); } // Python æ–¹æ³•è¡¨ static PyMethodDef CppMethods[] = { {\u0026#34;use_object\u0026#34;, use_object, METH_VARARGS, \u0026#34;Use a C++ object from PyCapsule\u0026#34;}, {nullptr, nullptr, 0, nullptr} }; // Python æ¨¡å—å®šä¹‰ static struct PyModuleDef cppModule = { PyModuleDef_HEAD_INIT, \u0026#34;cppModule\u0026#34;, nullptr, -1, CppMethods }; // åˆå§‹åŒ– Python æ¨¡å— PyMODINIT_FUNC PyInit_cppModule(void) { return PyModule_Create(\u0026amp;cppModule); } int main() { // åˆå§‹åŒ– Python è§£é‡Šå™¨ Py_Initialize(); PyObject* pModule = PyImport_AddModule(\u0026#34;__main__\u0026#34;); PyObject* pGlobals = PyModule_GetDict(pModule); // æ³¨å†Œ C++ æ–¹æ³•åˆ° Python PyObject* pCppModule = PyModule_Create(\u0026amp;cppModule); PyDict_SetItemString(pGlobals, \u0026#34;cppModule\u0026#34;, pCppModule); // æ‰§è¡Œ Python ä»£ç  const auto python_code = R\u0026#34;( def my_function(capsule): result = cppModule.use_object(capsule) # ä¼ å› C++ å¤„ç† print(f\u0026#34;Python received: {result}\u0026#34;) return result )\u0026#34;; PyRun_SimpleString(python_code); // è·å– Python å‡½æ•°å¯¹è±¡ if (PyObject* pFunc = PyDict_GetItemString(pGlobals, \u0026#34;my_function\u0026#34;); PyCallable_Check(pFunc)) { auto* obj = new MyStruct{42}; // åˆ›å»º C++ å¯¹è±¡ const auto capsule = PyCapsule_New(obj, \u0026#34;this\u0026#34;, nullptr); // è¿”å›å°è£…çš„æŒ‡é’ˆ // å‡†å¤‡å‚æ•° PyObject* pArgs = PyTuple_Pack(1, capsule); // è°ƒç”¨å‡½æ•° if (PyObject* pValue = PyObject_CallObject(pFunc, pArgs); pValue != nullptr) { // æ‰“å°å‡½æ•°è¿”å›å€¼ std::cout \u0026lt;\u0026lt; \u0026#34;Function returned: \u0026#34; \u0026lt;\u0026lt; PyLong_AsLong(pValue) \u0026lt;\u0026lt; std::endl; Py_XDECREF(pValue); } else { PyErr_Print(); } Py_XDECREF(pArgs); } else { PyErr_Print(); } // å…³é—­ Python è§£é‡Šå™¨ Py_Finalize(); return 0; } "},{"id":15,"href":"/blog/git/WNYzxj6GR/","title":"ğŸ“ gitä¹‹åˆ é™¤è¿œç¨‹åˆ†æ”¯","section":"ğŸ“” Git","content":" gitåˆ é™¤è¿œç¨‹åˆ†æ”¯å°±è¿™ä¹ˆç®€å•\ngit push origin --delete [branch_name] "},{"id":16,"href":"/blog/git/-fZeBsu3T/","title":"ğŸ“ gitæ›´æ–°.gitignore","section":"ğŸ“” Git","content":" ä¸€èˆ¬ç›´æ¥ä¿®æ”¹.gitignoreæ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œéœ€è¦å…ˆæ¸…ç†ç¼“å­˜ï¼Œå†ä¿®æ”¹.gitignoreã€‚\ngit rm -r --cached . git add . git commit -m \u0026#39;update .gitignore\u0026#39; "},{"id":17,"href":"/blog/git/H1Krv6b-4/","title":"ğŸ“ gitä¿®æ”¹å†å²cimmitä¿¡æ¯","section":"ğŸ“” Git","content":" git ä½¿ç”¨rebaseä¿®æ”¹å†å²æäº¤çš„cimmitä¿¡æ¯\n1ã€ä¿®æ”¹æŒ‡å®šcommit # git rebase -i 36224db æˆ–:\ngit rebase -i HEAD~3 2ã€æŠŠpickæ”¹ä¸ºedit # pickï¼šä¿ç•™è¯¥commitï¼ˆç¼©å†™:pï¼‰\nrewordï¼šä¿ç•™è¯¥commitï¼Œä½†æˆ‘éœ€è¦ä¿®æ”¹è¯¥commitçš„æ³¨é‡Šï¼ˆç¼©å†™:rï¼‰\neditï¼šä¿ç•™è¯¥commit, ä½†æˆ‘è¦åœä¸‹æ¥ä¿®æ”¹è¯¥æäº¤(ä¸ä»…ä»…ä¿®æ”¹æ³¨é‡Š)ï¼ˆç¼©å†™:eï¼‰\nsquashï¼šå°†è¯¥commitå’Œå‰ä¸€ä¸ªcommitåˆå¹¶ï¼ˆç¼©å†™:sï¼‰\nfixupï¼šå°†è¯¥commitå’Œå‰ä¸€ä¸ªcommitåˆå¹¶ï¼Œä½†æˆ‘ä¸è¦ä¿ç•™è¯¥æäº¤çš„æ³¨é‡Šä¿¡æ¯ï¼ˆç¼©å†™:fï¼‰\nexecï¼šæ‰§è¡Œshellå‘½ä»¤ï¼ˆç¼©å†™:xï¼‰\ndropï¼šæˆ‘è¦ä¸¢å¼ƒè¯¥commitï¼ˆç¼©å†™:dï¼‰\n3ã€ä¿®æ”¹commitä¿¡æ¯ # git commit --amend git rebase --continue 4ã€æ¨é€åˆ°è¿œç¨‹ä»“åº“ # git push -f origin master "},{"id":18,"href":"/blog/git/By9OI51xN/","title":"ğŸ“ gitåŸºç¡€ç¬”è®°","section":"ğŸ“” Git","content":" gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆã€é«˜é€Ÿçš„å¤„ç†ä»å¾ˆå°åˆ°éå¸¸å¤§çš„é¡¹ç›®ç‰ˆæœ¬ç®¡ç†ã€‚\nå…‹éš†é¡¹ç›® # git clone https://github.com/golang/go.git æŸ¥çœ‹è¿œç¨‹ä»“åº“ # git remote -v æ·»åŠ è¿œç¨‹ä»“åº“ # è¦æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªç®€å•çš„åå­—ï¼Œä»¥ä¾¿å°†æ¥å¼•ç”¨ï¼Œè¿è¡Œ git remote add [shortname] [url]ï¼š\ngit remote add pb https://github.com/golang/go.git ç°åœ¨å¯ä»¥ç”¨å­—ç¬¦ä¸² pb æŒ‡ä»£å¯¹åº”çš„ä»“åº“åœ°å€äº†ã€‚æ¯”å¦‚è¯´ï¼Œè¦æŠ“å–æ‰€æœ‰ Paul æœ‰çš„ï¼Œä½†æœ¬åœ°ä»“åº“æ²¡æœ‰çš„ä¿¡æ¯ï¼Œå¯ä»¥è¿è¡Œ git fetch pb\nä»è¿œç¨‹ä»“åº“æŠ“å–æ•°æ® # git fetch [remote-name] æ¨é€æ•°æ®åˆ°è¿œç¨‹ä»“åº“ # git push [remote-name] [branch-name]\ngit push origin master æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯ # git remote show [remote-name]\ngit remote show origin é‡å‘½åè¿œç¨‹ä»“åº“ # git remote rename old_remote-name new_remote-name\ngit remote rename pb test åˆ é™¤è¿œç¨‹ä»“åº“ # git remote rm remote-name\ngit remote rm test "},{"id":19,"href":"/blog/git/Hk6GGp6cQ/","title":"ğŸ“ Gitå›æ»šåˆ°æŸä¸ªcommit","section":"ğŸ“” Git","content":" gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆã€é«˜é€Ÿçš„å¤„ç†ä»å¾ˆå°åˆ°éå¸¸å¤§çš„é¡¹ç›®ç‰ˆæœ¬ç®¡ç†ã€‚\nå›æ»šå‘½ä»¤ # git reset --hard HEAD^ #å›æ»šåˆ°ä¸Šä¸ªç‰ˆæœ¬ git reset --hard HEAD~3 #å›æ»šåˆ°å‰3æ¬¡æäº¤ä¹‹å‰ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå›é€€åˆ°næ¬¡æäº¤ä¹‹å‰ git reset --hard commit_id #å›æ»šåˆ°æŒ‡å®šcommitçš„shaç‰ˆæœ¬ æ¨é€å‘½ä»¤ # git push origin HEAD --force #å¼ºåˆ¶æ¨é€åˆ°è¿œç¨‹ æ¸©é¦¨æç¤º # å›æ»šæœ‰é£é™©ï¼Œè¯·æå‰åšå¥½å¤‡ä»½ã€‚\n"},{"id":20,"href":"/links/","title":"ğŸ¤ å‹æƒ…é“¾æ¥","section":"Docs","content":" "},{"id":21,"href":"/articles/2025/05/13/zjrbjxuzwztru8utgsmvbf/","title":"FFmpegè‡ªåŠ¨æ£€æµ‹è£å‰ªé»‘è¾¹","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"#!/bin/bash # ç”¨æ³•æç¤º if [ \u0026#34;$#\u0026#34; -ne 1 ]; then echo \u0026#34;ç”¨æ³•: $0 \u0026lt;è¾“å…¥æ–‡ä»¶è·¯å¾„\u0026gt;\u0026#34; exit 1 fi INPUT=\u0026#34;$1\u0026#34; OUTPUT=\u0026#34;${1%.*}\u0026#34; OUTPUT_EXT=\u0026#34;${1##*.}\u0026#34; # è‡ªåŠ¨æ£€æµ‹ crop å‚æ•° CROP=$(ffmpeg -i \u0026#34;$INPUT\u0026#34; -vf cropdetect=24:16:0 -t 30 -f null - 2\u0026gt;\u0026amp;1 | grep -o \u0026#39;crop=[^ ]*\u0026#39; | sort | uniq -c | sort -nr | head -n1 | awk \u0026#39;{print $2}\u0026#39;) if [ -z \u0026#34;$CROP\u0026#34; ]; then echo \u0026#34;æœªèƒ½æ£€æµ‹åˆ°æœ‰æ•ˆçš„ crop å‚æ•°\u0026#34; exit 1 fi echo \u0026#34;æ£€æµ‹åˆ°è£å‰ªå‚æ•°: $CROP\u0026#34; # æ‰§è¡Œè£å‰ª ffmpeg -i \u0026#34;$INPUT\u0026#34; -vf \u0026#34;$CROP\u0026#34; -c:v libx264 -crf 10 -c:a copy \u0026#34;${OUTPUT}_crop.${OUTPUT_EXT}\u0026#34; "},{"id":22,"href":"/articles/2024/12/23/wvkjyjt7qhumo4jpucheca/","title":"Linuxç¡¬ç›˜æ•…éšœç›¸å…³çš„æŸ¥è¯¢å‘½ä»¤","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" æŸ¥çœ‹ç¡¬ç›˜åŠå¯¹åº”çš„UUIDä¿¡æ¯ # # æŸ¥çœ‹ç¡¬ç›˜åŠå¯¹åº”çš„UUIDä¿¡æ¯ æˆ–è€…æ˜¯æ‰€æœ‰ç¡¬ç›˜çš„UUIDä¿¡æ¯ blkid [/dev/sda1] # lsblk -o NAME,UUID -p æŸ¥çœ‹UUIDå¯¹åº”çš„ç¡¬ç›˜è·¯å¾„ # blkid -U 383bc776-fc1a-4040-ad8f-45f4f5d96fcf æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯ # lshw -class disk æ£€æµ‹ç£ç›˜æ˜¯å¦æŸå # badblocks -b 4096 -v /dev/sda # ä¹Ÿæœ‰åå¿«çš„å±è”½æ–¹å¼è¿™ä¸ªé‡Œå°±ä¸åˆ—ä¸¾äº† ç‚¹äº®ç¡¬ç›˜LED # dd if=/dev/sda of=/dev/null bs=1M count=100 # ç‚¹äº®ç¡¬ç›˜LED æŸ¥çœ‹æœåŠ¡å™¨åºåˆ—å· # dmidecode -t 1 # æŸ¥çœ‹å¯¹åº”çš„\u0026#39;Serial Number\u0026#39;å­—æ®µ "},{"id":23,"href":"/articles/2024/11/15/mcagbs9lfdrnxxu9k29t9j/","title":"ä½¿ç”¨FFmpegç”Ÿæˆæµ‹è¯•è§†é¢‘","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ç”Ÿæˆ23.976fpsçš„æµ‹è¯•è§†é¢‘ # ffmpeg -f lavfi -i testsrc=size=1280x720:rate=30 -vf \u0026#34;drawtext=text=\u0026#39;%{pts\\:hms} %{n}\u0026#39;:x=(w-text_w)/2:y=100:fontsize=48:fontcolor=white:boxcolor=black@0.5:borderw=2\u0026#34; -r 23.976 -t 10 -y output.mp4 "},{"id":24,"href":"/articles/2024/03/27/e4c2nybngzu5eddbnmdjgq/","title":"Mambaæ›¿ä»£Conda","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"mambaæ˜¯ä¸€ä¸ªcondaçš„æ›¿ä»£å“ï¼Œå¯ä»¥åŠ é€Ÿcondaçš„åŒ…ç®¡ç†ï¼Œæå‡åŒ…ç®¡ç†çš„æ•ˆç‡ã€‚\nå®‰è£… # brew install micromamba é…ç½® # # æ ¹æ®å‘½ä»¤æç¤ºï¼Œä¿®æ”¹~/.zshrcæ–‡ä»¶ micromamba shell init -s zsh -p ~/.micromamba # æ·»åŠ é…ç½®æ–‡ä»¶ $ cat ~/.mambarc channels: - conda-forge always_yes: false ä½¿ç”¨ # micromamba create -n python310 python=3.10 # æ¿€æ´»ç¯å¢ƒ micromamba activate python310 # ç„¶åå¯ä»¥ç”¨ micromamba æˆ–è€… pip è£…ä¸œè¥¿ micromamba install package_1 package_2=version ## å…·ä½“è¯·å‚è€ƒ https://mamba.readthedocs.io/en/latest/ micromamba --help "},{"id":25,"href":"/articles/2024/03/06/9mzhfnl58azjmeibfblvjy/","title":"Hugoç½‘ç«™å»ºè®¾","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å®‰è£… Hugo # ä¸‹è½½åœ°å€ï¼šhttps://github.com/gohugoio/hugo/releases\nåˆ›å»ºç½‘ç«™ # hugo new site book cd book git init git submodule add https://github.com/alex-shpak/hugo-book themes/hugo-book æœ¬åœ°è°ƒè¯• # hugo server --disableFastRender --minify --ignoreCache github actions # mkdir -p .github/workflows touch .github/workflows/build.yml name: Build on: push: branches: - main # Set a branch to deploy pull_request: jobs: deploy: runs-on: ubuntu-20.04 concurrency: group: ${{ github.workflow }}-${{ github.ref }} steps: - uses: actions/checkout@v3 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#39;0.123.7\u0026#39; # æ˜¯å¦å¯ç”¨ hugo extend extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 if: ${{ github.ref == \u0026#39;refs/heads/main\u0026#39; }} with: github_token: ${{ secrets.GH_PAGE_ACTION_TOKEN }} publish_dir: ./public github pages # å¯ä»¥åœ¨é¡¹ç›®çš„ Settings ä¸­å¼€å¯ Pages æœåŠ¡ï¼Œç„¶åé€‰æ‹© Branch ä¸ºgh-pageså³å¯ã€‚\nå¦‚æœæƒ³è¦å®šåˆ¶åŸŸåï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ About custom domains and GitHub Pages\n"},{"id":26,"href":"/articles/2024/02/06/kkcc5t2y88hybafpourudv/","title":"FFmpegæ£€æµ‹é€æ˜é€šé“","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" æ£€æµ‹é€æ˜é€šé“ # FFmpegå‘½ä»¤ # $ ffmpeg -v error -i 123.mp4 -vf \u0026#34;select=\u0026#39;eq(n,0)\u0026#39;, alphaextract\u0026#34; -f null /dev/null [Parsed_alphaextract_1 @ 0x7fe8f5208100] Requested planes not available. [Parsed_alphaextract_1 @ 0x7fe8f5208100] Failed to configure input pad on Parsed_alphaextract_1 [vf#0:0 @ 0x7fe8f5005f40] Error reinitializing filters! Failed to inject frame into filter network: Invalid argument Error while filtering: Invalid argument [out#0/null @ 0x7fe8f5004900] Nothing was written into output file, because at least one of its streams received no packets. åˆ¤æ–­æ¡ä»¶ # å¦‚æœå‡ºç°ä»¥ä¸ŠæŠ¥é”™ä¿¡æ¯ï¼Œåˆ™è¯´æ˜è§†é¢‘ä¸­æ²¡æœ‰é€æ˜é€šé“ã€‚\n"},{"id":27,"href":"/blog/linux/fSHb366Mg/","title":"sshå®¢æˆ·ç«¯äºæœåŠ¡ç«¯ä¿æŒè¿æ¥","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" linux ssh é»˜è®¤æ²¡æœ‰å¼€å¯å¿ƒè·³ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å¯¼è‡´è¿æ¥æ–­å¼€ã€‚\næœåŠ¡ç«¯è®¾ç½® # sudo vim /etc/ssh/sshd_config TCPKeepAlive yes ClientAliveInterval 60 ClientAliveCountMax 3 å®¢æˆ·ç«¯è®¾ç½® # ä¸€èˆ¬è¿˜æ˜¯å»ºè®®åœ¨å®¢æˆ·ç«¯è®¾ç½®ã€‚\nsudo vim /etc/ssh/ssh_config TCPKeepAlive yes ServerAliveInterval 60 ServerAliveCountMax 3 "},{"id":28,"href":"/blog/linux/G0DCCusMR/","title":"Centos7ç³»ç»Ÿå‡çº§å†…æ ¸ç‰ˆæœ¬","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨ELRepoä»“åº“å‡çº§ç³»ç»Ÿå†…æ ¸\næŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ # uname -r uname -a cat /etc/redhat-release å®‰è£…ELRepo yumæº # rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm æŸ¥çœ‹å¯ç”¨çš„å†…æ ¸ç‰ˆæœ¬ # yum --disablerepo=\u0026#34;*\u0026#34; --enablerepo=\u0026#34;elrepo-kernel\u0026#34; list available ... kernel-lt.x86_64 4.4.155-1.el7.elrepo kernel-lt-devel.x86_64 4.4.155-1.el7.elrepo ... å®‰è£…ç¨³å®šç‰ˆæœ¬å†…æ ¸ # yum --enablerepo=elrepo-kernel install kernel-lt è®¾ç½®å¼•å¯¼ï¼ˆgrub2ï¼‰ # æŸ¥çœ‹æ‰€æœ‰å†…æ ¸ç‰ˆæœ¬ # sudo awk -F\\\u0026#39; \u0026#39;$1==\u0026#34;menuentry \u0026#34; {print i++ \u0026#34; : \u0026#34; $2}\u0026#39; /etc/grub2.cfg 0 : CentOS Linux (4.4.241-1.el7.elrepo.x86_64) 7 (Core) 1 : CentOS Linux (3.10.0-957.el7.x86_64) 7 (Core) 2 : CentOS Linux (0-rescue-651e1b90bb3149809cdeb8cc80e72c43) 7 (Core) è®¾ç½®æ–°çš„é»˜è®¤å¼•å¯¼çš„å†…æ ¸ç‰ˆæœ¬ # æ–¹æ³•1\ngrub2-set-default 0 #å…¶ä¸­ 0 æ˜¯ä¸Šé¢æŸ¥è¯¢å‡ºæ¥çš„å¯ç”¨å†…æ ¸ æ–¹æ³•2\nvim /etc/default/grub GRUB_DEFAULT=0 #å…¶ä¸­ 0 æ˜¯ä¸Šé¢æŸ¥è¯¢å‡ºæ¥çš„å¯ç”¨å†…æ ¸ grub2-mkconfig -o /boot/grub2/grub.cfg #ç”Ÿæˆ grub é…ç½®æ–‡ä»¶ reboot # é‡å¯æœºå™¨ éªŒè¯åŠåˆ é™¤æ—§å†…æ ¸ï¼ˆå¯é€‰ï¼‰ # uname -r # æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ 4.4.241-1.el7.elrepo.x86_64 yum install yum-utils package-cleanup --oldkernels # åˆ é™¤æ—§çš„å†…æ ¸ç‰ˆæœ¬ # ä¹Ÿå¯ä»¥ä½¿ç”¨ rpm -qa | grep kernel å…ˆæŠŠæ‰€æœ‰çš„å†…æ ¸ç‰ˆæœ¬æŸ¥è¯¢å‡ºæ¥ï¼Œç„¶åä½¿ç”¨ yum remove åˆ é™¤æ‰æ—§çš„å†…æ ¸ç‰ˆæœ¬ å‡çº§å¤±è´¥çš„å¤„ç†æ–¹æ³• # å¦‚æœå‘ç°å‡çº§å†…æ ¸ç‰ˆæœ¬å¹¶é‡å¯ï¼Œå‘ç°æœºå™¨æ— æ³•å¯åŠ¨ï¼Œéœ€è¦åœ¨å¼€æœºè¿›å…¥å¼•å¯¼å†…æ ¸é€‰æ‹©ç•Œé¢æ‰‹åŠ¨é€‰æ‹©è€çš„å†…æ ¸å¯åŠ¨ï¼Œç„¶åå†è®²é»˜è®¤å¼•å¯¼çš„å†…æ ¸ç‰ˆæœ¬æ”¹å›æ¥çš„å†…æ ¸ç‰ˆæœ¬è¿›è¡Œå›æ»šã€‚\n"},{"id":29,"href":"/blog/linux/xd2UELYGR/","title":"dnsmasqå®‰è£…ä¸é…ç½®","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" dnsmasqæ˜¯ä¸€ä¸ªå°å·§ä¸”æ–¹ä¾¿åœ°ç”¨äºé…ç½®DNSå’ŒDHCPçš„å·¥å…·ï¼Œé€‚ç”¨äºå°å‹ç½‘ç»œï¼Œå®ƒæä¾›äº†DNSåŠŸèƒ½å’Œå¯é€‰æ‹©çš„DHCPåŠŸèƒ½ã€‚\nå®‰è£…æœåŠ¡ # sudo yum install dnsmasq å¸¸ç”¨é…ç½® # cat /etc/dnsmasq.conf #######è¿™é‡Œè¡¨ç¤º ä¸¥æ ¼æŒ‰ç…§ resolv-file æ–‡ä»¶ä¸­çš„é¡ºåºä»ä¸Šåˆ°ä¸‹è¿›è¡Œ DNS è§£æ, ç›´åˆ°ç¬¬ä¸€ä¸ªæˆåŠŸè§£ææˆåŠŸä¸ºæ­¢ #strict-order ###åŒæ—¶å‘é€æ‰€æœ‰çš„æŸ¥è¯¢åˆ°æ‰€æœ‰çš„dnsæœåŠ¡å™¨ï¼Œè°å¿«å°±ç”¨è° all-servers listen-address=127.0.0.1 ###ä¸è®©dnsmasqå»è¯»/etc/hostsæ–‡ä»¶ no-hosts ## è®¾ç½®ç¼“å­˜æ¡ç›® cache-size=10240 #å…è®¸å®¢æˆ·ç«¯ç¼“å­˜çš„æ—¶é—´å•ä½ä¸ºç§’ local-ttl=10 max-cache-ttl=15 ###å¼€å¯æ—¥å¿— #log-queries ##é…ç½®æ—¥å¿—æ–‡ä»¶ #log-facility=/data/logs/dnsmasq.log cat /etc/resolv.dnsmasq.conf nameserver 223.5.5.5 nameserver 114.114.114.114 nameserver 222.246.129.80 å¯åŠ¨æœåŠ¡ # systemctl start dnsmasq éªŒè¯æ–¹æ³• # dig www.zhangwenbing.com å…¶ä»–é…ç½® # å›½å†…æŒ‡å®šDNS # server=/cn/114.114.114.114 server=/taobao.com/114.114.114.114 server=/taobaocdn.com/114.114.114.114 å›½å¤–æŒ‡å®šDNS # server=/google.com/8.8.8.8 å±è”½ç½‘é¡µå¹¿å‘Š # address=/ad.youku.com/127.0.0.1 address=/ad.iqiyi.com/127.0.0.1 å…¶ä»–åŠŸèƒ½ # é™¤äº†DNSï¼Œè¿˜æ”¯æŒDHCPå’ŒTFTPï¼Œç”±äºæš‚æ—¶ç”¨ä¸åˆ°ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¾‹ä¸¾äº†ã€‚\n"},{"id":30,"href":"/blog/linux/SNyWJwbGR/","title":"ä½¿ç”¨sshé…ç½®è·³æ¿æœº","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ç®€å•çš„ä¿®æ”¹/etc/ssh/ssh_configæ–‡ä»¶å³å¯é€šè¿‡è·³æ¿æœºï¼Œç›´è¾¾ç›®æ ‡æœåŠ¡å™¨ã€‚\né…ç½®æ–¹æ³• # cat /etc/ssh/ssh_config Host jump-server User xxxx Hostname yyy.yyy.yyy.yyy Port 22 Host 10.* ProxyCommand ssh -q -W %h:%p jump-server Host æ”¯æŒé€šé…ç¬¦ * å’Œ ?\nxxxx è·³æ¿æœºç”¨æˆ·å\nyyy.yyy.yyy.yyy è·³æ¿æœºIPåœ°å€\néœ€è¦æ³¨æ„çš„é—®é¢˜ # è·³æ¿æœºæœ€å¥½æ˜¯å…ç§˜é’¥ç™»å½•ï¼Œä¸ç„¶çš„è¯ä¼šéœ€è¦è¾“å…¥å¯†ç ã€‚\n"},{"id":31,"href":"/blog/linux/tqj7MybMg/","title":"centos6é•œåƒç«™åœæ­¢ç»´æŠ¤çš„è§£å†³åŠæ³•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" 2020å¹´11æœˆ30æ—¥ centos6å„å¤§å¼€æºé•œåƒç«™å·²ç»åœæ­¢ç»´æŠ¤äº†ï¼Œä½†æ˜¯é˜¿é‡Œäº‘è¿˜æœ‰å…¶ä»–æºå¯ä»¥ä½¿ç”¨ã€‚\né”™è¯¯æç¤º # http://mirrors.aliyun.com/epel/6/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 22 - \u0026#34;The requested URL returned error: 404 Not Found\u0026#34; è§£å†³åŠæ³• # cat /etc/yum.repos.d/CentOS-Base.repo # CentOS-Base.repo # # The mirror system uses the connecting IP address of the client and the # update status of each mirror to pick mirrors that are updated to and # geographically close to the client. You should use this for CentOS updates # unless you are manually picking other mirrors. # # If the mirrorlist= does not work for you, as a fall back you can try the # remarked out baseurl= line instead. # # [base] name=CentOS-6.10 - Base - mirrors.aliyun.com failovermethod=priority baseurl=http://mirrors.aliyun.com/centos-vault/6.10/os/$basearch/ gpgcheck=1 gpgkey=http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6 #released updates [updates] name=CentOS-6.10 - Updates - mirrors.aliyun.com failovermethod=priority baseurl=http://mirrors.aliyun.com/centos-vault/6.10/updates/$basearch/ gpgcheck=1 gpgkey=http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6 #additional packages that may be useful [extras] name=CentOS-6.10 - Extras - mirrors.aliyun.com failovermethod=priority baseurl=http://mirrors.aliyun.com/centos-vault/6.10/extras/$basearch/ gpgcheck=1 gpgkey=http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6 #additional packages that extend functionality of existing packages [centosplus] name=CentOS-6.10 - Plus - mirrors.aliyun.com failovermethod=priority baseurl=http://mirrors.aliyun.com/centos-vault/6.10/centosplus/$basearch/ gpgcheck=1 enabled=0 gpgkey=http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6 #contrib - packages by Centos Users [contrib] name=CentOS-6.10 - Contrib - mirrors.aliyun.com failovermethod=priority baseurl=http://mirrors.aliyun.com/centos-vault/6.10/contrib/$basearch/ gpgcheck=1 enabled=0 gpgkey=http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-6 yum clean all yum makecache "},{"id":32,"href":"/blog/ffmpeg/ROS_KIbGg/","title":"ffmpegè§„èŒƒéŸ³é¢‘çš„å“åº¦","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" é€šè¿‡FFmpegå†…ç½®æ»¤é•œã€æ‰‹åŠ¨è°ƒæ•´éŸ³é‡ã€æˆ–è€…ffmpeg-normalizeå®ç°å¯¹å“åº¦çš„æ§åˆ¶ã€‚\nå†…ç½®å½’ä¸€åŒ–æ»¤æ³¢å™¨ # loudnormï¼šé€šè¿‡EBU R.128è¿›è¡Œå“åº¦æ ‡å‡†åŒ–ã€‚æ‚¨å¯ä»¥è®¾ç½®ç§¯åˆ†çš„ä½“ç§¯ç›®æ ‡ï¼Œä½“ç§¯èŒƒå›´ç›®æ ‡æˆ–æœ€å¤§çœŸå®å³°ã€‚å»ºè®®ç”¨äºå‘å¸ƒéŸ³é¢‘å’Œè§†é¢‘ï¼Œå¹¶è¢«ä¸–ç•Œå„åœ°çš„å¹¿æ’­å…¬å¸ä½¿ç”¨ã€‚\ndynaudnormï¼šâ€œæ™ºèƒ½â€å“åº¦å½’ä¸€åŒ–ï¼Œä¸è¿›è¡Œè£å‰ªã€‚åŠ¨æ€åœ°å°†è§„èŒƒåŒ–åº”ç”¨äºæ–‡ä»¶çš„çª—å£éƒ¨åˆ†ã€‚åº”è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šæ”¹å˜å£°éŸ³çš„ç‰¹æ€§ã€‚\n#fdk_aacç¼–ç å™¨ ffmpeg200421 -i \u0026#34;source_audio.ts\u0026#34; -c:a libfdk_aac -strict -2 -ac 2 -ar 48000 -ab 196k -af \u0026#34;[0:a]pan=stereo| FL \u0026lt; FL + 0.5*FC + 0.6*BL + 0.6*SL | FR \u0026lt; FR + 0.5*FC + 0.6*BR + 0.6*SR,loudnorm=I=-23:LRA=6:tp=-1\u0026#34; -y -cutoff 20000 \u0026#34;ac_5m.ts\u0026#34; #aacç¼–ç å™¨ ffmpeg -i \u0026#34;source_audio.ts\u0026#34; -c:a aac -strict -2 -ac 2 -ar 48000 -ab 196k -af \u0026#34;loudnorm=I=-23:LRA=6:tp=-1\u0026#34; -y -cutoff 20000 \u0026#34;1_aac_dynaudnorm_ac_5m.ts\u0026#34; å¸¸ç”¨æ–¹å¼ # ffmpeg -i input.mp4 -vn -acodec libfdk_aac -ac 2 -ar 44100 -af loudnorm=I=-16:TP=-1:LRA=7:print_format=json -f null /dev/null æ‰‹åŠ¨è§„èŒƒéŸ³é¢‘çš„å“åº¦ # é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆ†æéŸ³é¢‘æµä»¥è·å–æœ€å¤§éŸ³é‡ï¼Œä»¥æŸ¥çœ‹è§„èŒƒåŒ–æ˜¯å¦èµ·ä½œç”¨ã€‚\nffmpeg -i video.avi -af \u0026#34;volumedetect\u0026#34; -vn -sn -dn -f null /dev/null [Parsed_volumedetect_0 @ 0x7f8ba1c121a0] mean_volume: -16.0 dB [Parsed_volumedetect_0 @ 0x7f8ba1c121a0] max_volume: -5.0 dB [Parsed_volumedetect_0 @ 0x7f8ba1c121a0] histogram_0db: 87861 ä½¿ç”¨éŸ³é‡è¿‡æ»¤å™¨ï¼ˆvolumeï¼‰\nffmpeg -i video.mp4 -af \u0026#34;volume=5dB\u0026#34; -c:v copy -c:a aac -cutoff 20000 output.mp4 volume=5dB è¡¨ç¤ºå¢åŠ 5åˆ†è´çš„éŸ³é‡\nvolume=-5dB è¡¨ç¤ºå‡å°‘5åˆ†è´çš„éŸ³é‡\nvolume=1.5 è¡¨ç¤ºæ”¾å¤§1.5å€çš„éŸ³é‡\nffmpeg-normalize # ffmpeg-normalize æ˜¯ä¸€ä¸ªPythonåº“ï¼Œå¯ä»¥ä½¿ç”¨pipå®‰è£…ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹å¼åœ¨githubä¸Šæœ‰æ–‡æ¡£ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šçš„ä»‹ç»äº†ã€‚\n"},{"id":33,"href":"/blog/linux/-vpymjJGg/","title":"tcpdumpä¹‹UDPæŠ“åŒ…","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨tcpdumpæŠ“UDPåŒ…ï¼Œè¿‡æ»¤è¿‡æ»¤IPå’Œportï¼Œå¹¶ä¸”è‡ªåŠ¨æ‹†åˆ†ç‰‡æ®µã€‚\nå®‰è£…tcpdump # yum install -y tcpdump ä½¿ç”¨æ–¹æ³• # tcpdump -i bond0 udp port xxxx and host xxx.x.xx.xxx -s0 -G 600 -w %Y_%m%d_%H%M_%S.pcap å‚æ•°è¯´æ˜ # -i æŒ‡å®šç›‘å¬çš„ç½‘å¡\nudp ç›‘å¬UDPåè®®\nport æŒ‡å®šè¿‡æ»¤çš„ç«¯å£\nhost æŒ‡å®šè¿‡æ»¤çš„ip\n-s è¡¨ç¤ºä»ä¸€ä¸ªåŒ…ä¸­æˆªå–çš„å­—èŠ‚æ•°ï¼Œ0è¡¨ç¤ºåŒ…ä¸æˆªæ–­\n-G æŒ‰ç…§å›ºå®šçš„æ—¶é—´é—´éš”åˆ‡å‰²è¾“å‡ºçš„æ–‡ä»¶ï¼ˆå•ä½ï¼šç§’ï¼‰\n-w ç›´æ¥å°†åŒ…å†™å…¥æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸åˆ†æå’Œæ‰“å°å‡ºæ¥ï¼›\nå–éè¿ç®—æ˜¯ â€˜not â€™ â€˜! â€˜ï¼Œä¸è¿ç®—æ˜¯â€™andâ€™ï¼Œâ€™\u0026amp;\u0026amp;;æˆ–è¿ç®— æ˜¯â€™orâ€™ ,â€˜||â€™\nå®šæ—¶æŠ“åŒ…(python) # #!/usr/bin/env python # -*- coding: UTF-8 -*- # # @author å¼ æ–‡å…µ # @blog https://zhangwenbing.com/ # @datetime 2020-12-18 14:56:01 # @description # import os import time from apscheduler.schedulers.blocking import BlockingScheduler def system(cmd): t = time.strftime(\u0026#39;%Y-%m-%d %H:%M:%S\u0026#39;, time.localtime(time.time())) print(\u0026#39;{} æ‰§è¡Œ {}\u0026#39;.format(t, cmd)) stat = os.system(cmd) if stat != 0: print(\u0026#39;{} æ‰§è¡Œ {} å¤±è´¥\u0026#39;.format(t, cmd)) scheduler = BlockingScheduler() # æ˜ŸæœŸ1-5çš„17ç‚¹40åˆ†æ‰§è¡ŒæŠ“åŒ…ä»»åŠ¡ scheduler.add_job(system, \u0026#39;cron\u0026#39;, day_of_week=\u0026#34;mon,tue,wed,thu,fri,sat\u0026#34;, hour=17, minute=30, args=[\u0026#39;/sbin/tcpdump -i bond0 udp port xxxx and host xxx.x.xx.xxx -s0 -G 3600 -w /your_path/%Y_%m%d_%H%M_%S.pcap \u0026amp;\u0026gt;/dev/null\u0026#39;]) # æ˜ŸæœŸ1-5çš„20ç‚¹01åˆ†æ‰§è¡Œkill scheduler.add_job(system, \u0026#39;cron\u0026#39;, day_of_week=\u0026#34;mon,tue,wed,thu,fri,sat\u0026#34;, hour=20, minute=1, args=[\u0026#39;pkill -9 tcpdump \u0026amp;\u0026gt;/dev/null\u0026#39;]) scheduler.start() # æ˜ŸæœŸ1-5çš„23ç‚¹59åˆ†æ‰§è¡Œè‡ªåŠ¨æ¸…ç†7å¤©ä¹‹å‰çš„æŠ“åŒ…æ–‡ä»¶ scheduler.add_job(system, \u0026#39;cron\u0026#39;, day_of_week=\u0026#34;mon,tue,wed,thu,fri,sat\u0026#34;, hour=23, minute=59, args=[\u0026#39;/usr/bin/find /your_path/ -type f -ctime +7 -exec rm -f {} \\; \u0026amp;\u0026gt;/dev/null\u0026#39;]) scheduler.start() åˆ‡åˆ†æŠ“åŒ…æ–‡ä»¶ # tcpdump -r old_file -w new_files -C 10 -r æŒ‡å®šéœ€è¦åˆ‡åˆ†çš„æ–‡ä»¶\n-w æŒ‡å®šæ–°çš„æ–‡ä»¶åå‰ç¼€\n-C æŒ‡å®šåˆ‡åˆ†çš„æ–‡ä»¶å¤§å°ï¼ˆå•ä½ï¼šMï¼‰\n"},{"id":34,"href":"/blog/linux/h5sGcU1MR/","title":"Linuxæ”¶å½•UDPè§†é¢‘èŠ±å±æ€»ç»“","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" æœ€è¿‘åœ¨Linuxä¸‹ä½¿ç”¨ffmpegæ”¶å½•UDPæµèŠ±å±é—®é¢˜ï¼Œå‘ç°æœºå™¨æœ‰åŒç½‘å¡ï¼Œæ·»åŠ è·¯ç”±æŒ‡å®šç½‘å¡æ”¶å½•å¯¼è‡´æ— æ³•æ”¶å½•äº†ã€‚å¦é™„ä¸€äº›è§£å†³èŠ±å±çš„ä¼˜åŒ–æ–¹æ³•ã€‚\nä¼˜åŒ–å†…æ ¸å‚æ•° # cat /etc/sysctl.conf net.ipv4.conf.default.rp_filter = 0 net.ipv4.conf.all.rp_filter = 0 # ä¿®æ”¹é»˜è®¤ç½‘ç»œçš„ç¼“å­˜å¤§å° è¿™ä¸ªå¾ˆé‡è¦ä¸ç„¶ net.core.rmem_max = 50000000 net.core.rmem_default = 50000000 sysctl -p # æ·»åŠ ä»¥ä¸Šé…ç½®åéœ€è¦é‡å¯ç³»ç»Ÿ reboot # ä¸é‡å¯çš„è¯ä¸€å®šè¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ for i in /proc/sys/net/ipv4/conf/*/rp_filter ; do echo 0 \u0026gt; \u0026#34;$i\u0026#34;; done åæ§½ # ç”±äºåšä¸»åªä¿®æ”¹äº†ä¸Šé¢çš„ sysctl.conf å¹¶ä¸”åªæ‰§è¡Œäº† sysctl -p æ‰€ä»¥æ‚²å‰§äº†ï¼Œæ·»åŠ è·¯ç”±ä¹‹åä¸€ç›´æ— æ³•æ”¶å½•ã€‚\n20201218æ›´æ–° # åˆšå¼€å§‹ä»¥ä¸ºæ˜¯å­˜å‚¨å’Œæ”¶å½•èµ°åŒä¸€ç½‘å£å¯¼è‡´èŠ±å±ï¼Œæ²¡æƒ³åˆ°ç»è¿‡ä¸€ç•ªæŠ“åŒ…åˆ†æä¹‹åï¼Œæœ€åç¡®å®šæ˜¯äº¤æ¢æœºæœ‰ç“¶é¢ˆï¼ˆäº¤æ¢æœºè€æ—§ï¼‰ï¼Œæ˜¯äº¤æ¢æœºçš„æ•°æ®å¤„ç†ä¸è¿‡æ¥å¯¼è‡´çš„ä¸¢åŒ…ã€‚\ncifs(samba) # å¦‚æœæ”¶å½•æ–‡ä»¶æ˜¯å­˜å‚¨åˆ°cifsçš„è¯ï¼Œä¸€å®šè¦åœ¨æŒ‚è½½çš„æ—¶å€™æŒ‡å®š cache=none ç¦ç”¨ç¼“å­˜ï¼Œä¸ç„¶æ”¶å½•é•¿è§†é¢‘æ—¶ä¼šå¯¼è‡´æ”¶å½•ä¸­æ–­ã€‚\n"},{"id":35,"href":"/blog/linux/loBZJ41MR/","title":"CentOSæ·»åŠ é™æ€è·¯ç”±ä¹‹route","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" routeå‘½ä»¤å‚æ•°è¯¦ç»†è¯´æ˜åŠå¸¸ç”¨å‘½ä»¤\nåŸæ–‡åœ°å€ docs.lvrui.io\n\u0026gt; route Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface default localhost 0.0.0.0 UG 100 0 0 eno16780032 172.17.0.0 0.0.0.0 255.255.0.0 U 0 0 0 docker0 192.168.10.0 0.0.0.0 255.255.255.0 U 100 0 0 eno16780032 macOS ä¸­ä½¿ç”¨ netstat -nr å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰è·¯ç”±è¡¨\nDestination ç›®æ ‡ç½‘è·¯\nGateway ç½‘å…³\nGenmask æ©ç \nFlags æ ‡è¯†\nU è·¯ç”±å·²ç»å¯åŠ¨\nH è·¯ç”±ç›®æ ‡ä¸ºä¸»æœº\nG ä½¿ç”¨ç½‘å…³\nR ä¸ºåŠ¨æ€è·¯ç”±å¤åŸè·¯ç”±è¡¨\nD ç”±å®ˆæŠ¤è¿›ç¨‹æˆ–é—´æ¥åŠ¨æ€å®‰è£…\nM è¢«è·¯ç”±å®ˆæŠ¤è¿›ç¨‹æˆ–é—´æ¥ä¿®æ”¹\nA é€šè¿‡ addrconf ä¿®æ”¹\nC ç¼“å­˜æ¡ç›®\n! æ‹’ç»è·¯ç”±\nMetric è·¯ç”±å¼€é”€, åˆ°ç›®æ ‡çš„â€˜è·ç¦»â€™ï¼ˆé€šå¸¸åŸºäºè·³æ•°ç»Ÿè®¡ï¼‰\nRef å‚è€ƒæ­¤è·¯ç”±çš„æ•°é‡\nUse è·¯ç”±æŸ¥æ‰¾è®¡æ•°ã€‚ä¾èµ–ä¸ä½¿ç”¨ - F è¿˜æ˜¯ - C é€‰é¡¹ï¼Œè¿™ä¸ªå€¼è¦ä¹ˆæ˜¯è·¯ç”±ç¼“å­˜æœªå‘½ä¸­æ•°è¦ä¹ˆæ˜¯å‘½ä¸­æ•°\nIface æ­¤è·¯ç”±æ•°æ®åŒ…å‘é€åˆ°çš„ç½‘ç»œæ¥å£\næ·»åŠ åˆ°ä¸»æœºçš„è·¯ç”± # route add â€“host 192.168.59.2 dev eth1 route add â€“host 192.168.59.2 gw 192.168.10.85 æ·»åŠ åˆ°ç½‘ç»œçš„è·¯ç”± # route add -net 192.168.248.0/24 gw 192.168.10.85 route add â€“net 192.168.248.0 netmask 255.255.255.0 gw 192.168.10.85 route add â€“net 192.168.248.0 netmask 255.255.255.0 dev eth1 æ·»åŠ é»˜è®¤ç½‘å…³ # route add default gw 192.168.10.85 route add -net 0.0.0.0 gw 192.168.10.85 ä½¿ç”¨ route å‘½ä»¤æ·»åŠ çš„è·¯ç”±ï¼Œæœºå™¨é‡å¯æˆ–è€…ç½‘å¡é‡å¯åè·¯ç”±å°±å¤±æ•ˆäº†\nroute del â€“host 192.168.10.85 dev eth1 æ€ä¹ˆ add çš„å°±æ€ä¹ˆ del æ‰. ä½†æ˜¯ del çš„æ—¶å€™å¯ä»¥ä¸å†™ç½‘å…³\nåœ¨ /etc/rc.local é‡Œæ·»åŠ è·¯ç”±ä¿¡æ¯\nroute add -net 192.168.247.0/24 dev eth1 route add -net 192.168.110.0/24 gw 192.168.10.85 åœ¨ /etc/sysconfig/network é‡Œæ·»åŠ åˆ°æœ«å°¾ GATEWAY=gw-ip æˆ–è€… GATEWAY=gw-dev\nåœ¨ /etc/sysconfig/static-router æ·»åŠ  any net x.x.x.x/24 gw y.y.y.y\næ·»åŠ æ°¸ä¹…è·¯ç”± # CentOS7 ä¸‹æ¨èä½¿ç”¨ä¸Šé¢ç¬¬ä¸‰ç§æ–¹æ³•æ·»åŠ æ°¸ä¹…é™æ€è·¯ç”±\n[root@centos7 ~] 10.15.150.0/24 via 192.168.150.253 dev enp0s3 10.25.250.0/24 via 192.168.150.253 dev enp0s3 å°†æ°¸ä¹…é™æ€è·¯ç”±éœ€è¦å†™åˆ° /etc/sysconfig/network-scripts/route-interface æ–‡ä»¶ä¸­\næ³¨æ„:\nifcfg-enp0s3 æ–‡ä»¶æ”¹åä¸º ifcfg-eth0 åï¼Œroute-enp0s3 æ–‡ä»¶ä¹Ÿè¦æ”¹åä¸º route-eth0\nå‚è€ƒæ–‡æ¡£:\nhttps://www.cnblogs.com/panblack/p/Centos7_Static_Routes.html "},{"id":36,"href":"/blog/macos/aaELFz1Mg/","title":"macos Lauchpad(å¯åŠ¨å°) é‡ç½®","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" é‡ç½®macosçš„Lauchpad(å¯åŠ¨å°)ï¼ŒåŠè®¾ç½®Lauchpad(å¯åŠ¨å°)çš„è¡Œæ•°å’Œåˆ—æ•°ã€‚\næ‰“å¼€ç»ˆç«¯ç¨‹åºï¼ŒæŒ‰éœ€æ±‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ã€‚\né‡ç½® Lauchpad # defaults write com.apple.dock ResetLaunchPad -bool TRUE; é‡å¯ Dock # killall Dock è®¾ç½® Lauchpad å›¾æ ‡çš„åˆ—æ•° # defaults write com.apple.dock springboard-columns -int 7 è®¾ç½® Lauchpad å›¾æ ‡çš„è¡Œæ•° # defaults write com.apple.dock springboard-rows -int 7 "},{"id":37,"href":"/blog/linux/bdpp4QAMg/","title":"nginxåŠphp-fpmä¼˜åŒ–","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ç®€å•çš„è®²è®²nginx+phpçš„ä¸€äº›å¸¸ç”¨ä¼˜åŒ–ï¼Œä»¥åŠç›¸å…³çš„å†…æ ¸å‚æ•°ä¼˜åŒ–ã€‚\nNginx ä¼˜åŒ– # 1. TCP ä¸ UNIX å¥—æ¥å­— # UNIX åŸŸå¥—æ¥å­—æä¾›çš„æ€§èƒ½ç•¥é«˜äº TCP å¥—æ¥å­—åœ¨å›é€æ¥å£ä¸Šçš„æ€§èƒ½ï¼ˆè¾ƒå°‘çš„æ•°æ®å¤åˆ¶ï¼Œè¾ƒå°‘çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰ã€‚å¦‚æœæ¯ä¸ªæœåŠ¡å™¨éœ€è¦æ”¯æŒè¶…è¿‡ 1000 ä¸ªè¿æ¥ï¼Œè¯·ä½¿ç”¨ TCP å¥—æ¥å­— - å®ƒä»¬å¯ä»¥æ›´å¥½åœ°æ‰©å±•ã€‚\nupstream backend { server unix:/var/run/fastcgi.sock; } 2. è°ƒæ•´ worker_processes å‚æ•° # ç°ä»£ç¡¬ä»¶æ˜¯å¤šå¤„ç†å™¨ï¼ŒNGINX å¯ä»¥åˆ©ç”¨å¤šä¸ªç‰©ç†æˆ–è™šæ‹Ÿå¤„ç†å™¨ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨çš„ Web æœåŠ¡å™¨è®¡ç®—æœºä¸ä¼šé…ç½®ä¸ºå¤„ç†å¤šä¸ªå·¥ä½œè´Ÿè½½ï¼ˆä¾‹å¦‚åŒæ—¶æä¾› Web æœåŠ¡å™¨å’Œæ‰“å°æœåŠ¡å™¨çš„æœåŠ¡ï¼‰ï¼Œå› æ­¤æ‚¨éœ€è¦é…ç½® NGINX ä»¥ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„å¤„ç†å™¨ï¼Œå› ä¸º NGINX å·¥ä½œè¿›ç¨‹æ˜¯ä¸æ˜¯å¤šçº¿ç¨‹çš„ã€‚\nå°† nginx.conf æ–‡ä»¶ä¸­çš„ worker_processes è®¾ç½®ä¸ºè®¡ç®—æœºæ‰€å…·æœ‰çš„æ ¸å¿ƒæ•°ã€‚\nå½“ä½ åœ¨å®ƒçš„æ—¶å€™ï¼Œå¢åŠ  worker_connections çš„æ•°é‡ï¼ˆæ¯ä¸ªæ ¸å¿ƒåº”è¯¥å¤„ç†å¤šå°‘ä¸ªè¿æ¥ï¼‰å¹¶å°† multi_accept è®¾ç½®ä¸º ONï¼Œå¦‚æœä½ åœ¨ Linux ä¸Šåˆ™è®¾ç½®ä¸º epollï¼š\nworker_processes 4; events { worker_connections 1024; multi_accept on; } 3. ç¦ç”¨è®¿é—®æ—¥å¿— # access_log off; log_not_found off; error_log /var/log/nginx-error.log warn; å¦‚æœæœ‰éœ€è¦ä¸å¯ä»¥å…³é—­ï¼Œè‡³å°‘æ˜¯ç¼“å­˜ä»–ä»¬\naccess_log /var/log/nginx/access.log main buffer=16k; 4. å¼€å¯ gzip å‹ç¼© # gzip on; gzip_disable \u0026#34;msie6\u0026#34;; gzip_vary on; gzip_proxied any; gzip_comp_level 6; gzip_min_length 1100; gzip_buffers 16 8k; gzip_http_version 1.1; gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; 5. ç¼“å­˜è®¿é—®é¢‘æ¬¡è¾ƒé«˜çš„æ–‡ä»¶ # open_file_cache max=2000 inactive=20s; open_file_cache_valid 60s; open_file_cache_min_uses 5; open_file_cache_errors off; 6. è°ƒæ•´å®¢æˆ·ç«¯è¶…æ—¶ # client_max_body_size 50M; client_body_buffer_size 1m; client_body_timeout 15; client_header_timeout 15; keepalive_timeout 2 2; send_timeout 15; sendfile on; tcp_nopush on; tcp_nodelay on; 7. è°ƒæ•´è¾“å‡ºç¼“å­˜ # fastcgi_buffers 256 16k; fastcgi_buffer_size 128k; fastcgi_connect_timeout 3s; fastcgi_send_timeout 120s; fastcgi_read_timeout 120s; fastcgi_busy_buffers_size 256k; fastcgi_temp_file_write_size 256k; reset_timedout_connection on; server_names_hash_bucket_size 100; 8. è´Ÿè½½å‡è¡¡ç­–ç•¥ # Nginx æä¾›è½®è¯¢ï¼ˆround robinï¼‰ã€ç”¨æˆ· IP å“ˆå¸Œï¼ˆclient IPï¼‰å’ŒæŒ‡å®šæƒé‡ 3 ç§æ–¹å¼ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒNginx ä¼šä¸ºä½ æä¾›è½®è¯¢ä½œä¸ºè´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚ä½†æ˜¯è¿™å¹¶ä¸ä¸€å®šèƒ½å¤Ÿè®©ä½ æ»¡æ„ã€‚æ¯”å¦‚ï¼ŒæŸä¸€æ—¶æ®µå†…çš„ä¸€è¿ä¸²è®¿é—®éƒ½æ˜¯ç”±åŒä¸€ä¸ªç”¨æˆ· Michael å‘èµ·çš„ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡ Michael çš„è¯·æ±‚å¯èƒ½æ˜¯ backend2ï¼Œè€Œä¸‹ä¸€æ¬¡æ˜¯ backend3ï¼Œç„¶åæ˜¯ backend1ã€backend2ã€backend3â€¦â€¦ åœ¨å¤§å¤šæ•°åº”ç”¨åœºæ™¯ä¸­ï¼Œè¿™æ ·å¹¶ä¸é«˜æ•ˆã€‚å½“ç„¶ï¼Œä¹Ÿæ­£å› å¦‚æ­¤ï¼ŒNginx ä¸ºä½ æä¾›äº†ä¸€ä¸ªæŒ‰ç…§ Michaelã€Jasonã€David ç­‰ç­‰è¿™äº›ä¹±ä¸ƒå…«ç³Ÿçš„ç”¨æˆ·çš„ IP æ¥ hash çš„æ–¹å¼ï¼Œè¿™æ ·æ¯ä¸ª client çš„è®¿é—®è¯·æ±‚éƒ½ä¼šè¢«ç”©ç»™åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ã€‚\nupstream backend { ip_hash; server unix:/var/run/php7.2-fpm.sock1 weight=100 max_fails=5 fail_timeout=5; server unix:/var/run/php7.2-fpm.sock2 weight=100 max_fails=5 fail_timeout=5; } 9. æŒç»­ç›‘æ§æ—¥å¿— # å°¤å…¶æ˜¯åœ¨è°ƒä¼˜æœ€åˆæœŸï¼Œåœ¨ä¸€ä¸ªçª—å£\ntail -f /var/log/nginx/error.log åœ¨å¦å¤–ä¸¤ä¸ªçª—å£åˆ†åˆ«ï¼š\ntail -f /var/log/php-fpm/error.log tail -f /var/log/php-fpm/www-error.log PHP-fpm ä¼˜åŒ– # 1. ä¿®æ”¹è¿›ç¨‹ç®¡ç†æ¨¡å¼ # static ç®¡ç†æ¨¡å¼é€‚åˆæ¯”è¾ƒå¤§å†…å­˜çš„æœåŠ¡å™¨ï¼Œè€Œ dynamic åˆ™é€‚åˆå°å†…å­˜çš„æœåŠ¡å™¨ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ª pm.min_spare_servers å’Œ pm.max_spare_servers åˆç†èŒƒå›´ï¼Œè¿™æ ·è¿›ç¨‹æ•°ä¼šä¸æ–­å˜åŠ¨ã€‚ondemand æ¨¡å¼åˆ™æ›´åŠ é€‚åˆå¾®å°å†…å­˜ï¼Œä¾‹å¦‚ 512MB æˆ–è€… 256MB å†…å­˜ï¼Œä»¥åŠå¯¹å¯ç”¨æ€§è¦æ±‚ä¸é«˜çš„ç¯å¢ƒã€‚\npm = dynamic #æŒ‡å®šè¿›ç¨‹ç®¡ç†æ–¹å¼ï¼Œæœ‰3ç§å¯ä¾›é€‰æ‹©ï¼šstaticã€dynamicå’Œondemandã€‚ pm.max_children = 16 #staticæ¨¡å¼ä¸‹åˆ›å»ºçš„å­è¿›ç¨‹æ•°æˆ–dynamicæ¨¡å¼ä¸‹åŒä¸€æ—¶åˆ»å…è®¸æœ€å¤§çš„php-fpmå­è¿›ç¨‹æ•°é‡ã€‚ pm.start_servers = 10 #åŠ¨æ€æ–¹å¼ä¸‹çš„èµ·å§‹php-fpmè¿›ç¨‹æ•°é‡ã€‚ pm.min_spare_servers = 8 #åŠ¨æ€æ–¹å¼ä¸‹æœåŠ¡å™¨ç©ºé—²æ—¶æœ€å°php-fpmè¿›ç¨‹æ•°é‡ã€‚ pm.max_spare_servers = 16 #åŠ¨æ€æ–¹å¼ä¸‹æœåŠ¡å™¨ç©ºé—²æ—¶æœ€å¤§php-fpmè¿›ç¨‹æ•°é‡ã€‚ pm.max_requests = 2000 #php-fpmå­è¿›ç¨‹èƒ½å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°ã€‚ pm.process_idle_timeout = 10s request_terminate_timeout = 120 pm = staticï¼Œå§‹ç»ˆä¿æŒä¸€ä¸ªå›ºå®šæ•°é‡çš„å­è¿›ç¨‹ï¼Œè¿™ä¸ªæ•°ç”± pm.max_children å®šä¹‰ï¼Œè¿™ç§æ–¹å¼å¾ˆä¸çµæ´»ï¼Œä¹Ÿé€šå¸¸ä¸æ˜¯é»˜è®¤çš„ã€‚\npm = dynamicï¼Œå¯åŠ¨æ—¶ä¼šäº§ç”Ÿå›ºå®šæ•°é‡çš„å­è¿›ç¨‹ï¼ˆç”± pm.start_servers æ§åˆ¶ï¼‰å¯ä»¥ç†è§£æˆæœ€å°å­è¿›ç¨‹æ•°ï¼Œè€Œæœ€å¤§å­è¿›ç¨‹æ•°åˆ™ç”± pm.max_children å»æ§åˆ¶ï¼Œå­è¿›ç¨‹æ•°ä¼šåœ¨æœ€å¤§å’Œæœ€å°æ•°èŒƒå›´ä¸­å˜åŒ–ã€‚é—²ç½®çš„å­è¿›ç¨‹æ•°è¿˜å¯ä»¥ç”±å¦ 2 ä¸ªé…ç½®æ§åˆ¶ï¼Œåˆ†åˆ«æ˜¯ pm.min_spare_servers å’Œ pm.max_spare_serversã€‚å¦‚æœé—²ç½®çš„å­è¿›ç¨‹è¶…å‡ºäº† pm.max_spare_serversï¼Œåˆ™ä¼šè¢«æ€æ‰ã€‚å°äº pm.min_spare_servers åˆ™ä¼šå¯åŠ¨è¿›ç¨‹ï¼ˆæ³¨æ„ï¼Œpm.max_spare_servers åº”å°äº pm.max_childrenï¼‰ã€‚\npm = ondemandï¼Œè¿™ç§æ¨¡å¼å’Œ pm = dynamic ç›¸åï¼ŒæŠŠå†…å­˜æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œæ¯ä¸ªé—²ç½®è¿›ç¨‹åœ¨æŒç»­é—²ç½®äº† pm.process_idle_timeout ç§’åå°±ä¼šè¢«æ€æ‰ï¼Œå¦‚æœæœåŠ¡å™¨é•¿æ—¶é—´æ²¡æœ‰è¯·æ±‚ï¼Œå°±åªä¼šæœ‰ä¸€ä¸ª php-fpm ä¸»è¿›ç¨‹ã€‚å¼Šç«¯æ˜¯é‡åˆ°é«˜å³°æœŸæˆ–è€…å¦‚æœ pm.process_idle_timeout çš„å€¼å¤ªçŸ­çš„è¯ï¼Œå®¹æ˜“å‡ºç° 504 Gateway Time-out é”™è¯¯ï¼Œå› æ­¤ pm = dynamic å’Œ pm = ondemand è°æ›´é€‚åˆè§†å®é™…æƒ…å†µè€Œå®šã€‚\n2. é‡Šæ”¾å†…å­˜çš„é…ç½® # pm.max_requests = 1000 è®¾ç½®æ¯ä¸ªå­è¿›ç¨‹é‡ç”Ÿä¹‹å‰æœåŠ¡çš„è¯·æ±‚æ•°. å¯¹äºå¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼çš„ç¬¬ä¸‰æ–¹æ¨¡å—æ¥è¯´æ˜¯éå¸¸æœ‰ç”¨çš„. å¦‚æœè®¾ç½®ä¸º â€˜0â€™ åˆ™ä¸€ç›´æ¥å—è¯·æ±‚. ç­‰åŒäº PHP_FCGI_MAX_REQUESTS ç¯å¢ƒå˜é‡. é»˜è®¤å€¼: 0.\nä¹Ÿå°±æ˜¯å½“ä¸€ä¸ª PHP-CGI è¿›ç¨‹å¤„ç†çš„è¯·æ±‚æ•°ç´¯ç§¯åˆ° 1000 ä¸ªåï¼Œè‡ªåŠ¨é‡å¯è¯¥è¿›ç¨‹ï¼Œé˜²æ­¢ç¬¬ä¸‰æ–¹åº“é€ æˆçš„å†…å­˜æ³„æ¼ã€‚ é‡å¯æ—¶å¯èƒ½ä¼šå¯¼è‡´ 502 é”™è¯¯ï¼Œåœ¨é«˜å¹¶å‘ç«™ç‚¹æ—¶æœ‰å‡ºç°ã€‚\n3. php-fpm æ…¢æ—¥å¿— # request_terminate_timeout = 30s #å°†æ‰§è¡Œæ—¶é—´å¤ªé•¿çš„è¿›ç¨‹ç›´æ¥ç»ˆæ­¢ request_slowlog_timeout = 2s #2ç§’ slowlog = log/$pool.log.slow #æ—¥å¿—æ–‡ä»¶ å†…æ ¸ä¼˜åŒ– # 1. TIME_WAITäº§ç”ŸåŸå› ï¼š # 1ã€nginxç°æœ‰çš„è´Ÿè½½å‡è¡¡æ¨¡å—å®ç°php fastcgiè´Ÿè½½å‡è¡¡ï¼Œnginxä½¿ç”¨äº†çŸ­è¿æ¥æ–¹å¼ï¼Œæ‰€ä»¥ä¼šé€ æˆå¤§é‡å¤„äºTIME_WAITçŠ¶æ€çš„è¿æ¥ã€‚\n2ã€TCP/IPè®¾è®¡è€…æœ¬æ¥æ˜¯è¿™ä¹ˆè®¾è®¡çš„\nä¸»è¦æœ‰ä¸¤ä¸ªåŸå› \n(1) é˜²æ­¢ä¸Šä¸€æ¬¡è¿æ¥ä¸­çš„åŒ…ï¼Œè¿·è·¯åé‡æ–°å‡ºç°ï¼Œå½±å“æ–°è¿æ¥ï¼ˆç»è¿‡2MSLï¼Œä¸Šä¸€æ¬¡è¿æ¥ä¸­æ‰€æœ‰çš„é‡å¤åŒ…éƒ½ä¼šæ¶ˆå¤±ï¼‰\n(2) å¯é çš„å…³é—­TCPè¿æ¥\nåœ¨ä¸»åŠ¨å…³é—­æ–¹å‘é€çš„æœ€åä¸€ä¸ª ack(fin) ï¼Œæœ‰å¯èƒ½ä¸¢å¤±ï¼Œè¿™æ—¶è¢«åŠ¨æ–¹ä¼šé‡æ–°å‘fin, å¦‚æœè¿™æ—¶ä¸»åŠ¨æ–¹å¤„äº CLOSED çŠ¶æ€ ï¼Œå°±ä¼šå“åº” rst è€Œä¸æ˜¯ ackã€‚æ‰€ä»¥ä¸»åŠ¨æ–¹è¦å¤„äº TIME_WAIT çŠ¶æ€ï¼Œè€Œä¸èƒ½æ˜¯ CLOSED ã€‚\n2. è¿‡å¤šTIME_WAITå±å®³ # TIME_WAIT å¹¶ä¸ä¼šå ç”¨å¾ˆå¤§èµ„æºçš„ï¼Œé™¤éå—åˆ°æ”»å‡»ã€‚åªè¦æŠŠTIME_WAITæ‰€å ç”¨å†…å­˜æ§åˆ¶åœ¨ä¸€å®šèŒƒå›´ã€‚ä¸€èˆ¬é»˜è®¤æœ€å¤§æ˜¯35600æ¡TIME_WAITã€‚\n3. è§£å†³æ–¹æ³• # net.ipv4.tcp_syncookies = 1 è¡¨ç¤ºå¼€å¯SYN Cookiesã€‚å½“å‡ºç°SYNç­‰å¾…é˜Ÿåˆ—æº¢å‡ºæ—¶ï¼Œå¯ç”¨cookiesæ¥å¤„ç†ï¼Œå¯é˜²èŒƒå°‘é‡SYNæ”»å‡»ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚\nnet.ipv4.tcp_tw_reuse = 1 è¡¨ç¤ºå¼€å¯é‡ç”¨ã€‚å…è®¸å°†TIME-WAIT socketsé‡æ–°ç”¨äºæ–°çš„TCPè¿æ¥ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚\nnet.ipv4.tcp_tw_recycle = 1 è¡¨ç¤ºå¼€å¯TCPè¿æ¥ä¸­TIME-WAIT socketsçš„å¿«é€Ÿå›æ”¶ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ã€‚\nnet.ipv4.tcp_fin_timeout = 30 è¡¨ç¤ºå¦‚æœå¥—æ¥å­—ç”±æœ¬ç«¯è¦æ±‚å…³é—­ï¼Œè¿™ä¸ªå‚æ•°å†³å®šäº†å®ƒä¿æŒåœ¨FIN-WAIT-2çŠ¶æ€çš„æ—¶é—´ã€‚\nnet.ipv4.tcp_keepalive_time = 1200 è¡¨ç¤ºå½“keepaliveèµ·ç”¨çš„æ—¶å€™ï¼ŒTCPå‘é€keepaliveæ¶ˆæ¯çš„é¢‘åº¦ã€‚ç¼ºçœæ˜¯2å°æ—¶ï¼Œæ”¹ä¸º20åˆ†é’Ÿã€‚\nnet.ipv4.ip_local_port_range = 1024 65000 è¡¨ç¤ºç”¨äºå‘å¤–è¿æ¥çš„ç«¯å£èŒƒå›´ã€‚ç¼ºçœæƒ…å†µä¸‹å¾ˆå°ï¼š32768åˆ°61000ï¼Œæ”¹ä¸º1024åˆ°65000ã€‚\nnet.ipv4.tcp_max_syn_backlog = 8192 è¡¨ç¤ºSYNé˜Ÿåˆ—çš„é•¿åº¦ï¼Œé»˜è®¤ä¸º1024ï¼ŒåŠ å¤§é˜Ÿåˆ—é•¿åº¦ä¸º8192ï¼Œå¯ä»¥å®¹çº³æ›´å¤šç­‰å¾…è¿æ¥çš„ç½‘ç»œè¿æ¥æ•°ã€‚\nnet.ipv4.tcp_max_tw_buckets = 5000 è¡¨ç¤ºç³»ç»ŸåŒæ—¶ä¿æŒTIME_WAITå¥—æ¥å­—çš„æœ€å¤§æ•°é‡ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼ŒTIME_WAITå¥—æ¥å­—å°†ç«‹åˆ»è¢«æ¸…é™¤å¹¶æ‰“å°è­¦å‘Šä¿¡æ¯ã€‚é»˜ è®¤ä¸º180000ï¼Œæ”¹ä¸º5000ã€‚å¯¹äºApacheã€Nginxç­‰æœåŠ¡å™¨ï¼Œä¸Šå‡ è¡Œçš„å‚æ•°å¯ä»¥å¾ˆå¥½åœ°å‡å°‘TIME_WAITå¥—æ¥å­—æ•°é‡ï¼Œä½†æ˜¯å¯¹äºSquidï¼Œæ•ˆæœå´ä¸å¤§ã€‚æ­¤é¡¹å‚æ•°å¯ä»¥æ§åˆ¶TIME_WAITå¥—æ¥å­—çš„æœ€å¤§æ•°é‡ï¼Œé¿å…SquidæœåŠ¡å™¨è¢«å¤§é‡çš„TIME_WAITå¥—æ¥å­—æ‹–æ­»ã€‚\næ³¨:\nnet.ipv4.tcp_tw_reuse = 1 net.ipv4.tcp_tw_recycle = 1 è®¾ç½®è¿™ä¸¤ä¸ªå‚æ•°ï¼š reuseæ˜¯è¡¨ç¤ºæ˜¯å¦å…è®¸é‡æ–°åº”ç”¨å¤„äºTIME-WAITçŠ¶æ€çš„socketç”¨äºæ–°çš„TCPè¿æ¥ï¼› recyseæ˜¯åŠ é€ŸTIME-WAIT socketså›æ”¶\n"},{"id":38,"href":"/blog/ffmpeg/Mv3bzfgqM/","title":"ffmpegåœ¨ç‰¹å®šçš„æ—¶é—´æ··åˆä¸€ä¸ªæˆ–å¤šä¸ªéŸ³é¢‘","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨FFmpegä¸­çš„adelayå’Œamixæ»¤é•œç»™éŸ³é¢‘åšæ··éŸ³\nåœ¨30ç§’åæ··åˆ1ä¸ªéŸ³é¢‘\nffmpeg -i 1-1.mp3 -i 2.mp3 -filter_complex \u0026#34;[1]adelay=delays=30s:all=1[aud1];[0][aud1]amix=inputs=2\u0026#34; -vsync 2 -y 3.mp3 åœ¨30ç§’åæ··åˆ2ä¸ªéŸ³é¢‘\nffmpeg -i 1-1.mp3 -i 2.mp3 -i 3.mp3 -filter_complex \u0026#34;[1]adelay=delays=30s:all=1[aud1];[2]adelay=delays=30s:all=1[aud2];[0][aud1][aud2]amix=inputs=3\u0026#34; -vsync 2 -y 4.mp3 æ··åˆå¤šä¸ªå‚ç…§æ··åˆ2ä¸ªçš„å‘½ä»¤ä¿®æ”¹ä¸‹å³å¯\n"},{"id":39,"href":"/blog/linux/HTLMANZea/","title":"[supervisord]å¡«å‘ä¹‹æœ€å¤§è¿æ¥æ•°","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä¿®æ”¹supervisordé…ç½®çªç ´1024æœ€å¤§è¿æ¥æ•°\né—®é¢˜æè¿° # æœ€è¿‘åœ¨ä½¿ç”¨supervisordæœåŠ¡æ—¶å‘ç°ï¼Œæ— è®ºå¦‚ä½•ä¿®æ”¹ç³»ç»Ÿçš„æœ€å¤§è¿æ¥æ•°ï¼Œç”±supervisordç®¡ç†çš„ç¨‹åºéƒ½æ— æ³•çªç ´1024çš„é™åˆ¶ã€‚\nè§£å†³åŠæ³• # cat /etc/supervisord.conf [supervisord] minfds=81920 minprocs=81920 cat /etc/supervisord.d/xxx.ini [program:xxx] minfds=81920 minprocs=81920 systemctl restart supervisord.service "},{"id":40,"href":"/blog/ffmpeg/UtHueryud/","title":"FFmpeg æ°´å°","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å›¾ç‰‡æ°´å°ã€æ–‡å­—æ°´å°ã€ç”»ä¸­ç”»\nå›¾ç‰‡æ°´å° # ffmpeg -i input.mp4 -vf \u0026#34;movie=wenzi.png[watermark];[in][watermark] overlay=main_w-overlay_w-10:main_h-overlay_h-10[out] \u0026#34; output.mp4 -i :ä¸€èˆ¬è¡¨ç¤ºè¾“å…¥\ninput.mp4:è¿™é‡Œè¡¨ç¤ºè¦å¤„ç†çš„è§†é¢‘æº\n-vf:æ»¤é•œç›¸å…³ï¼Œè§†é¢‘è£å‰ªï¼Œæ°´å°ç­‰ç­‰æ“ä½œéƒ½éœ€è¦å®ƒå®Œæˆ\nwenzi.png: è¦æ·»åŠ çš„æ°´å°å›¾ç‰‡åœ°å€\noverlay:æ°´å°å‚æ•°\nmain_w-overlay_w-10 : æ°´å°åœ¨xè½´çš„ä½ç½®ï¼Œä¹Ÿå¯ä»¥å†™æˆx=main_w-overlay_w-10\nmain_h-overlay_h-10ï¼šæ°´å°åœ¨yè½´çš„ä½ç½®\nffmpeg -i input.mp4 -i logo.png -filter_complex \u0026#39;overlay=x=10:y=main_h-overlay_h-10\u0026#39; output.mp4 -filter_complex: ç›¸æ¯”-vf,\nfilter_complexé€‚åˆå¼€å‘å¤æ‚çš„æ»¤é•œåŠŸèƒ½ï¼Œå¦‚åŒæ—¶å¯¹è§†é¢‘è¿›è¡Œè£å‰ªå¹¶æ—‹è½¬ã€‚å‚æ•°ä¹‹é—´ä½¿ç”¨é€—å·ï¼ˆï¼Œï¼‰éš”å¼€å³å¯\nmain_w:è§†é¢‘å®½åº¦\noverlay_w: è¦æ·»åŠ çš„å›¾ç‰‡æ°´å°å®½åº¦\nmain_h : è§†é¢‘é«˜åº¦\noverlay_h:è¦æ·»åŠ çš„å›¾ç‰‡æ°´å°å®½åº¦\næ–‡å­—æ°´å° # ffmpeg -i input.mp4 -vf \u0026#34;drawtext=fontfile=simhei.ttf: text=â€˜æŠ€æœ¯æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›â€™:x=10:y=10:fontsize=24:fontcolor=white:shadowy=2\u0026#34; output.mp4 fontfile:å­—ä½“ç±»å‹\ntext:è¦æ·»åŠ çš„æ–‡å­—å†…å®¹\nfontsize:å­—ä½“å¤§å°\nfontcolorï¼šå­—ä½“é¢œè‰²\nç”»ä¸­ç”» # åªæ˜¾ç¤º1éï¼Œåè¾¹é‡å¤æ˜¾ç¤ºæœ€åä¸€å¸§ã€‚\nffmpeg -i bunny.mp4 -vf \u0026#34;movie=test.mov[logo];[0:v][logo]overlay=x=100:y=100\u0026#34; -y out.mp4 movä¸€ç›´å¾ªç¯æ˜¾ç¤ºã€‚ æ·»åŠ  loop=0,setpts=N/FRAME_RATE/TB å³å¯ã€‚\nffmpeg -i bunny.mp4 -vf \u0026#34;movie=test.mov:loop=0,setpts=N/FRAME_RATE/TB[logo];[0:v][logo]overlay=x=100:y=100\u0026#34; -y out.mp4 åªæ˜¾ç¤ºä¸€é æ·»åŠ eof_actionå³å¯ã€‚\nffmpeg -i bunny.mp4 -vf \u0026#34;movie=test.mov[logo];[0:v][logo]overlay=x=100:y=100:eof_action=pass\u0026#34; -vframes 1000 -y out.mp4 "},{"id":41,"href":"/blog/linux/QNIBzjz3k/","title":"supervisor å¸¸è§å‘åŠè§£å†³åŠæ³•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" Too many open filesã€è·å–ä¸åˆ°$HOMEç­‰\nToo many open files # vim /etc/supervisord.conf [supervisord] minfds=81920 minprocs=81920 # systemctl restart supervisord è·å–ä¸åˆ°$HOME # [program:apache2] command=/home/chrism/bin/httpd -c \u0026#34;ErrorLog /dev/stdout\u0026#34; -DFOREGROUND user=chrism environment=HOME=\u0026#34;/home/chrism\u0026#34;,USER=\u0026#34;chrism\u0026#34; supervisorctl update "},{"id":42,"href":"/blog/linux/N2EsU3hZT/","title":"linux nvidia è·å–æ˜¾å¡ä¿¡æ¯","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨deviceQueryè·å–æ˜¾å¡ä¿¡æ¯\nç¯å¢ƒ # Linuxã€nvidiaã€cuda\nå‘½ä»¤ # /usr/local/cuda/extras/demo_suite/deviceQuery CUDA Device Query (Runtime API) version (CUDART static linking) Detected 2 CUDA Capable device(s) Device 0: \u0026#34;GeForce RTX 2080 Ti\u0026#34; CUDA Driver Version / Runtime Version 10.1 / 10.1 CUDA Capability Major/Minor version number: 7.5 Total amount of global memory: 11019 MBytes (11554717696 bytes) (68) Multiprocessors, ( 64) CUDA Cores/MP: 4352 CUDA Cores GPU Max Clock rate: 1545 MHz (1.54 GHz) Memory Clock rate: 7000 Mhz Memory Bus Width: 352-bit L2 Cache Size: 5767168 bytes Maximum Texture Dimension Size (x,y,z) 1D=(131072), 2D=(131072, 65536), 3D=(16384, 16384, 16384) Maximum Layered 1D Texture Size, (num) layers 1D=(32768), 2048 layers Maximum Layered 2D Texture Size, (num) layers 2D=(32768, 32768), 2048 layers Total amount of constant memory: 65536 bytes Total amount of shared memory per block: 49152 bytes Total number of registers available per block: 65536 Warp size: 32 Maximum number of threads per multiprocessor: 1024 Maximum number of threads per block: 1024 Max dimension size of a thread block (x,y,z): (1024, 1024, 64) Max dimension size of a grid size (x,y,z): (2147483647, 65535, 65535) Maximum memory pitch: 2147483647 bytes Texture alignment: 512 bytes Concurrent copy and kernel execution: Yes with 3 copy engine(s) Run time limit on kernels: No Integrated GPU sharing Host Memory: No Support host page-locked memory mapping: Yes Alignment requirement for Surfaces: Yes Device has ECC support: Disabled Device supports Unified Addressing (UVA): Yes Device supports Compute Preemption: Yes Supports Cooperative Kernel Launch: Yes Supports MultiDevice Co-op Kernel Launch: Yes Device PCI Domain ID / Bus ID / location ID: 0 / 1 / 0 Compute Mode: \u0026lt; Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) \u0026gt; Device 1: \u0026#34;GeForce RTX 2080 Ti\u0026#34; CUDA Driver Version / Runtime Version 10.1 / 10.1 CUDA Capability Major/Minor version number: 7.5 Total amount of global memory: 11019 MBytes (11554717696 bytes) (68) Multiprocessors, ( 64) CUDA Cores/MP: 4352 CUDA Cores GPU Max Clock rate: 1545 MHz (1.54 GHz) Memory Clock rate: 7000 Mhz Memory Bus Width: 352-bit L2 Cache Size: 5767168 bytes Maximum Texture Dimension Size (x,y,z) 1D=(131072), 2D=(131072, 65536), 3D=(16384, 16384, 16384) Maximum Layered 1D Texture Size, (num) layers 1D=(32768), 2048 layers Maximum Layered 2D Texture Size, (num) layers 2D=(32768, 32768), 2048 layers Total amount of constant memory: 65536 bytes Total amount of shared memory per block: 49152 bytes Total number of registers available per block: 65536 Warp size: 32 Maximum number of threads per multiprocessor: 1024 Maximum number of threads per block: 1024 Max dimension size of a thread block (x,y,z): (1024, 1024, 64) Max dimension size of a grid size (x,y,z): (2147483647, 65535, 65535) Maximum memory pitch: 2147483647 bytes Texture alignment: 512 bytes Concurrent copy and kernel execution: Yes with 3 copy engine(s) Run time limit on kernels: No Integrated GPU sharing Host Memory: No Support host page-locked memory mapping: Yes Alignment requirement for Surfaces: Yes Device has ECC support: Disabled Device supports Unified Addressing (UVA): Yes Device supports Compute Preemption: Yes Supports Cooperative Kernel Launch: Yes Supports MultiDevice Co-op Kernel Launch: Yes Device PCI Domain ID / Bus ID / location ID: 0 / 2 / 0 Compute Mode: \u0026lt; Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) \u0026gt; \u0026gt; Peer access from GeForce RTX 2080 Ti (GPU0) -\u0026gt; GeForce RTX 2080 Ti (GPU1) : Yes \u0026gt; Peer access from GeForce RTX 2080 Ti (GPU1) -\u0026gt; GeForce RTX 2080 Ti (GPU0) : Yes deviceQuery, CUDA Driver = CUDART, CUDA Driver Version = 10.1, CUDA Runtime Version = 10.1, NumDevs = 2 æºç  # https://github.com/NVIDIA/cuda-samples/tree/master/Samples/deviceQuery\nç¼–è¯‘ # /usr/local/cuda/bin/nvcc deviceQuery.cpp -I /usr/local/cuda/samples/common/inc/ -o deviceQuery "},{"id":43,"href":"/blog/ffmpeg/rdgQnFI6j/","title":"ffprobeè¯¦è§£","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ffprobeæ˜¯ffmpegæä¾›çš„ä¸‰å¤§å·¥å…·ä¹‹ä¸€ï¼Œç”¨æ¥æŸ¥çœ‹éŸ³è§†é¢‘æ–‡ä»¶çš„å„ç§ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼šå°è£…æ ¼å¼ã€éŸ³é¢‘/è§†é¢‘æµä¿¡æ¯ã€æ•°æ®åŒ…ä¿¡æ¯ç­‰ã€‚\nffprobeçš„æºç æ˜¯ffprobe.cï¼Œå¼€å‘è¿‡ç¨‹ä¸­å¦‚æœæƒ³è·å–ffprobeæŸ¥çœ‹çš„ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡åˆ†ææºç ï¼Œè·å¾—å¯¹åº”å­—æ®µã€‚\næœ¬æ–‡ä¸»è¦ä»‹ç»formatã€streamã€Packetå’ŒFrameä¿¡æ¯ï¼ŒåŒ…å«æ¯ä¸ªå­—æ®µçš„è¯´æ˜ä»¥åŠå¯¹åº”çš„ffmpegå­—æ®µã€‚\næŸ¥çœ‹éŸ³è§†é¢‘æ–‡ä»¶çš„å°è£…æ ¼å¼ # ffprobe -show_format inputFile è¾“å‡ºä¿¡æ¯ï¼š\n[FORMAT] // æ–‡ä»¶å filename=VID_20190811_113717.mp4 // å®¹å™¨ä¸­æµçš„ä¸ªæ•°ï¼Œå³AVFormatContext-\u0026gt;nb_streams nb_streams=2 // å³AVFormatContext-\u0026gt;nb_programs nb_programs=0 // å°è£…æ ¼å¼ï¼Œå³AVFormatContext-\u0026gt;iformat-\u0026gt;name format_name=mov,mp4,m4a,3gp,3g2,mj2 // å³AVFormatContext-\u0026gt;iformat-\u0026gt;long_name format_long_name=QuickTime / MOV // å³AVFormatContext-\u0026gt;start_timeï¼ŒåŸºäºAV_TIME_BASE_Qï¼Œæ¢ç®—ä¸ºç§’ start_time=0.000000 // å³AVFormatContext-\u0026gt;durationï¼ŒåŸºäºAV_TIME_BASE_Qï¼Œæ¢ç®—ä¸ºç§’ duration=10.508000 // å•ä½å­—èŠ‚ï¼Œå³avio_size(AVFormatContext-\u0026gt;pb) size=27263322 // ç ç‡ï¼Œå³AVFormatContext-\u0026gt;bit_rate bit_rate=20756240 // å³AVFormatContext-\u0026gt;probe_score probe_score=100 [/FORMAT] æŸ¥çœ‹éŸ³è§†é¢‘æ–‡ä»¶çš„æµä¿¡æ¯ # ffprobe -show_streams inputFile è¾“å‡ºä¿¡æ¯ï¼š\n[STREAM] // å½“å‰æµçš„ç´¢å¼•ä¿¡æ¯,å¯¹åº”äºAVStream-\u0026gt;index index=0 // AVCodecDescriptor * cd = avcodec_descriptor_get(AVStream-\u0026gt;codecpar-\u0026gt;codec_id) // ç¼–ç åç§°ï¼Œå³cd-\u0026gt;name codec_name=h264 // ç¼–ç å…¨ç§°ï¼Œå³cd-\u0026gt;long_name codec_long_name=H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 // ä¸€ä¸ªç¼–ç å‚æ•°ï¼Œå¯ä»¥ä¸ºBaselineã€Mainã€Highç­‰ï¼ŒBaselineæ— Bå¸§ï¼ŒMainåŠä»¥åå¯ä»¥åŒ…å«Bå¸§ // é€šè¿‡avcodec_profile_name(AVStream-\u0026gt;codecpar-\u0026gt;codec_id, AVStream-\u0026gt;codecpar-\u0026gt;profile)è·å¾— profile=High // æµç±»å‹ï¼Œå³av_get_media_type_string(AVStream-\u0026gt;codecpar-\u0026gt;codec_type) codec_type=video // å³AVStream-\u0026gt;codec-\u0026gt;time_base codec_time_base=14777/877500 // é€šè¿‡å®av_fourcc2str(AVStream-\u0026gt;codecpar-\u0026gt;codec_tag)è·å¾— codec_tag_string=avc1 // å¯¹åº”AVStream-\u0026gt;codecpar-\u0026gt;codec_tag codec_tag=0x31637661 // æœ‰æ•ˆåŒºåŸŸçš„å®½åº¦ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;width width=1920 // æœ‰æ•ˆåŒºåŸŸçš„é«˜åº¦ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;height height=1080 // è§†é¢‘å¸§å®½åº¦ï¼Œå¯èƒ½ä¸ä¸Šé¢çš„å®½åº¦ä¸åŒï¼Œå³AVStream-\u0026gt;codec-\u0026gt;coded_widthï¼Œä¾‹å¦‚ï¼šå½“è§£ç å¸§åœ¨è¾“å‡ºå‰è£å‰ªæˆ–å¯ç”¨ä½åˆ†è¾¨ç‡æ—¶ coded_width=1920 // è§†é¢‘å¸§é«˜åº¦ï¼Œå¯èƒ½ä¸ä¸Šé¢çš„é«˜åº¦ä¸åŒï¼Œå³AVStream-\u0026gt;codec-\u0026gt;coded_heightï¼Œä¾‹å¦‚ï¼šå½“è§£ç å¸§åœ¨è¾“å‡ºå‰è£å‰ªæˆ–å¯ç”¨ä½åˆ†è¾¨ç‡æ—¶ coded_height=1088 // è§†é¢‘çš„å»¶è¿Ÿå¸§æ•°ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;video_delay has_b_frames=0 // sarï¼Œå›¾åƒé‡‡é›†æ—¶ï¼Œæ¨ªå‘é‡‡é›†ç‚¹æ•°ä¸çºµå‘é‡‡é›†ç‚¹æ•°çš„æ¯”ä¾‹ // FFmpegæä¾›äº†å¤šä¸ªsarï¼šAVStream-\u0026gt;sample_aspect_ratioã€AVStream-\u0026gt;codecpar-\u0026gt;sample_aspect_ratioã€AVFrame-\u0026gt;sample_aspect_ratio // é€šè¿‡av_guess_sample_aspect_ratioè·å–æœ€ç»ˆçš„sar sample_aspect_ratio=1:1 // darï¼ŒçœŸæ­£å±•ç¤ºçš„å›¾åƒå®½é«˜æ¯”ï¼Œåœ¨æ¸²æŸ“è§†é¢‘æ—¶ï¼Œå¿…é¡»æ ¹æ®è¿™ä¸ªæ¯”ä¾‹è¿›è¡Œç¼©æ”¾ // é€šè¿‡av_reduceè®¡ç®—å¾—åˆ°ï¼Œpar * sar = dar display_aspect_ratio=16:9 // åƒç´ æ ¼å¼ï¼Œå³av_get_pix_fmt_name(AVStream-\u0026gt;codecpar-\u0026gt;format) pix_fmt=yuvj420p // ç¼–ç å‚æ•°ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;level level=40 // é¢å¤–çš„è‰²å½©ç©ºé—´ç‰¹å¾ï¼Œå³av_color_range_name(AVStream-\u0026gt;codecpar-\u0026gt;color_range)ï¼ŒAVCOL_RANGE_MPEGå¯¹åº”tvï¼ŒAVCOL_RANGE_JPEGå¯¹åº”pc color_range=pc // YUVå½©è‰²ç©ºé—´ç±»å‹ï¼Œå³av_color_space_name(AVStream-\u0026gt;codecpar-\u0026gt;color_space) color_space=bt470bg // é¢œè‰²ä¼ è¾“ç‰¹æ€§ï¼Œå³av_color_transfer_name(AVStream-\u0026gt;codecpar-\u0026gt;color_trc) color_transfer=smpte170m // å³av_color_primaries_name(AVStream-\u0026gt;codecpar-\u0026gt;color_primaries) color_primaries=bt470bg // è‰²åº¦æ ·å“çš„ä½ç½®ï¼Œå³av_chroma_location_name(AVStream-\u0026gt;codecpar-\u0026gt;chroma_location) chroma_location=left // äº¤é”™è§†é¢‘ä¸­å­—æ®µçš„é¡ºåºï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;field_order field_order=unknown // av_timecode_make_mpeg_tc_stringå¤„ç†AVStream-\u0026gt;codec-\u0026gt;timecode_frame_startè·å¾— timecode=N/A // å‚è€ƒå¸§æ•°é‡ï¼Œå³AVStream-\u0026gt;codec-\u0026gt;refs refs=1 is_avc=true // è¡¨ç¤ºç”¨å‡ ä¸ªå­—èŠ‚è¡¨ç¤ºNALUçš„é•¿åº¦ nal_length_size=4 id=N/A // å½“å‰æµçš„åŸºæœ¬å¸§ç‡ï¼Œè¿™ä¸ªå€¼ä»…æ˜¯ä¸€ä¸ªçŒœæµ‹ï¼Œå¯¹åº”äºAVStream-\u0026gt;r_frame_rate r_frame_rate=30/1 // å¹³å‡å¸§ç‡ï¼Œå¯¹åº”äºAVStream-\u0026gt;avg_frame_rate avg_frame_rate=438750/14777 // AVStreamçš„æ—¶é—´åŸºå‡†ï¼Œå³AVStream-\u0026gt;time_base time_base=1/90000 // æµå¼€å§‹æ—¶é—´ï¼ŒåŸºäºtime_baseï¼Œå³AVStream-\u0026gt;start_time start_pts=0 // è½¬æ¢ï¼ˆstart_pts * time_baseï¼‰ä¹‹åçš„å¼€å§‹æ—¶é—´ï¼Œå•ä½ç§’ start_time=0.000000 // æµæ—¶é•¿ï¼ŒåŸºäºtime_baseï¼Œå³AVStream-\u0026gt;duration duration_ts=945728 // è½¬æ¢ï¼ˆduration_ts * time_baseï¼‰ä¹‹åçš„æ—¶é•¿ï¼Œå•ä½ç§’ duration=10.508089 // ç ç‡ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;bit_rate bit_rate=19983544 // æœ€å¤§ç ç‡ï¼Œå³AVStream-\u0026gt;codec-\u0026gt;rc_max_rate max_bit_rate=N/A // Bits per sample/pixelï¼Œå³AVStream-\u0026gt;codec-\u0026gt;bits_per_raw_sample bits_per_raw_sample=8 // è§†é¢‘æµä¸­çš„å¸§æ•°ï¼Œå³AVStream-\u0026gt;nb_frames nb_frames=312 nb_read_frames=N/A nb_read_packets=N/A // ä¸‹é¢TAGä¸ºAVStream-\u0026gt;metadataä¸­çš„ä¿¡æ¯ // é€†æ—¶é’ˆçš„æ—‹è½¬è§’åº¦ï¼ˆç›¸å½“äºæ­£å¸¸è§†é¢‘çš„é€†æ—¶é’ˆæ—‹è½¬è§’åº¦ï¼‰ TAG:rotate=90 // åˆ›å»ºæ—¶é—´ TAG:creation_time=2019-08-11T03:37:28.000000Z // è¯­è¨€ TAG:language=eng TAG:handler_name=VideoHandle // SIDE_DATAä¸ºAVStream-\u0026gt;side_dataæ•°æ® [SIDE_DATA] // side_dataæ•°æ®ç±»å‹ï¼ŒDisplay Matrixè¡¨ç¤ºä¸€ä¸ª3*3çš„çŸ©é˜µï¼Œè¿™ä¸ªçŸ©é˜µéœ€è¦åº”ç”¨åˆ°è§£ç åçš„è§†é¢‘å¸§ä¸Šï¼Œæ‰èƒ½æ­£ç¡®å±•ç¤º side_data_type=Display Matrix displaymatrix= 00000000: 0 65536 0 00000001: -65536 0 0 00000002: 0 0 1073741824 // é¡ºæ—¶é’ˆæ—‹è½¬90åº¦è¿˜åŸè§†é¢‘ rotation=-90 [/SIDE_DATA] [/STREAM] [STREAM] // å½“å‰æµçš„ç´¢å¼•ä¿¡æ¯,å¯¹åº”äºAVStream-\u0026gt;index index=1 // AVCodecDescriptor * cd = avcodec_descriptor_get(AVStream-\u0026gt;codecpar-\u0026gt;codec_id) // ç¼–ç åç§°ï¼Œå³cd-\u0026gt;name codec_name=aac // ç¼–ç å…¨ç§°ï¼Œå³cd-\u0026gt;long_name codec_long_name=AAC (Advanced Audio Coding) // é€šè¿‡avcodec_profile_name(AVStream-\u0026gt;codecpar-\u0026gt;codec_id, AVStream-\u0026gt;codecpar-\u0026gt;profile)è·å¾— profile=LC // æµç±»å‹ï¼Œå³av_get_media_type_string(AVStream-\u0026gt;codecpar-\u0026gt;codec_type) codec_type=audio // å³AVStream-\u0026gt;codec-\u0026gt;time_base codec_time_base=1/48000 // é€šè¿‡å®av_fourcc2str(AVStream-\u0026gt;codecpar-\u0026gt;codec_tag)è·å¾— codec_tag_string=mp4a // å¯¹åº”AVStream-\u0026gt;codecpar-\u0026gt;codec_tag codec_tag=0x6134706d // é‡‡æ ·ç‚¹æ ¼å¼ï¼Œé€šè¿‡av_get_sample_fmt_name(AVStream-\u0026gt;codecpar-\u0026gt;format)è·å– sample_fmt=fltp // é‡‡æ ·ç‡ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;sample_rate sample_rate=48000 // é€šé“æ•°ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;channels channels=2 // é€šé“å¸ƒå±€ï¼Œä¸channelsæ˜¯ç›¸å¯¹åº”ï¼Œé€šè¿‡av_bprint_channel_layoutè·å–ï¼Œstereoè¡¨ç¤ºç«‹ä½“å£° channel_layout=stereo // æ¯ä¸ªé‡‡æ ·ç‚¹å ç”¨å¤šå°‘bitï¼Œå³av_get_bits_per_sample(par-\u0026gt;codec_id) bits_per_sample=0 id=N/A r_frame_rate=0/0 avg_frame_rate=0/0 // AVStreamçš„æ—¶é—´åŸºå‡†ï¼Œå³AVStream-\u0026gt;time_base time_base=1/48000 // æµå¼€å§‹æ—¶é—´ï¼ŒåŸºäºtime_baseï¼Œå³AVStream-\u0026gt;start_time start_pts=0 // è½¬æ¢ï¼ˆstart_pts * time_baseï¼‰ä¹‹åçš„å¼€å§‹æ—¶é—´ï¼Œå•ä½ç§’ start_time=0.000000 // æµæ—¶é•¿ï¼ŒåŸºäºtime_baseï¼Œå³AVStream-\u0026gt;duration duration_ts=502776 // è½¬æ¢ï¼ˆduration_ts * time_baseï¼‰ä¹‹åçš„æ—¶é•¿ï¼Œå•ä½ç§’ duration=10.474500 // ç ç‡ï¼Œå³AVStream-\u0026gt;codecpar-\u0026gt;bit_rate bit_rate=156002 // æœ€å¤§ç ç‡ï¼Œå³AVStream-\u0026gt;codec-\u0026gt;rc_max_rate max_bit_rate=156000 // Bits per sample/pixelï¼Œå³AVStream-\u0026gt;codec-\u0026gt;bits_per_raw_sample bits_per_raw_sample=N/A // éŸ³é¢‘æµä¸­çš„å¸§æ•°ï¼Œå³AVStream-\u0026gt;nb_frames nb_frames=491 nb_read_frames=N/A nb_read_packets=N/A TAG:creation_time=2019-08-11T03:37:28.000000Z TAG:language=eng TAG:handler_name=SoundHandle [/STREAM] SAR(Sample Aspect Ratio): é‡‡æ ·æ•°å®½é«˜æ¯”ï¼Œå›¾åƒçš„æ¨ªå‘é‡‡é›†ç‚¹æ•°ä¸çºµå‘é‡‡é›†ç‚¹æ•°çš„æ¯”å€¼ï¼Œå³åƒç´ ä¸ªæ•°çš„æ¯”å€¼ã€‚\nPAR(Pixel Aspect Ratio): åƒç´ å®½é«˜æ¯”ï¼Œå³æ¯ä¸ªåƒç´ çš„å®½åº¦ä¸é«˜åº¦çš„æ¯”å€¼ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºåƒç´ ä¸æ˜¯æ­£æ–¹å½¢çš„ã€‚\nDAR(Display Aspect Ratio): æ˜¾ç¤ºå®½é«˜æ¯”ï¼Œå›¾åƒæœ€ç»ˆå±•ç¤ºçš„å®½é«˜æ¯”ï¼Œæ’­æ”¾å™¨åœ¨æ¸²æŸ“è§†é¢‘å¸§æ—¶ï¼Œéœ€è¦ä¿æŒDARçš„æ¯”ä¾‹ã€‚\nå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼šPAR * SAR = DAR\nå¦‚ä¸Šå›¾æ‰€ç¤ºï¼šæ¯ä¸ªæ–¹æ ¼ä»£è¡¨ä¸€ä¸ªåƒç´ ï¼Œå®½åº¦ä¸º5åƒç´ ï¼Œé«˜åº¦ä¸º4åƒç´ ï¼Œå³SAR=5 : 4\nå‡è®¾å›¾åƒçš„æ˜¾ç¤ºå®½åº¦ä¸º160ï¼Œé«˜åº¦ä¸º120ï¼Œå³DAR=4 : 3\né‚£ä¹ˆå¯ä»¥è®¡ç®—å‡ºPAR = DAR / SAR = 16 : 15ï¼Œè¡¨ç¤ºåƒç´ æ–¹æ ¼æ˜¯ä¸€ä¸ªé•¿æ–¹å½¢ã€‚\nFFmpegæä¾›äº†å¤šä¸ªSARï¼š\nAVStream-\u0026gt;sample_aspect_ratio\nAVStream-\u0026gt;codecpar-\u0026gt;sample_aspect_ratio\nAVFrame-\u0026gt;sample_aspect_ratio\næœ€ç»ˆçš„SARæ˜¯é€šè¿‡av_guess_sample_aspect_ratioè·å–çš„ã€‚\nå¯¹äºDARï¼ŒAVStream-\u0026gt;display_aspect_ratioçš„å€¼å§‹ç»ˆä¸º0:0ï¼Œå‚è€ƒffprobeä»£ç ï¼Œå¯çŸ¥DARæ˜¯é€šè¿‡av_reduceè®¡ç®—å¾—åˆ°çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nAVRational sar, dar; // par AVCodecParameters *par = AVStream-\u0026gt;codecpar; // è®¡ç®—å‡ºsar sar = av_guess_sample_aspect_ratio(AVFormatContext, AVStream, NULL); // æ ¹æ®parå’Œsarè®¡ç®—å‡ºdar av_reduce(\u0026amp;dar.num, \u0026amp;dar.den, par-\u0026gt;width * sar.num, par-\u0026gt;height * sar.den, 1024*1024); æŸ¥çœ‹éŸ³è§†é¢‘æ–‡ä»¶çš„æ•°æ®åŒ…ä¿¡æ¯ # // -select_streamsè¡¨ç¤ºé€‰æ‹©éŸ³é¢‘æˆ–è€…è§†é¢‘ ffprobe -show_format [-select_streams audio | video] inputFile é¦–å…ˆçœ‹ä¸‹è§†é¢‘æµçš„ç¬¬ä¸€ä¸ªPacketå’Œç¬¬äºŒä¸ªPacketï¼š\n[PACKET] //Packetç±»å‹ï¼Œå³av_get_media_type_string(AVStream-\u0026gt;codecpar-\u0026gt;codec_type) codec_type=video // å½“å‰å¸§æ‰€å±æµçš„ç´¢å¼•ä¿¡æ¯,å¯¹åº”äºAVStream-\u0026gt;index stream_index=0 // å¸§å±•ç¤ºæ—¶é—´ï¼Œå³AVPacket-\u0026gt;ptsï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pts=0 // æ¢ç®—ä¸ºç§’ pts_time=0.000000 // å¸§è§£ç æ—¶é—´ï¼Œå³AVPacket-\u0026gt;dtsï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† dts=0 // æ¢ç®—ä¸ºç§’ dts_time=0.000000 // å½“å‰å¸§çš„æ—¶é•¿ï¼Œç­‰äºä¸‹ä¸€å¸§çš„pts - å½“å‰å¸§ptsï¼Œå³AVPacket-\u0026gt;durationï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† duration=12972 // æ¢ç®—ä¸ºç§’ duration_time=0.144133 // AVPacket-\u0026gt;convergence_durationï¼Œä¹Ÿæ˜¯åŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† convergence_duration=N/A // æ¢ç®—ä¸ºç§’ convergence_duration_time=N/A // å½“å‰å¸§çš„Sizeï¼Œå­—èŠ‚ï¼Œå³AVPacket-\u0026gt;size size=187872 // å½“å‰å¸§åœ°å€åç§»é‡ï¼Œå³AVPacket-\u0026gt;pos pos=830842 flags=K_ [/PACKET] [PACKET] codec_type=video stream_index=0 pts=12972 // å³ 12972 / 90000 pts_time=0.144133 dts=12972 dts_time=0.144133 duration=2999 duration_time=0.033322 convergence_duration=N/A convergence_duration_time=N/A size=31200 // ä¸Šä¸€å¸§çš„pos + size pos=1018714 flags=__ [/PACKET] ç„¶åçœ‹ä¸‹éŸ³é¢‘æµçš„ç¬¬ä¸€ä¸ªPacketå’Œç¬¬äºŒä¸ªPacketï¼š\n[PACKET] // éŸ³é¢‘å¸§ codec_type=audio // å½“å‰å¸§æ‰€å±æµçš„ç´¢å¼•ä¿¡æ¯,å¯¹åº”äºAVStream-\u0026gt;index stream_index=1 // å¸§å±•ç¤ºæ—¶é—´ï¼Œå³AVPacket-\u0026gt;ptsï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pts=0 pts_time=0.000000 // å¸§è§£ç æ—¶é—´ï¼Œå³AVPacket-\u0026gt;dtsï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† dts=0 dts_time=0.000000 // å½“å‰å¸§çš„æ—¶é•¿ï¼Œç­‰äºä¸‹ä¸€å¸§çš„pts - å½“å‰å¸§ptsï¼Œå³AVPacket-\u0026gt;durationï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† duration=1024 // 1024 / 48000 duration_time=0.021333 convergence_duration=N/A convergence_duration_time=N/A size=416 pos=810458 flags=K_ [/PACKET] [PACKET] // éŸ³é¢‘å¸§ codec_type=audio stream_index=1 pts=1024 // 1024 / 48000 pts_time=0.021333 dts=1024 dts_time=0.021333 duration=1024 duration_time=0.021333 convergence_duration=N/A convergence_duration_time=N/A size=416 // ä¸Šä¸€å¸§çš„pos + size pos=810874 flags=K_ [/PACKET] æŸ¥çœ‹éŸ³è§†é¢‘æ–‡ä»¶è§£ç åçš„å¸§ä¿¡æ¯ # // -select_streamsè¡¨ç¤ºé€‰æ‹©éŸ³é¢‘æˆ–è€…è§†é¢‘ ffprobe -show_frames [-select_streams audio | video] inputFile é¦–å…ˆçœ‹ä¸‹è§†é¢‘æµçš„ç¬¬ä¸€å¸§å’Œç¬¬äºŒå¸§ï¼š\n[FRAME] // å¸§ç±»å‹ï¼Œå³av_get_media_type_string(AVStream-\u0026gt;codecpar-\u0026gt;codec_type) media_type=video // å½“å‰å¸§æ‰€å±æµçš„ç´¢å¼•ä¿¡æ¯, å¯¹åº”äºAVStream-\u0026gt;index stream_index=0 // æ˜¯å¦å…³é”®å¸§ï¼Œ1ï¼šå…³é”®å¸§ï¼Œ0ï¼šéå…³é”®å¸§ï¼Œå³AVFrame-\u0026gt;key_frame key_frame=1 // å¸§å±•ç¤ºæ—¶é—´, å³AVFrame-\u0026gt;pts, åŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pkt_pts=0 // æ¢ç®—ä¸ºç§’ pkt_pts_time=0.000000 // å¸§è§£ç æ—¶é—´ï¼Œä»å¯¹åº”çš„AVPacket copyè€Œæ¥ï¼Œå³AVFrame-\u0026gt;pkt_dtsï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pkt_dts=0 // æ¢ç®—ä¸ºç§’ pkt_dts_time=0.000000 // å¸§æ—¶é—´æˆ³ï¼ŒåŸºæœ¬ä¸ptsç›¸åŒï¼Œå³AVFrame-\u0026gt;best_effort_timestampï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† best_effort_timestamp=0 // æ¢ç®—ä¸ºç§’ best_effort_timestamp_time=0.000000 // å¯¹åº”çš„AVPacketçš„å¸§æ—¶é•¿ï¼Œå³AVFrame-\u0026gt;pkt_durationï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pkt_duration=12972 // æ¢ç®—ä¸ºç§’ pkt_duration_time=0.144133 // ä»æœ€åä¸€ä¸ªå·²è¾“å…¥è§£ç å™¨çš„AVPacketé‡æ–°æ’åºçš„posï¼Œå³AVFrame-\u0026gt;pkt_pos pkt_pos=830842 // å¯¹åº”çš„AVPacketçš„å¸§sizeï¼Œå³AVFrame-\u0026gt;pkt_size pkt_size=187872 // æ—‹è½¬ä¹‹å‰çš„å¸§å®½åº¦ï¼Œå³AVFrame-\u0026gt;width width=1920 // æ—‹è½¬ä¹‹å‰çš„å¸§é«˜åº¦ï¼Œå³AVFrame-\u0026gt;height height=1080 // è§†é¢‘å¸§çš„åƒç´ æ ¼å¼ï¼Œå³av_get_pix_fmt_name(AVFrame-\u0026gt;format) pix_fmt=yuvj420p // sarï¼Œå›¾åƒé‡‡é›†æ—¶ï¼Œæ¨ªå‘é‡‡é›†ç‚¹æ•°ä¸çºµå‘é‡‡é›†ç‚¹æ•°çš„æ¯”ä¾‹ // FFmpegæä¾›äº†å¤šä¸ªsarï¼šAVStream-\u0026gt;sample_aspect_ratioã€AVStream-\u0026gt;codecpar-\u0026gt;sample_aspect_ratioã€AVFrame-\u0026gt;sample_aspect_ratio // é€šè¿‡av_guess_sample_aspect_ratioè·å–æœ€ç»ˆçš„sar sample_aspect_ratio=1:1 // è§†é¢‘å¸§çš„å›¾ç‰‡ç±»å‹ï¼Œæ­¤å¤„ä¸ºIå¸§ï¼Œå³av_get_picture_type_char(frame-\u0026gt;pict_type) pict_type=I // picture number in bitstream order, å³AVFrame-\u0026gt;coded_picture_number coded_picture_number=0 // picture number in display order, å³AVFrame-\u0026gt;display_picture_number display_picture_number=0 // è§†é¢‘å¸§å†…å®¹æ˜¯å¦æ˜¯äº¤é”™çš„, å³AVFrame-\u0026gt;interlaced_frame interlaced_frame=0 // è‹¥è§†é¢‘å¸§å†…å®¹æ˜¯äº¤é”™çš„ï¼Œè¡¨ç¤ºé¦–å…ˆå±•ç¤ºçš„é¡¶éƒ¨å­—æ®µï¼Œå³AVFrame-\u0026gt;top_field_first top_field_first=0 // å½“è§£ç æ—¶ï¼Œè¿™ä¸ªä¿¡å·è¡¨æ˜è§†é¢‘å¸§å¿…é¡»å»¶è¿Ÿå¤šå°‘ã€‚extra_delay = repeat_pict / (2*fps), å³AVFrame-\u0026gt;repeat_pict repeat_pict=0 // é¢å¤–çš„è‰²å½©ç©ºé—´ç‰¹å¾ï¼Œå³av_color_range_name(AVFrame-\u0026gt;color_range)ï¼ŒAVCOL_RANGE_MPEGå¯¹åº”tvï¼ŒAVCOL_RANGE_JPEGå¯¹åº”pc color_range=pc // YUVå½©è‰²ç©ºé—´ç±»å‹ï¼Œå³av_color_space_name(AVFrame-\u0026gt;colorspace) color_space=bt470bg // å³av_color_primaries_name(AVFrame-\u0026gt;color_primaries) color_primaries=bt470bg // é¢œè‰²ä¼ è¾“ç‰¹æ€§ï¼Œå³av_color_transfer_name(AVFrame-\u0026gt;color_trc) color_transfer=smpte170m // è‰²åº¦æ ·å“çš„ä½ç½®ï¼Œå³av_chroma_location_name(AVFrame-\u0026gt;chroma_location) chroma_location=left [/FRAME] [FRAME] media_type=video stream_index=0 // éå…³é”®å¸§ key_frame=0 pkt_pts=12972 // 12972 / 90000 pkt_pts_time=0.144133 pkt_dts=12972 pkt_dts_time=0.144133 best_effort_timestamp=12972 best_effort_timestamp_time=0.144133 pkt_duration=2999 pkt_duration_time=0.033322 pkt_pos=1018714 pkt_size=31200 width=1920 height=1080 pix_fmt=yuvj420p sample_aspect_ratio=1:1 // è§†é¢‘å¸§çš„å›¾ç‰‡ç±»å‹ï¼Œæ­¤å¤„ä¸ºPå¸§ï¼Œå³av_get_picture_type_char(frame-\u0026gt;pict_type) pict_type=P coded_picture_number=1 display_picture_number=0 interlaced_frame=0 top_field_first=0 repeat_pict=0 color_range=pc color_space=bt470bg color_primaries=bt470bg color_transfer=smpte170m chroma_location=left [/FRAME] ç„¶åçœ‹ä¸‹éŸ³é¢‘æµçš„ç¬¬ä¸€å¸§å’Œç¬¬äºŒå¸§ï¼š\n[FRAME] // å¸§ç±»å‹ï¼Œå³av_get_media_type_string(AVStream-\u0026gt;codecpar-\u0026gt;codec_type) media_type=audio // å½“å‰å¸§æ‰€å±æµçš„ç´¢å¼•ä¿¡æ¯, å¯¹åº”äºAVStream-\u0026gt;index stream_index=1 // æ˜¯å¦å…³é”®å¸§ key_frame=1 // å¸§å±•ç¤ºæ—¶é—´, å³AVFrame-\u0026gt;pts, åŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pkt_pts=0 // æ¢ç®—ä¸ºç§’ pkt_pts_time=0.000000 // å¸§è§£ç æ—¶é—´ï¼Œä»å¯¹åº”çš„AVPacket copyè€Œæ¥ï¼Œå³AVFrame-\u0026gt;pkt_dtsï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pkt_dts=0 // æ¢ç®—ä¸ºç§’ pkt_dts_time=0.000000 // å¸§æ—¶é—´æˆ³ï¼ŒåŸºæœ¬ä¸ptsç›¸åŒï¼Œå³AVFrame-\u0026gt;best_effort_timestampï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† best_effort_timestamp=0 // æ¢ç®—ä¸ºç§’ best_effort_timestamp_time=0.000000 // å¯¹åº”çš„AVPacketçš„å¸§æ—¶é•¿ï¼Œå³AVFrame-\u0026gt;pkt_durationï¼ŒåŸºäºAVStream-\u0026gt;time_baseæ—¶é—´åŸºå‡† pkt_duration=1024 // æ¢ç®—ä¸ºç§’ pkt_duration_time=0.021333 // ä»æœ€åä¸€ä¸ªå·²è¾“å…¥è§£ç å™¨çš„AVPacketé‡æ–°æ’åºçš„posï¼Œå³AVFrame-\u0026gt;pkt_pos pkt_pos=810458 // å¯¹åº”çš„AVPacketçš„å¸§sizeï¼Œå³AVFrame-\u0026gt;pkt_size pkt_size=416 // éŸ³é¢‘é‡‡æ ·ç‚¹æ ¼å¼ï¼Œå³av_get_sample_fmt_name(AVFrame-\u0026gt;format) sample_fmt=fltp // å½“å‰éŸ³é¢‘å¸§çš„é‡‡æ ·ç‚¹æ•°ï¼Œå³AVFrame-\u0026gt;nb_samples nb_samples=1024 // é€šé“æ•°ï¼Œå³AVFrame-\u0026gt;channels channels=2 // é€šé“å¸ƒå±€ï¼Œé€šè¿‡av_bprint_channel_layoutå¾—åˆ°ï¼Œä¸channelså¯¹åº” channel_layout=stereo [/FRAME] [FRAME] media_type=audio stream_index=1 key_frame=1 pkt_pts=1024 pkt_pts_time=0.021333 pkt_dts=1024 pkt_dts_time=0.021333 best_effort_timestamp=1024 best_effort_timestamp_time=0.021333 pkt_duration=1024 pkt_duration_time=0.021333 pkt_pos=810874 pkt_size=416 sample_fmt=fltp nb_samples=1024 channels=2 channel_layout=stereo [/FRAME] å‚è€ƒæ–‡ç«  # FFmpegè·å–è§†é¢‘æ­£ç¡®çš„å®½é«˜æ¯”\nè½¬è½½è‡ª-\u0026gt;https://www.zybuluo.com/ltlovezh/note/1534824\n"},{"id":44,"href":"/blog/macos/MiSev5_HW/","title":"upx for macos ä¹‹æºç ç¼–è¯‘","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" UPX (the Ultimate Packer for eXecutables)æ˜¯ä¸€æ¬¾å…ˆè¿›çš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶å‹ç¼©å™¨ï¼Œå‹ç¼©è¿‡çš„å¯æ‰§è¡Œæ–‡ä»¶ä½“ç§¯ç¼©å°50%-70% ï¼Œè¿™æ ·å‡å°‘äº†ç£ç›˜å ç”¨ç©ºé—´ã€ç½‘ç»œä¸Šä¼ ä¸‹è½½çš„æ—¶é—´å’Œå…¶å®ƒåˆ†å¸ƒä»¥åŠå­˜å‚¨è´¹ç”¨ã€‚\nå‡†å¤‡æºç  # git clone https://github.com/upx/upx.git git clone https://github.com/upx/upx-lzma-sdk.git lzma-sdk wget http://www.oberhumer.com/opensource/ucl/download/ucl-1.03.tar.gz ç¼–è¯‘æºç  # tar -xzvf ucl-1.03.tar.gz cd ucl-1.03 ./configure --prefix=/home/o/ucl CC=clang make cd ../upx make all UPX_UCLDIR=../ucl-1.03 UPX_LZMADIR=../lzma-sdk ç¼–è¯‘å®Œæˆä¹‹åå†srcç›®å½•ä¸‹èƒ½æ‰¾åˆ°upx.outæ–‡ä»¶å°±æˆåŠŸäº†\n"},{"id":45,"href":"/blog/ffmpeg/ovfEIBOES/","title":"ffmpeg åˆ é™¤éŸ³è§†é¢‘æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" æ¸…é™¤mp3æ–‡ä»¶ä¸­è‡ªå¸¦çš„ä¸“è¾‘ï¼ˆalbumï¼‰ï¼Œè‰ºæœ¯å®¶ï¼ˆartistï¼‰ï¼Œæµæ´¾ï¼ˆgenreï¼‰ç­‰å…ƒæ•°æ®ã€‚\nffmpeg -i \u0026#34;test.mp3\u0026#34; -b:a 320k -map_metadata -1 -y \u0026#34;out.mp3\u0026#34; -map_metadata -1 è¡¨ç¤ºæ¸…é™¤æ‰€æœ‰å…ƒæ•°æ®\n"},{"id":46,"href":"/blog/linux/roH7hpe6L/","title":"mediainfo é™æ€ç¼–è¯‘è„šæœ¬","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å› ä¸ºéœ€è¦mediainfoæ”¯æŒhttpåè®®ï¼Œåœ¨è€çš„ç‰ˆæœ¬ä¸­æ˜¯ä¸æ”¯æŒçš„ï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±åŠ¨æ‰‹ç¼–è¯‘äº†ã€‚\nè¯´æ˜ # ç³»ç»Ÿï¼šubuntu 14.04 (å…¶ä»–ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰å°‘è®¸æ”¹åŠ¨)\nmediainfoç‰ˆæœ¬ï¼š0.7.71\nç¼–è¯‘ç¯å¢ƒï¼šc/c++\nè„šæœ¬ # #!/bin/bash cd ~/ apt-get install git automake autoconf libtool pkg-config make g++ zlib1g-dev libcurl4-gnutls-dev git clone https://github.com/MediaArea/ZenLib.git cd ZenLib make clean git checkout v0.4.37 cd Project/GNU/Library ./autogen.sh ./configure --enable-static make -j2 cd ~/ git clone https://github.com/openssl/openssl.git cd openssl make clean git checkout OpenSSL_1_0_2i ./Configure linux-generic64 make -j2 curl_vserion=7.50.0 cd ~/ wget --no-check-certificate https://curl.haxx.se/download/curl-$curl_vserion.tar.gz tar -zxvf curl-$curl_vserion.tar.gz cd curl-$curl_vserion/ make clean ./configure --enable-static --disable-share --disable-ldap --disable-ldaps --without-librtmp --without-libidn make -j2 cd ~/ git clone https://github.com/MediaArea/MediaInfoLib.git cd MediaInfoLib git checkout v0.7.71 cd Project/GNU/Library/ make clean ./autogen ## --with-libcurl å¼€å¯æ”¯æŒhttpå’Œftp ./configure --enable-static --with-libcurl=../../../../curl-$curl_vserion/ make -j2 cd ~/ git clone https://github.com/MediaArea/MediaInfo.git cd MediaInfo git checkout v0.7.71 cd Project/GNU/CLI make clean ./autogen ./configure --enable-staticlibs make -j2 # make install g++ -static -O2 -DUNICODE -DUNICODE -DSIZE_T_IS_LONG -o mediainfo CLI_Main.o CommandLine_Parser.o Help.o Core.o ../../../../MediaInfoLib/Project/GNU/Library/.libs/libmediainfo.a -lz ../../../../ZenLib/Project/GNU/Library/.libs/libzen.a ../../../../curl-$curl_vserion/lib/.libs/libcurl.a ../../../../openssl/libssl.a ../../../../openssl/libcrypto.a -lpthread -lstdc++ -pthread -Wl,-rpath -Wl,../../../../ZenLib/Project/GNU/Library/.libs -Wl,-rpath -Wl,../../../../curl-$curl_vserion/lib/.libs -Wl,-rpath -Wl,../../../../openssl -ldl "},{"id":47,"href":"/blog/linux/JQIo7dGc1/","title":"openssl - https SANè‡ªç­¾åè¯ä¹¦","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨opensslç”Ÿäº§è‡ªç­¾åè¯ä¹¦ï¼Œç”¨äºhttpsæµ‹è¯•ã€‚\nCAæ ¹è¯ä¹¦åˆ¶ä½œ # #1.ç”Ÿæˆæ ¹è¯ä¹¦å¯†é’¥ $ openssl genrsa -out ca.key 4096 #å»ºè®®é•¿åº¦ä¸º4096,1024é•¿åº¦å·²ç»è¢«åˆ—ä¸ºä¸å®‰å…¨ã€‚ #2.ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦ $ openssl req -new -x509 -days 3650 -key ca.key -out ca.crt #è¿™é‡Œåœ¨è¾“å…¥CommonNameçš„æ—¶å€™è¾“å…¥åç§°è€Œä¸æ˜¯åŸŸåæˆ–è€…ip,å°±æ˜¯è¯ä¹¦ä¸Šæ˜¾ç¤ºçš„é¢å‘è€…ï¼Œè™½ç„¶æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œä½†æ˜¯å°½é‡è®©è¯ä¹¦çœ‹èµ·æ¥æ ‡å‡†ä¸€äº› ä½¿ç”¨æ ¹è¯ä¹¦æ¥ç­¾åå…¶å®ƒè¯ä¹¦ # 1.ç”Ÿæˆè¯ä¹¦å¯†é’¥ # $ openssl genrsa -out server.key 4096 2. Subject Alt Name(SAN) # é«˜ç‰ˆæœ¬çš„Chromeæµè§ˆå™¨ä¼šè¦æ±‚è®¾ç½® subjectAltName,å¦‚æœæ²¡æœ‰è®¾ç½®SANä¼šæŠ¥è¯ä¹¦é”™è¯¯\nå‚è€ƒopensslé…ç½®æ–‡ä»¶,LinuxæœåŠ¡å™¨ä¸Šé€šå¸¸åœ¨ /etc/pki/tls/openssl.cnf\næ–°å»ºæ–‡ä»¶ san.conf\n[req] default_bits = 4096 distinguished_name = req_distinguished_name req_extensions = v3_req [req_distinguished_name] countryName = country stateOrProvinceName = province localityName = city organizationName = company name commonName = domain name or ip [v3_req] subjectAltName = @alt_names [alt_names] NDS.1=domain #å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ IP.1=xxx.xxx.xxx.xxx 3. ç”Ÿæˆè¯ä¹¦ç­¾åè¯·æ±‚(CSR) # å‘æ ¹è¯ä¹¦è¯·æ±‚ç­¾åä¸€ä¸ªæ–°çš„è¯ä¹¦ï¼Œç”±äºç”¨æˆ·ä¿¡ä»»äº†ä½ çš„æ ¹è¯ä¹¦ï¼Œæ‰€ä»¥æ ¹è¯ä¹¦ç­¾åçš„å…¶å®ƒè¯ä¹¦ä¹Ÿä¼šè¢«ä¿¡ä»»\n# ç”Ÿæˆcsr æ³¨æ„è¦ä½¿ç”¨sha256ç®—æ³•ï¼ˆæ¨èæ˜¯sha256ç®—æ³•ï¼Œé»˜è®¤ç®—æ³•æµè§ˆå™¨ä¼šæŠ¥å¼±åŠ å¯†ç®—æ³•é”™è¯¯ï¼‰ $ openssl req -new -key server.key -out server.csr -config san.conf -sha256 # æŸ¥çœ‹csrä¿¡æ¯ $ openssl req -text -in server.csr csrä¿¡æ¯ä¸­ä¼šæœ‰ç±»ä¼¼çš„ä¿¡æ¯\nRequested Extensions: X509v3 Subject Alternative Name: IP Address:xxxxxx 4.ä½¿ç”¨æ ¹è¯ä¹¦æŒ‰ç…§csrç»™è¯ä¹¦ç­¾åï¼Œç”Ÿæˆæ–°è¯ä¹¦server.crt # $ openssl x509 -req -days 365 -in server.csr -CA ca.crt -CAkey ca.key -set_serial 01 -out server.crt -extfile san.conf -extensions v3_req æŸ¥çœ‹è¯ä¹¦ä¿¡æ¯\n$ openssl x509 -text -in server.crt è¯ä¹¦ä¿¡æ¯ä¸­ä¼šæœ‰ç±»ä¼¼ä¿¡æ¯\nX509v3 extensions: X509v3 Subject Alternative Name: IP Address:xxxxxx "},{"id":48,"href":"/blog/linux/B1G3FwCaN/","title":"supervisor å®‰è£…å’Œä½¿ç”¨æ–¹æ³•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" Supervisoræ˜¯ç”¨Pythonå¼€å‘çš„ä¸€å¥—é€šç”¨çš„è¿›ç¨‹ç®¡ç†ç¨‹åºï¼Œèƒ½å°†ä¸€ä¸ªæ™®é€šçš„å‘½ä»¤è¡Œè¿›ç¨‹å˜ä¸ºåå°daemonï¼Œå¹¶ç›‘æ§è¿›ç¨‹çŠ¶æ€ï¼Œå¼‚å¸¸é€€å‡ºæ—¶èƒ½è‡ªåŠ¨é‡å¯ã€‚\nå‡†å¤‡å·¥ä½œ # yum install epel-* -y yum install python34 -y wget --no-check-certificate python3 get-pip.py å®‰è£…supervisor # pip3 install supervisor é…ç½®supervisor # echo_supervisord_conf \u0026gt;/etc/supervisord.conf vi /etc/supervisord.conf ...... ;[include] ;è¿™ä¸ªä¸œè¥¿æŒºæœ‰ç”¨çš„ï¼Œå½“æˆ‘ä»¬è¦ç®¡ç†çš„è¿›ç¨‹å¾ˆå¤šçš„æ—¶å€™ï¼Œå†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å°±æœ‰ç‚¹å¤§äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠé…ç½®ä¿¡æ¯å†™åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åincludeè¿‡æ¥ ;files = relative/directory/*.ini å»æ‰ä¸Šé¢ä¸¤è¡Œçš„â€;â€œç„¶åå°†filesæ”¹æˆè‡ªå·±çš„ç›®å½•\nvi /etc/supervisord.conf [unix_http_server] file=/tmp/supervisor.sock ;UNIX socket æ–‡ä»¶ï¼Œsupervisorctl ä¼šä½¿ç”¨ ;chmod=0700 ;socketæ–‡ä»¶çš„modeï¼Œé»˜è®¤æ˜¯0700;chown=nobody:nogroup ;socketæ–‡ä»¶çš„ownerï¼Œæ ¼å¼ï¼šuid:gid ;[inet_http_server] ;HTTPæœåŠ¡å™¨ï¼Œæä¾›webç®¡ç†ç•Œé¢ ;port=127.0.0.1:9001 ;Webç®¡ç†åå°è¿è¡Œçš„IPå’Œç«¯å£ï¼Œå¦‚æœå¼€æ”¾åˆ°å…¬ç½‘ï¼Œéœ€è¦æ³¨æ„å®‰å…¨æ€§ ;username=user ;ç™»å½•ç®¡ç†åå°çš„ç”¨æˆ·å ;password=123 ;ç™»å½•ç®¡ç†åå°çš„å¯†ç  [supervisord] logfile=/tmp/supervisord.log ;æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ $CWD/supervisord.loglogfile_maxbytes=50MB ;æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºä¼šrotateï¼Œé»˜è®¤ 50MBï¼Œå¦‚æœè®¾æˆ0ï¼Œè¡¨ç¤ºä¸é™åˆ¶å¤§å° logfile_backups=10 ;æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤‡ä»½æ•°é‡é»˜è®¤10ï¼Œè®¾ä¸º0è¡¨ç¤ºä¸å¤‡ä»½ loglevel=info ;æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤infoï¼Œå…¶å®ƒ: debug,warn,trace pidfile=/tmp/supervisord.pid ;pid æ–‡ä»¶ nodaemon=false ;æ˜¯å¦åœ¨å‰å°å¯åŠ¨ï¼Œé»˜è®¤æ˜¯falseï¼Œå³ä»¥ daemon çš„æ–¹å¼å¯åŠ¨ minfds=1024 ;å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„æœ€å°å€¼ï¼Œé»˜è®¤ 1024minprocs=200 ;å¯ä»¥æ‰“å¼€çš„è¿›ç¨‹æ•°çš„æœ€å°å€¼ï¼Œé»˜è®¤ 200 [supervisorctl] serverurl=unix:///tmp/supervisor.sock ;é€šè¿‡UNIX socketè¿æ¥supervisordï¼Œè·¯å¾„ä¸unix_http_serveréƒ¨åˆ†çš„fileä¸€è‡´;serverurl=http://127.0.0.1:9001 ; é€šè¿‡HTTPçš„æ–¹å¼è¿æ¥supervisord ; [program:xx]æ˜¯è¢«ç®¡ç†çš„è¿›ç¨‹é…ç½®å‚æ•°ï¼Œxxæ˜¯è¿›ç¨‹çš„åç§° [program:xx] command=/opt/apache-tomcat-8.0.35/bin/catalina.sh run ; ç¨‹åºå¯åŠ¨å‘½ä»¤ autostart=true ; åœ¨supervisordå¯åŠ¨çš„æ—¶å€™ä¹Ÿè‡ªåŠ¨å¯åŠ¨ startsecs=10 ; å¯åŠ¨10ç§’åæ²¡æœ‰å¼‚å¸¸é€€å‡ºï¼Œå°±è¡¨ç¤ºè¿›ç¨‹æ­£å¸¸å¯åŠ¨äº†ï¼Œé»˜è®¤ä¸º1ç§’ autorestart=true ; ç¨‹åºé€€å‡ºåè‡ªåŠ¨é‡å¯,å¯é€‰å€¼ï¼š[unexpected,true,false]ï¼Œé»˜è®¤ä¸ºunexpectedï¼Œè¡¨ç¤ºè¿›ç¨‹æ„å¤–æ€æ­»åæ‰é‡å¯ startretries=3 ; å¯åŠ¨å¤±è´¥è‡ªåŠ¨é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤æ˜¯3user=tomcat ; ç”¨å“ªä¸ªç”¨æˆ·å¯åŠ¨è¿›ç¨‹ï¼Œé»˜è®¤æ˜¯root priority=999 ; è¿›ç¨‹å¯åŠ¨ä¼˜å…ˆçº§ï¼Œé»˜è®¤999ï¼Œå€¼å°çš„ä¼˜å…ˆå¯åŠ¨ redirect_stderr=true ; æŠŠstderré‡å®šå‘åˆ°stdoutï¼Œé»˜è®¤falsestdout_logfile_maxbytes=20MB ; stdout æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œé»˜è®¤50MB stdout_logfile_backups = 20 ; stdout æ—¥å¿—æ–‡ä»¶å¤‡ä»½æ•°ï¼Œé»˜è®¤æ˜¯10; stdout æ—¥å¿—æ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„å½“æŒ‡å®šç›®å½•ä¸å­˜åœ¨æ—¶æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨åˆ›å»ºç›®å½•ï¼ˆsupervisord ä¼šè‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼‰ stdout_logfile=/opt/apache-tomcat-8.0.35/logs/catalina.out stopasgroup=false ;é»˜è®¤ä¸ºfalse,è¿›ç¨‹è¢«æ€æ­»æ—¶ï¼Œæ˜¯å¦å‘è¿™ä¸ªè¿›ç¨‹ç»„å‘é€stopä¿¡å·ï¼ŒåŒ…æ‹¬å­è¿›ç¨‹ killasgroup=false ;é»˜è®¤ä¸ºfalseï¼Œå‘è¿›ç¨‹ç»„å‘é€killä¿¡å·ï¼ŒåŒ…æ‹¬å­è¿›ç¨‹ ;åŒ…å«å…¶å®ƒé…ç½®æ–‡ä»¶ [include] files = /etc/supervisord.d/*.ini ;å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªä»¥.iniç»“æŸçš„é…ç½®æ–‡ä»¶ mkdir /etc/supervisord.d/ å¯åŠ¨supervisor # supervisord -c /etc/supervisord.conf å¸¸ç”¨å‘½ä»¤ # æŸ¥çœ‹çŠ¶æ€ # supervisorctl status å¯åŠ¨æœåŠ¡ # supervisorctl start æœåŠ¡å åœæ­¢æœåŠ¡ # supervisorctl stop æœåŠ¡å é‡å¯æœåŠ¡ # supervisorctl restart æœåŠ¡å å¢åŠ æœåŠ¡ # vim /etc/supervisord.d/test.ini [program:test] #ç¨‹åºçš„åå­—ï¼Œåœ¨supervisorä¸­å¯ä»¥ç”¨è¿™ä¸ªåå­—æ¥ç®¡ç†è¯¥ç¨‹åºã€‚ directory = /root #ç›¸å½“äºåœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œç¨‹åº command = /root/1.sh #å¯åŠ¨ç¨‹åºçš„å‘½ä»¤ autorestart = true #æ˜¯å¦è‡ªåŠ¨é‡å¯ autostart = true #è®¾ç½®æ”¹ç¨‹åºæ˜¯å¦è™½supervisorçš„å¯åŠ¨è€Œå¯åŠ¨ startsecs = 5 é‡æ–°å¯åŠ¨æ—¶ï¼Œç­‰å¾…çš„æ—¶é—´ startretries = 3 #é‡å¯ç¨‹åºçš„æ¬¡æ•° user = root #æŒ‡å®šè¿è¡Œç”¨æˆ· redirect_stderr = true #æ˜¯å¦å°†ç¨‹åºé”™è¯¯ä¿¡æ¯é‡å®šå‘çš„åˆ°æ–‡ä»¶ stdout_logfile_backups = 10 stdout_logfile_maxbytes = 10MB stdout_logfile = /var/log/supervisord/ameRender.log environment = HOME=\u0026#34;/root\u0026#34;,USER=\u0026#34;root\u0026#34; minfds=81920 minprocs=81920 supervisorctl update "},{"id":49,"href":"/blog/linux/HkCTnskvV/","title":"error while loading shared libraries: libc.so.6: cannot open shared object file: No such file or directory","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä¸å°å¿ƒè¯¯åˆ libc.soçš„æ¢å¤æ–¹å¼\nå®‰è£…å®Œæˆå, å»ºç«‹è½¯é“¾æŒ‡å‘glibc-2.14, æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:\nrm -rf /lib64/libc.so.6 ln -s /opt/glibc-2.14/lib/libc-2.14.so /lib64/libc.so.6 æ³¨æ„ï¼šåˆ é™¤libc.so.6ä¹‹åå¯èƒ½å¯¼è‡´ç³»ç»Ÿå‘½ä»¤ä¸å¯ç”¨çš„æƒ…å†µ, å¯ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•è§£å†³:\n$ LD_PRELOAD=/opt/glibc-2.14/lib/libc-2.14.so ln -s /opt/glibc-2.14/lib/libc-2.14.so /lib64/libc.so.6 å¦‚æœä¸Šè¿°æ›´æ–°å¤±è´¥å¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿˜åŸ:\n$ LD_PRELOAD=/lib64/libc-2.12.so ln -s /lib64/libc-2.12.so /lib64/libc.so.6 // libc-2.12.so æ­¤é¡¹æ˜¯ç³»ç»Ÿå‡çº§å‰çš„ç‰ˆæœ¬ "},{"id":50,"href":"/blog/linux/rk-lmMGL4/","title":"yumé”™è¯¯:problem making ssl connection Trying other mirror","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" yumæ— æ³•ä½¿ç”¨å¸¦httpsçš„æº\nç¯å¢ƒ # yum install epel-release è¿è¡Œä»¥ä¸Šå‘½ä»¤ä¹‹åï¼Œå®‰è£…å…¶ä»–è½¯ä»¶å°±æŠ¥é”™ã€‚\né”™è¯¯æç¤º # [Errno 14] problem making ssl connection Trying other mirror. Trying other mirror Error: Cannot retrieve repository metadata (repomd.xml) for repository: xxxx. Please verify its path and try again ç»è¿‡googleæŸ¥è¯¢ï¼Œå‘ç°ä¼¼ä¹æ˜¯sslè¯ä¹¦çš„åŸå› ã€‚\nè§£å†³æ–¹æ³• # yum install ca-certificates yum update curl "},{"id":51,"href":"/blog/linux/H10_K-VQ4/","title":"CentOS7 php5.6 ç¼–è¯‘å®‰è£…amqpæ‰©å±•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" php å®‰è£…æœ€æ–°rabbitmqæ‰©å±•\n1ã€å®‰è£…ç¼–è¯‘ç¯å¢ƒ # yum install cmake gcc gcc-c++ make openssl-devel 2ã€å®‰è£…rabbitmq-c # wget https://github.com/alanxz/rabbitmq-c/archive/v0.9.0.zip unzip v0.9.0.zip cd rabbitmq-c-0.9.0/ cmake -DCMAKE_INSTALL_PREFIX=/usr/local/rabbitmq-c-0.9.0/ make \u0026amp;\u0026amp; make install 3ã€å®‰è£…amqp # wget http://pecl.php.net/get/amqp-1.9.4.tgz tar zxf amqp-1.9.4.tgz cd amqp-1.9.4 /usr/bin/phpize ./configure --with-php-config=/usr/bin/php-config --with-amqp --with-librabbitmq-dir=/usr/local/rabbitmq-c-0.9.0 #ç”±äºrabbitmq-cç¼–è¯‘å‡ºæ¥çš„libç›®å½•æ˜¯lib64ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšä¸€äº›å°çš„ä¿®æ”¹ vim Makefile #å°† AMQP_SHARED_LIBADD = -Wl,-rpath,/usr/local/rabbitmq-c-0.9.0/lib -L/usr/local/rabbitmq-c-0.9.0/lib -lrabbitmq #ä¿®æ”¹ä¸º AMQP_SHARED_LIBADD = -Wl,-rpath,/usr/local/rabbitmq-c-0.9.0/lib64 -L/usr/local/rabbitmq-c-0.9.0/lib64 -lrabbitmq make \u0026amp;\u0026amp; make install 4ã€php.ini æ·»åŠ æ¨¡å— # vi /usr/local/php/etc/php.ini #å¢åŠ  extension = /usr/lib64/php/modules/amqp.so 5ã€é‡å¯æœåŠ¡ # systemctl restart php-fpm "},{"id":52,"href":"/blog/linux/B11j0sF-N/","title":"è®°ä¸€æ¬¡æ—¶é—´åŒæ­¥å¼•èµ·çš„æ•…éšœ","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ntpdateåŒæ­¥æ—¶é—´ï¼Œæ—¶é—´è·³è·ƒï¼Œå¼•èµ·æœåŠ¡ä¸­æ–­ã€‚\nè®¡åˆ’ä»»åŠ¡ # 0 4 * * * /usr/sbin/ntpdate 10.200.3.71 æ—¥å¿— # Dec 30 04:00:01 localhost systemd: Created slice user-0.slice. Dec 30 04:00:01 localhost systemd: Starting user-0.slice. Dec 30 04:00:01 localhost systemd: Started Session 16 of user root. Dec 30 04:00:01 localhost systemd: Starting Session 16 of user root. Dec 29 20:09:59 localhost systemd: Time has been changed Dec 29 20:09:59 localhost systemd: Removed slice user-0.slice. Dec 29 20:09:59 localhost systemd: Stopping user-0.slice. æ•…éšœ # å› ä¸ºè·³è·ƒçš„æ—¶é—´å¤ªå¤§ï¼Œå¯¼è‡´ç³»ç»Ÿçš„å„ç§æœåŠ¡ä¸­æ–­ï¼ˆç½‘ç»œä¸­æ–­å’Œsystemctlç®¡ç†çš„æœåŠ¡ä¹Ÿæœ‰é—®é¢˜ï¼‰ã€‚\nè§£æ # ntpdateåŒæ­¥æ—¶é—´ï¼Œä¼šé€ æˆæ—¶é—´çš„è·³è·ƒï¼Œå¯¹ä¸€äº›ä¾èµ–æ—¶é—´çš„ç¨‹åºå’ŒæœåŠ¡ä¼šé€ æˆå½±å“ã€‚æ¯”å¦‚sleepï¼Œtimerç­‰ã€‚è€Œä¸”ï¼ŒntpdæœåŠ¡å¯ä»¥åœ¨ä¿®æ­£æ—¶é—´çš„åŒæ—¶ï¼Œä¿®æ­£cpu\ntickã€‚ç†æƒ³çš„åšæ³•ä¸ºï¼Œåœ¨å¼€æœºçš„æ—¶å€™ï¼Œä½¿ç”¨ntpdateå¼ºåˆ¶åŒæ­¥æ—¶é—´ï¼Œåœ¨å…¶ä»–æ—¶å€™ä½¿ç”¨ntpdæœåŠ¡æ¥åŒæ­¥æ—¶é—´ã€‚\nè¦æ³¨æ„çš„æ˜¯ï¼Œntpdæœ‰ä¸€ä¸ªè‡ªæˆ‘ä¿æŠ¤è®¾ç½®: å¦‚æœæœ¬æœºä¸ä¸Šæºæ—¶é—´ç›¸å·®å¤ªå¤§, ntpdä¸è¿è¡Œ. æ‰€ä»¥æ–°è®¾ç½®çš„æ—¶é—´æœåŠ¡å™¨ä¸€å®šè¦å…ˆntpdateä»ä¸Šæºå–å¾—æ—¶é—´åˆå€¼,\nç„¶åå¯åŠ¨ntpdæœåŠ¡ã€‚ntpdæœåŠ¡è¿è¡Œå, å…ˆæ˜¯æ¯éš”æŒ‡å®šçš„æ—¶é—´ä¸ä¸ŠæºæœåŠ¡å™¨åŒæ­¥ä¸€æ¬¡, æ ¹æ®æ¯æ¬¡åŒæ­¥æ—¶æµ‹å¾—çš„è¯¯å·®å€¼ç»å¤æ‚è®¡ç®—é€æ­¥è°ƒæ•´è‡ªå·±çš„æ—¶é—´,\néšç€è¯¯å·®å‡å°, é€æ­¥å¢åŠ åŒæ­¥çš„é—´éš”. æ¯æ¬¡è·³åŠ¨, éƒ½ä¼šé‡å¤è¿™ä¸ªè°ƒæ•´çš„è¿‡ç¨‹.\n"},{"id":53,"href":"/blog/linux/HJJ4wWwim/","title":"è§£å†³rabbitmqä¾èµ–é—®é¢˜","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" é”™è¯¯æç¤º # warning: rabbitmq-server-3.6.6-1.el6.noarch.rpm: Header V4 RSA/SHA1 Signature, key ID 6026dfca: NOKEYerror: Failed dependencies: erlang \u0026gt;= R16B-03 is needed by rabbitmq-server-3.6.6-1.el6.noarch socat is needed by rabbitmq-server-3.6.6-1.el6.noarch è§£å†³æ–¹æ³• # cd /etc/yum.repos.d/ cat erlang.repo [erlang-solutions] name=Centos $releasever - $basearch - Erlang Solutions baseurl=http://packages.erlang-solutions.com/rpm/centos/$releasever/$basearch gpgcheck=0 gpgkey=http://packages.erlang-solutions.com/debian/erlang_solutions.asc enabled=1 ç„¶åå†å®‰è£…rabbitmq\nyum localinstall rabbitmq-server-3.6.6-1.el6.noarch.rpm å…¶ä»–é—®é¢˜ # # /etc/init.d/rabbitmq-server start Starting rabbitmq-server: FAILED - check /var/log/rabbitmq/startup_{log, _err} rabbitmq-server. # vim /var/log/rabbitmq/startup_err init terminating in do_boot (noproc) Crash dump is being written to: erl_crash.dump...done å¦‚æœå‡ºç°ä»¥ä¸Šé—®é¢˜ï¼Œè¯´æ˜erlangå’Œrabbitmqçš„ç‰ˆæœ¬ä¸ç›¸ç¬¦ã€‚åªèƒ½é‡æ–°å®‰è£…erlangäº†ã€‚\n"},{"id":54,"href":"/blog/linux/SJyvgQAOm/","title":"Linux bash æå–æ–‡ä»¶åå’Œç›®å½•å","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" åœ¨Linux Bashä¸­åˆ†åˆ«ä½¿ç”¨basenameã€dirnameã€${}ï¼Œæå–æ–‡ä»¶åå’Œç›®å½•åã€‚\né€šè¿‡å˜é‡æ–¹å¼ # ${}ç”¨äºå­—ç¬¦ä¸²çš„è¯»å–ï¼Œæå–å’Œæ›¿æ¢åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨${} æå–å­—ç¬¦ä¸²\n1ã€æå–æ–‡ä»¶å # # file1=/dir1/dir2/file.txt # echo ${file1##*/} file.txt 2ã€æå–åç¼€ # # echo ${file1##*.} txt 3ã€æå–ä¸å¸¦åç¼€çš„æ–‡ä»¶å # # tmp=${file1##*/} # echo $tmp file.txt # echo ${tmp%.*} file 4ã€æå–ç›®å½• # # echo ${var%/*} /dir1/dir2 é€šè¿‡å‘½ä»¤ # ä½¿ç”¨æ–‡ä»¶ç›®å½•çš„ä¸“æœ‰å‘½ä»¤basenameå’Œdirname\n1ã€æå–æ–‡ä»¶å # # file2=/dir1/dir2/file2.txt # echo $(basename $file2) file2.txt 2ã€æå–ä¸å¸¦åç¼€çš„æ–‡ä»¶å # # echo $(basename $file2 .txt) file2 3ã€æå–ç›®å½• # # dirname $file2 /dir1/dir2 # echo $(dirname $file2) /dir1/dir2 "},{"id":55,"href":"/blog/ffmpeg/Bki3dANDX/","title":"ffmpeg 9:16å’Œ16:9äº’ç›¸è½¬æ¢","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" â€‹ä»Šå¤©æœé›†äº†ä¸€ä¸‹16:9å’Œ9:16ç›¸äº’è½¬æ¢çš„å‘½ä»¤ã€‚å°†å¤šä½™çš„éƒ¨åˆ†ç”¨æ¨¡ç³ŠèƒŒæ™¯å¡«å……ï¼Œæ„Ÿè§‰æ¯”ç›´æ¥åŠ é»‘è¾¹å¥½å¾ˆå¤šã€‚\n16:9è½¬9:16 # å‘½ä»¤ # ffmpeg -i input.mp4 -lavfi \u0026#34;[0:v]scale=256/81*iw:256/81*ih,boxblur=luma_radius=min(h\\,w)/40:luma_power=3:chroma_radius=min(cw\\,ch)/40:chroma_power=1[bg];[bg][0:v]overlay=(W-w)/2:(H-h)/2,setsar=1,crop=w=iw*81/256\u0026#34; output.mp4 9:16è½¬16:9 # å‘½ä»¤ # ffmpeg -i input.mp4 -lavfi \u0026#39;[0:v]scale=ih*16/9:-1,boxblur=luma_radius=min(h\\,w)/20:luma_power=1:chroma_radius=min(cw\\,ch)/20:chroma_power=1[bg];[bg][0:v]overlay=(W-w)/2:(H-h)/2,crop=h=iw*9/16\u0026#39; -vb 800K output.mp4 "},{"id":56,"href":"/blog/linux/ByaB7yPSQ/","title":"nginx auth_basicç™»å½•éªŒè¯é‡åˆ°çš„å‘","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" htpasswdé»˜è®¤ä½¿ç”¨crypt()åŠ å¯†ï¼Œåˆ›å»ºçš„å¯†ç åªæœ‰å‰8ä½æœ‰æ•ˆ\né—®é¢˜ # htpasswd -c /etc/nginx/.htpasswd test å‡å¦‚ï¼Œå¯†ç ä¸ºabcd12345\né‚£ä¹ˆåœ¨ç™»å½•çš„æ—¶å€™ï¼Œä¸ç®¡æ˜¯è¾“å…¥â€œabcd1234â€ã€â€abcd12345â€œæˆ–â€abcd123456789sdjkalâ€œ éƒ½èƒ½é€šè¿‡éªŒè¯ã€‚\nè§£æ # å› ä¸ºhtpasswdé»˜è®¤ä½¿ç”¨crypt()åŠ å¯†ï¼Œè€Œcrypt()åŠ å¯†åªæœ‰å‰é¢8ä½æœ‰æ•ˆã€‚\nè§£å†³æ–¹æ³• # htpasswd -m -c /etc/nginx/.htpasswd test åœ¨åˆ›å»ºè´¦å·çš„æ—¶å€™æŒ‡å®šâ€-mâ€œå‚æ•°ï¼Œä½¿ç”¨MD5åŠ å¯†å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚\n"},{"id":57,"href":"/blog/ffmpeg/SkuD1wO4X/","title":"ffmpegè¾“å‡ºè‹¹æœç¼–ç æ ¼å¼prores","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ffmpegè¾“å‡ºè‹¹æœç¼–ç æ ¼å¼proresã€‚åˆ†è¾¨ç‡1080pï¼Œ25å¸§ï¼Œ5ä¸ªéŸ³è½¨ã€‚\nffmpeg -i 06æ— å­—å¹•mp4-ä½¿ç”¨æ­¤è§†é¢‘çš„ç”»é¢.mp4 -i 06æœ‰å­—å¹•-ä½¿ç”¨æ­¤è§†é¢‘çš„å›½é™…éŸ³è½¨.mov -map 0:v -s 1920x1080 -r 25 -c:v prores_ks -profile:v 3 -pix_fmt yuv422p10le -map 1:1 -acodec pcm_s24le -ar 48000 -ac 1 -map 1:2 -acodec pcm_s24le -ar 48000 -ac 1 -map 1:3 -acodec pcm_s24le -ar 48000 -ac 1 -map 1:4 -acodec pcm_s24le -ar 48000 -ac 1 -map 1:5 -acodec pcm_s24le -ar 48000 -ac 1 06-out.mov "},{"id":58,"href":"/blog/ffmpeg/SJkrWTUVm/","title":"ffmbcè½¬ç è¾“å‡ºDVCPRO HD","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨ffmbcå¤šçº¿ç¨‹è½¬ç è¾“å‡ºDVCPRO HDã€‚åˆ†è¾¨ç‡ä¸º1440x1080ï¼Œéš”è¡Œæ‰«æã€‚\nä¸€ # å°†ä¸€ä¸ªåŒå£°é“éŸ³è½¨å¤åˆ¶è¾“å‡ºæˆä¸¤ä¸ªå•å£°é“éŸ³è½¨\nffmbc -y -threads 8 -i æµ·å¤–å‘è¡Œæµ‹è¯•æºæ–‡ä»¶0726.mp4 -target dvcprohd -tff -an æµ·å¤–å‘è¡Œæµ‹è¯•æºæ–‡ä»¶0726-out.mxf -acodec pcm_s24le -ar 48000 -ac 1 -newaudio -acodec pcm_s24le -ar 48000 -newaudio -acodec pcm_s24le -ar 48000 äºŒ # å°†ä¸€ä¸ªåŒå£°é“éŸ³è½¨å¤åˆ¶æ‹†åˆ†æˆä¸¤ä¸ªå·¦å³å•å£°é“éŸ³è½¨\nffmbc -y -threads 8 -i æµ·å¤–å‘è¡Œæµ‹è¯•æºæ–‡ä»¶0726.mp4 -target dvcprohd -tff -an æµ·å¤–å‘è¡Œæµ‹è¯•æºæ–‡ä»¶0726-out.mxf -acodec pcm_s24le -ar 48000 -newaudio -acodec pcm_s24le -ar 48000 -newaudio -map_audio_channel 0:1:0:0:1:0 -map_audio_channel 0:1:1:0:2:0 "},{"id":59,"href":"/blog/linux/HJlvWaG47/","title":"Nginxçš„connect() to xxx failed (13: Permission denied) å’Œ Nginx 403 forbidden","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" è§£å†³Nginxçš„connect() to xxx failed (13: Permission denied) å’Œ Nginx 403 forbidden é”™è¯¯\næŸ¥çœ‹SeLinuxçŠ¶æ€ # getenforce å¦‚æœæ˜¯enabledåˆ™ç»§ç»­å¾€ä¸‹çœ‹ã€‚\nä¸´æ—¶å…³é—­ï¼ˆä¸éœ€è¦é‡å¯æœºå™¨ï¼‰ # setenforce 0 ä¿®æ”¹é…ç½® # vim /etc/selinux/config #å°†SELINUX=enforcingæ”¹ä¸ºSELINUX=disabled å¦‚æœä½ æ‰§è¡Œäº†ä¸´æ—¶å…³é—­SeLinuxå¹¶æœºå™¨ä¸Šè·‘äº†é‡è¦çš„ä¸šåŠ¡ï¼Œé‚£å¯ä»¥ä¸éœ€è¦é©¬ä¸Šé‡å¯æœºå™¨ï¼Œç­‰å¾…ä¸‹æ¬¡é‡å¯é…ç½®ç”Ÿæ•ˆå³å¯ã€‚\n"},{"id":60,"href":"/blog/ffmpeg/Hy8NTRZmm/","title":"XDCAM HD422 MXF","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" åˆ†åˆ«ä½¿ç”¨ffmpeg ffmbc å®ç° è¾“å‡ºXDCAM HD422 MXFæ–‡ä»¶\nffmpeg # ffmpeg -i test.mov -pix_fmt yuv422p -vcodec mpeg2video -non_linear_quant 1 -flags +ildct+ilme -top 1 -dc 10 -intra_vlc 1 -qmax 3 -lmin \u0026#34;1*QP2LAMBDA\u0026#34; -vtag xd5c -rc_max_vbv_use 1 -rc_min_vbv_use 1 -g 12 -b:v 50000k -minrate 50000k -maxrate 50000k -bufsize 8000k -acodec pcm_s16le -ar 48000 -bf 2 -ac 2 -f mxf_d10 output.mxf ffmbc # ffmbc -y -threads 8 -i å…ˆå¯¼ç‰‡.mp4 -target xdcamhd422 -tff -acodec pcm_s24le å…ˆå¯¼ç‰‡-out.mov "},{"id":61,"href":"/blog/macos/BkHOYBUgX/","title":"mac os pkgè§£åŒ…","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" jdk1.8.pkgè§£åŒ…\næ¯æ¬¡å®‰è£…Javaçš„æ—¶å€™ï¼Œéƒ½æ˜¯ä¸€ä¸ªpkgå®‰è£…åŒ…ï¼Œæ²¡æœ‰åƒlinuxä¸‹ç›´æ¥ä¸€ä¸ªtaråŒ…é‚£æ ·ç»¿è‰²å’Œæ–¹ä¾¿ã€‚äºæ˜¯googleæœç´¢ä¸€ä¸‹ï¼Œç»ˆäºæ‰¾åˆ°è§£å†³çš„æ–¹æ³•äº†ã€‚\nxar -xf JDK\\ 8\\ Update\\ 171.pkg cat jdk180171.pkg/Payload | cpio -i æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œç„¶åå°†â€Contents/Homeâ€ æ‹·è´å‡ºæ¥å¹¶é‡å‘½åä¸ºjdk1.8ï¼Œå‰©ä¸‹çš„å°±å’Œlinuxä¸‹é…ç½®javaç¯å¢ƒä¸€æ ·çš„äº†ã€‚\n"},{"id":62,"href":"/blog/linux/rJY7U8E9U0z/","title":"centos7 rdate æ—¶é—´åŒæ­¥æœåŠ¡","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å®‰è£…è½¯ä»¶ # yum install -y xinetd rdate ä¿®æ”¹é…åˆ¶ # vim /etc/xinetd.d/time-stream # å°†disable = yes æ”¹ä¸º disable = no å¯åŠ¨æœåŠ¡ # # å¯åŠ¨xinetd systemctl start xinetd # æ·»åŠ å¼€å¯å¯åŠ¨ systemctl enable xinetd åŒæ­¥æ—¶é—´ # æœåŠ¡ç«¯ # é¦–å…ˆåœ¨æœåŠ¡ç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆåˆ°åº•å“ªä¸ªæ˜¯æœåŠ¡ç«¯å‘¢ï¼Ÿå°±æ˜¯ä½ åœ¨å“ªå°æœºå™¨ä¸Šé¢æ‰§è¡Œäº†ä»¥ä¸Šä¸‰ä¸ªæ­¥éª¤å°±æ˜¯æœåŠ¡ç«¯ï¼‰ï¼Œåœ¨æœåŠ¡ç«¯ä¸ŠåŒæ­¥ç½‘ç»œæ ‡å‡†æ—¶é—´ï¼Œç„¶åå†åŒæ­¥åˆ°å†…ç½‘å„å°æœºå™¨ä¸Šã€‚\n/usr/bin/rdate -s -u time.nist.gov å®¢æˆ·ç«¯ # å…¶ä»–å†…ç½‘éœ€è¦åŒæ­¥æ—¶é—´çš„æœºå™¨å¯ä»¥æ‰§è¡Œ\nyum install -y rdate /usr/bin/rdate -s æœåŠ¡ç«¯ip "},{"id":63,"href":"/blog/linux/rytGLI49LCf/","title":"centos7 ä¿®æ”¹å†…æ ¸å¼•å¯¼é¡ºåº","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" æŸ¥çœ‹å†…æ ¸ # cat /boot/grub2/grub.cfg |grep menuentry menuentry \u0026#39;CentOS Linux (3.10.0-327.36.3.el7.x86_64) 7 (Core)\u0026#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option \u0026#39;gnulinux-3.10.0-327.el7.x86_64-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97\u0026#39; { menuentry \u0026#39;CentOS Linux (3.10.0-327.22.2.el7.x86_64) 7 (Core)\u0026#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option \u0026#39;gnulinux-3.10.0-327.el7.x86_64-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97\u0026#39; { menuentry \u0026#39;CentOS Linux (3.10.0-327.el7.x86_64) 7 (Core)\u0026#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option \u0026#39;gnulinux-3.10.0-327.el7.x86_64-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97\u0026#39; { menuentry \u0026#39;CentOS Linux (0-rescue-7d26c16f128042a684ea474c9e2c240f) 7 (Core)\u0026#39; --class centos --class gnu-linux --class gnu --class os --unrestricted $menuentry_id_option \u0026#39;gnulinux-0-rescue-7d26c16f128042a684ea474c9e2c240f-advanced-80b9b662-0a1d-4e84-b07b-c1bf19e72d97\u0026#39; ä¿®æ”¹é»˜è®¤ # grub2-set-default \u0026#34;CentOS Linux (3.10.0-327.22.2.el7.x86_64) 7 (Core)\u0026#34; æŸ¥çœ‹ç”Ÿæ•ˆ # grub2-editenv list saved_entry=CentOS Linux (3.10.0-327.22.2.el7.x86_64) 7 (Core) "},{"id":64,"href":"/blog/linux/B1AMUL45ICM/","title":"Centos7æ­å»ºvpn","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å‡†å¤‡ç¯å¢ƒ # é¦–å…ˆæŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦æ”¯æŒpptpdæœåŠ¡ï¼š # modprobe ppp-compress-18 \u0026amp;\u0026amp; echo yes å®‰è£…ppp , pptpdï¼Œiptables # yum install -y ppp pptpd iptables systemctl mask firewalld systemctl stop firewalld ä¿®æ”¹é…åˆ¶ # vi /etc/pptpd.conf #æ‰¾åˆ°é…åˆ¶æ–‡ä»¶ä¸­é»˜è®¤çš„å€¼ï¼Œå»æ‰æ³¨é‡Šå³å¯ localip 192.168.0.1 #æœ¬æœºVPN IP remoteip 192.168.0.234-238,192.168.0.245 å®¢æˆ·ç«¯å¯ä»¥è·å–åˆ°çš„ipç½‘æ®µ #ä¿®æ”¹DNS vi /etc/ppp/options.pptpd #æœ«å°¾æ·»åŠ dns ms-dns 8.8.8.8 ms-dns 114.114.114.114 #æ·»åŠ vpnè´¦æˆ· vi /etc/ppp/chap-secrets # client server secret IP addresses user pptpd passwd * #å¼€å¯è·¯ç”±è½¬å‘ vi /etc/sysctl.conf net.ipv4.ip_forward = 1 #æ·»åŠ åœ¨é…åˆ¶æ–‡ä»¶çš„æœ«å°¾å³å¯ sysctl -p #è¿è¡Œè¿™ä¸ªå‘½ä»¤ä¼šè¾“å‡ºä¸Šé¢æ·»åŠ çš„é‚£ä¸€è¡Œä¿¡æ¯ï¼Œæ„æ€æ˜¯ä½¿å†…æ ¸ä¿®æ”¹ç”Ÿæ•ˆ #åœ¨é˜²ç«å¢™ä¸Šå¼€å¯natè½¬å‘ iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE #IPå’Œç½‘å£æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹å³å¯ å¼€å¯æœåŠ¡ # service iptables save systemctl restart iptables systemctl restart pptpd "},{"id":65,"href":"/blog/linux/rJFUIE5I0G/","title":"Centoså¤šç½‘å¡ç»‘å®š(bonding)","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å†…æ ¸æ¨¡å— # é€šè¿‡modinfo bondingå‘½ä»¤æŸ¥çœ‹Linuxæ˜¯å¦æ”¯æŒbonding\nlsmod |grep bonding #è½½å…¥bondingæ¨¡å— modprobe bonding é…ç½®bonding # # cat /etc/modprobe.d/bond0.conf alias bond0 bonding cd /etc/sysconfig/network-scripts/ # grep -v \u0026#34;^#\u0026#34; ifcfg-bond0 DEVICE=bond0 BOOTPROTO=static ONBOOT=yes IPADDR=192.168.5.88 NETMASK=255.255.255.0 GATEWAY=192.168.5.1 USERCTL=no ==================================================== BONDING_OPTS=\u0026#34;mode=0 miimon=100\u0026#34; è¯´æ˜ï¼šè¿™é‡Œä½¿ç”¨äº†BONDING_OPTSé€‰é¡¹ï¼Œåˆ™ä¸éœ€è¦å†ä½¿ç”¨ /etc/modprobe.d/bond0.conf é…ç½®æ–‡ä»¶å¯¹ç»‘å®šè®¾å¤‡è¿›è¡Œé…ç½®ã€‚å‚æ•°mode=0ï¼ŒæŒ‡è´Ÿè½½å‡è¡¡æ¨¡å¼ï¼Œè¯¦è§ä¸‹æ–‡ã€‚miimonæ˜¯ç”¨æ¥è¿›è¡Œé“¾è·¯ç›‘æµ‹çš„ï¼Œå…¶åŸç†æ˜¯æ£€æµ‹ç½‘ä¸Šçš„é“¾è·¯çŠ¶æ€ï¼Œä¸€èˆ¬å°†miimonå€¼è®¾ä¸º100ï¼Œè¡¨ç¤ºç³»ç»Ÿæ¯100msç›‘æµ‹ä¸€æ¬¡é“¾è·¯è¿æ¥çŠ¶æ€ï¼Œå¦‚æœæœ‰ä¸€æ¡çº¿è·¯ä¸é€šå°±è½¬å…¥å¦ä¸€æ¡çº¿è·¯ã€‚ ==================================================== # grep -v \u0026#34;^#\u0026#34; ifcfg-eth1 DEVICE=eth1 ONBOOT=yes BOOTPROTO=static MASTER=bond0 SLAVE=yes USERCTL=no # grep -v \u0026#34;^#\u0026#34; ifcfg-eth0 DEVICE=eth0 BOOTPROTO=static ONBOOT=yes MASTER=bond0 SLAVE=yes USERCTL=no æ³¨æ„ï¼šå»ºè®®ä¸è¦æŒ‡å®šMACåœ°å€ # echo 100 \u0026gt; /sys/class/net/bond0/bonding/miimon # echo 6 \u0026gt; /sys/class/net/bond0/bonding/mode Mode of operation : 0 for balance-rr, 1 for active-backup, 2 for balance-xorï¼› 3 for broadcast, 4 for 802.3ad, 5 for balance-tlb, 6 for balance-alb (charp) é‡å¯ç½‘ç»œ # /etc/init.d/network restart æ£€æŸ¥ä¸‹ ifconfig cat /proc/net/bonding/bond0 bondingæ¨¡å¼ # bondingçš„æ¨¡å¼ï¼š0-6ï¼Œå³ï¼š7ç§æ¨¡å¼\nç¬¬ä¸€ç§æ¨¡å¼ï¼š # mod=0 ï¼Œå³ï¼š(balance-rr) Round-robin policyï¼ˆå¹³è¡¡æŠ¡å¾ªç¯ç­–ç•¥ï¼‰\nç‰¹ç‚¹ï¼šä¼ è¾“æ•°æ®åŒ…é¡ºåºæ˜¯ä¾æ¬¡ä¼ è¾“ï¼ˆå³ï¼šç¬¬1ä¸ªåŒ…èµ°eth2ï¼Œä¸‹ä¸€ä¸ªåŒ…å°±èµ°eth3â€¦.ä¸€ç›´å¾ªç¯ä¸‹å»ï¼Œç›´åˆ°æœ€åä¸€ä¸ªä¼ è¾“å®Œæ¯•ï¼‰ï¼Œ\næ­¤æ¨¡å¼æä¾›è´Ÿè½½å¹³è¡¡å’Œå®¹é”™èƒ½åŠ›ï¼›ä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¦‚æœä¸€ä¸ªè¿æ¥æˆ–è€…ä¼šè¯çš„æ•°æ®åŒ…ä»ä¸åŒçš„æ¥å£å‘å‡ºçš„è¯ï¼Œä¸­é€”å†ç»è¿‡ä¸åŒçš„é“¾è·¯ï¼Œåœ¨å®¢æˆ·ç«¯å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°æ•°æ®åŒ…æ— åºåˆ°è¾¾çš„é—®é¢˜ï¼Œè€Œæ— åºåˆ°è¾¾çš„æ•°æ®åŒ…éœ€è¦é‡æ–°è¦æ±‚è¢«å‘é€ï¼Œè¿™æ ·ç½‘ç»œçš„ååé‡å°±ä¼šä¸‹é™\nç¬¬äºŒç§æ¨¡å¼ï¼š # mod=1ï¼Œå³ï¼š (active-backup) Active-backup policyï¼ˆä¸»-å¤‡ä»½ç­–ç•¥ï¼‰\nç‰¹ç‚¹ï¼šåªæœ‰ä¸€ä¸ªè®¾å¤‡å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå½“\nä¸€ä¸ªå®•æ‰å¦ä¸€ä¸ªé©¬ä¸Šç”±å¤‡ä»½è½¬æ¢ä¸ºä¸»è®¾å¤‡ã€‚macåœ°å€æ˜¯å¤–éƒ¨å¯è§å¾—ï¼Œä»å¤–é¢çœ‹æ¥ï¼Œbondçš„MACåœ°å€æ˜¯å”¯ä¸€çš„ï¼Œä»¥é¿å…switch(äº¤æ¢æœº)å‘ç”Ÿæ··ä¹±ã€‚æ­¤æ¨¡å¼åªæä¾›äº†å®¹é”™èƒ½åŠ›ï¼›ç”±æ­¤å¯è§æ­¤ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æä¾›é«˜ç½‘ç»œè¿æ¥çš„å¯ç”¨æ€§ï¼Œä½†æ˜¯å®ƒçš„èµ„æºåˆ©ç”¨ç‡è¾ƒä½ï¼Œåªæœ‰ä¸€ä¸ªæ¥å£å¤„äºå·¥ä½œçŠ¶æ€ï¼Œåœ¨æœ‰\nN ä¸ªç½‘ç»œæ¥å£çš„æƒ…å†µä¸‹ï¼Œèµ„æºåˆ©ç”¨ç‡ä¸º1/N\nç¬¬ä¸‰ç§æ¨¡å¼ï¼š # mod=2ï¼Œå³ï¼š(balance-xor) XOR policyï¼ˆå¹³è¡¡ç­–ç•¥ï¼‰\nç‰¹ç‚¹ï¼šåŸºäºæŒ‡å®šçš„ä¼ è¾“HASHç­–ç•¥ä¼ è¾“æ•°æ®åŒ…ã€‚ç¼ºçœçš„ç­–ç•¥æ˜¯ï¼š(æºMACåœ°å€ XOR ç›®æ ‡MACåœ°å€) %\nslaveæ•°é‡ã€‚å…¶ä»–çš„ä¼ è¾“ç­–ç•¥å¯ä»¥é€šè¿‡xmit_hash_policyé€‰é¡¹æŒ‡å®šï¼Œæ­¤æ¨¡å¼æä¾›è´Ÿè½½å¹³è¡¡å’Œå®¹é”™èƒ½åŠ›\nç¬¬å››ç§æ¨¡å¼ï¼š # mod=3ï¼Œå³ï¼šbroadcastï¼ˆå¹¿æ’­ç­–ç•¥ï¼‰ ç‰¹ç‚¹ï¼šåœ¨æ¯ä¸ªslaveæ¥å£ä¸Šä¼ è¾“æ¯ä¸ªæ•°æ®åŒ…ï¼Œæ­¤æ¨¡å¼æä¾›äº†å®¹é”™èƒ½åŠ›\nç¬¬äº”ç§æ¨¡å¼ï¼š # mod=4ï¼Œå³ï¼š(802.3ad) IEEE 802.3ad Dynamic link aggregationï¼ˆIEEE 802.3ad åŠ¨æ€é“¾æ¥èšåˆï¼‰\nç‰¹ç‚¹ï¼šåˆ›å»ºä¸€ä¸ªèšåˆç»„ï¼Œå®ƒä»¬å…±äº«åŒæ ·çš„é€Ÿç‡å’ŒåŒå·¥è®¾å®šã€‚æ ¹æ®802.3adè§„èŒƒå°†å¤šä¸ªslaveå·¥ä½œåœ¨åŒä¸€ä¸ªæ¿€æ´»çš„èšåˆä½“ä¸‹ã€‚\nå¤–å‡ºæµé‡çš„slaveé€‰ä¸¾æ˜¯åŸºäºä¼ è¾“hashç­–ç•¥ï¼Œè¯¥ç­–ç•¥å¯ä»¥é€šè¿‡xmit_hash_policyé€‰é¡¹ä»ç¼ºçœçš„XORç­–ç•¥æ”¹å˜åˆ°å…¶ä»–ç­–ç•¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä¼ è¾“ç­–ç•¥éƒ½æ˜¯802.3adé€‚åº”çš„ï¼Œå°¤å…¶è€ƒè™‘åˆ°åœ¨802.3adæ ‡å‡†43.2.4ç« èŠ‚æåŠçš„åŒ…ä¹±åºé—®é¢˜ã€‚ä¸åŒçš„å®ç°å¯èƒ½ä¼šæœ‰ä¸åŒçš„é€‚åº”æ€§ã€‚\nå¿…è¦æ¡ä»¶ï¼š\næ¡ä»¶1ï¼šethtoolæ”¯æŒè·å–æ¯ä¸ªslaveçš„é€Ÿç‡å’ŒåŒå·¥è®¾å®š\næ¡ä»¶2ï¼šswitch(äº¤æ¢æœº)æ”¯æŒIEEE 802.3ad Dynamic link aggregation\næ¡ä»¶3ï¼šå¤§å¤šæ•°switch(äº¤æ¢æœº)éœ€è¦ç»è¿‡ç‰¹å®šé…ç½®æ‰èƒ½æ”¯æŒ802.3adæ¨¡å¼\nç¬¬å…­ç§æ¨¡å¼ï¼š # mod=5ï¼Œå³ï¼š(balance-tlb) Adaptive transmit load balancingï¼ˆé€‚é…å™¨ä¼ è¾“è´Ÿè½½å‡è¡¡ï¼‰\nç‰¹ç‚¹ï¼šä¸éœ€è¦ä»»ä½•ç‰¹åˆ«çš„switch(äº¤æ¢æœº)æ”¯æŒçš„é€šé“bondingã€‚åœ¨æ¯ä¸ªslaveä¸Šæ ¹æ®å½“å‰çš„è´Ÿè½½ï¼ˆæ ¹æ®é€Ÿåº¦è®¡ç®—ï¼‰åˆ†é…å¤–å‡ºæµé‡ã€‚å¦‚æœæ­£åœ¨æ¥å—æ•°æ®çš„slaveå‡ºæ•…éšœäº†ï¼Œå¦ä¸€ä¸ªslaveæ¥ç®¡å¤±è´¥çš„slaveçš„MACåœ°å€ã€‚\nå¿…è¦æ¡ä»¶ï¼šethtoolæ”¯æŒè·å–æ¯ä¸ªslaveçš„é€Ÿç‡\nç¬¬ä¸ƒç§æ¨¡å¼ï¼š # mod=6ï¼Œå³ï¼š(balance-alb) Adaptive load balancingï¼ˆé€‚é…å™¨é€‚åº”æ€§è´Ÿè½½å‡è¡¡ï¼‰\nç‰¹ç‚¹ï¼š\nè¯¥æ¨¡å¼åŒ…å«äº†balance-tlbæ¨¡å¼ï¼ŒåŒæ—¶åŠ ä¸Šé’ˆå¯¹IPV4æµé‡çš„æ¥æ”¶è´Ÿè½½å‡è¡¡(receive load balance,\nrlb)ï¼Œè€Œä¸”ä¸éœ€è¦ä»»ä½•switch(äº¤æ¢æœº)çš„æ”¯æŒã€‚æ¥æ”¶è´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡ARPåå•†å®ç°çš„ã€‚\nbondingé©±åŠ¨æˆªè·æœ¬æœºå‘é€çš„ARPåº”ç­”ï¼Œå¹¶æŠŠæºç¡¬ä»¶åœ°å€æ”¹å†™ä¸ºbondä¸­æŸä¸ªslaveçš„å”¯ä¸€ç¡¬ä»¶åœ°å€ï¼Œä»è€Œä½¿å¾—ä¸åŒçš„å¯¹ç«¯ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€è¿›è¡Œé€šä¿¡ã€‚æ¥è‡ªæœåŠ¡å™¨ç«¯çš„æ¥æ”¶æµé‡ä¹Ÿä¼šè¢«å‡è¡¡ã€‚\nå½“æœ¬æœºå‘é€ARPè¯·æ±‚æ—¶ï¼Œbondingé©±åŠ¨æŠŠå¯¹ç«¯çš„IPä¿¡æ¯ä»ARPåŒ…ä¸­å¤åˆ¶å¹¶ä¿å­˜ä¸‹æ¥ã€‚å½“ARPåº”ç­”ä»å¯¹ç«¯åˆ°è¾¾æ—¶ï¼Œbondingé©±åŠ¨æŠŠå®ƒçš„ç¡¬ä»¶åœ°å€æå–å‡ºæ¥ï¼Œå¹¶å‘èµ·ä¸€ä¸ªARPåº”ç­”ç»™bondä¸­çš„æŸä¸ªslaveã€‚\nä½¿ç”¨ARPåå•†è¿›è¡Œè´Ÿè½½å‡è¡¡çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šæ¯æ¬¡å¹¿æ’­\nARPè¯·æ±‚æ—¶éƒ½ä¼šä½¿ç”¨bondçš„ç¡¬ä»¶åœ°å€ï¼Œå› æ­¤å¯¹ç«¯å­¦ä¹ åˆ°è¿™ä¸ªç¡¬ä»¶åœ°å€åï¼Œæ¥æ”¶æµé‡å°†ä¼šå…¨éƒ¨åˆ˜ç¿”å½“å‰çš„slaveã€‚\nè¿™ä¸ªé—®é¢˜é€šè¿‡ç»™æ‰€æœ‰çš„å¯¹ç«¯å‘é€æ›´æ–°ï¼ˆARPåº”ç­”ï¼‰æ¥è§£å†³ï¼Œåº”ç­”ä¸­åŒ…å«ä»–ä»¬ç‹¬ä¸€æ— äºŒçš„ç¡¬ä»¶åœ°å€ï¼Œä»è€Œå¯¼è‡´æµé‡é‡æ–°åˆ†å¸ƒã€‚å½“æ–°çš„slaveåŠ å…¥åˆ°bondä¸­æ—¶ï¼Œæˆ–è€…æŸä¸ªæœªæ¿€æ´»çš„slaveé‡æ–°æ¿€æ´»æ—¶ï¼Œæ¥æ”¶æµé‡ä¹Ÿè¦é‡æ–°åˆ†å¸ƒã€‚\næ¥æ”¶çš„è´Ÿè½½è¢«é¡ºåºåœ°åˆ†å¸ƒï¼ˆround\nrobinï¼‰åœ¨bondä¸­æœ€é«˜é€Ÿçš„slaveä¸Šå½“æŸä¸ªé“¾è·¯è¢«é‡æ–°æ¥ä¸Šï¼Œæˆ–è€…ä¸€ä¸ªæ–°çš„slaveåŠ å…¥åˆ°bondä¸­ï¼Œæ¥æ”¶æµé‡åœ¨æ‰€æœ‰å½“å‰æ¿€æ´»çš„slaveä¸­å…¨éƒ¨é‡æ–°åˆ†é…ï¼Œé€šè¿‡ä½¿ç”¨æŒ‡å®šçš„MACåœ°å€ç»™æ¯ä¸ª\nclientå‘èµ·ARPåº”ç­”ã€‚ä¸‹é¢ä»‹ç»çš„updelayå‚æ•°å¿…é¡»è¢«è®¾ç½®ä¸ºæŸä¸ªå¤§äºç­‰äºswitch(äº¤æ¢æœº)è½¬å‘å»¶æ—¶çš„å€¼ï¼Œä»è€Œä¿è¯å‘å¾€å¯¹ç«¯çš„ARPåº”ç­”ä¸ä¼šè¢«switch(äº¤æ¢æœº)é˜»æˆªã€‚\nå¿…è¦æ¡ä»¶ï¼š\næ¡ä»¶1ï¼šethtoolæ”¯æŒè·å–æ¯ä¸ªslaveçš„é€Ÿç‡ï¼›\næ¡ä»¶2ï¼šåº•å±‚é©±åŠ¨æ”¯æŒè®¾ç½®æŸä¸ªè®¾å¤‡çš„ç¡¬ä»¶åœ°å€ï¼Œä»è€Œä½¿å¾—æ€»æ˜¯æœ‰ä¸ªslave(curr_active_slave)ä½¿ç”¨bondçš„ç¡¬ä»¶åœ°å€ï¼ŒåŒæ—¶ä¿è¯æ¯ä¸ªbond\nä¸­çš„slaveéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç¡¬ä»¶åœ°å€ã€‚å¦‚æœcurr_active_slaveå‡ºæ•…éšœï¼Œå®ƒçš„ç¡¬ä»¶åœ°å€å°†ä¼šè¢«æ–°é€‰å‡ºæ¥çš„\ncurr_active_slaveæ¥ç®¡å…¶å®mod=6ä¸mod=0çš„åŒºåˆ«ï¼šmod=6ï¼Œå…ˆæŠŠeth2æµé‡å æ»¡ï¼Œå†å eth3ï¼Œâ€¦.ethXï¼›è€Œmod=0çš„è¯ï¼Œä¼šå‘ç°2ä¸ªå£çš„æµé‡éƒ½å¾ˆç¨³å®šï¼ŒåŸºæœ¬ä¸€æ ·çš„å¸¦å®½ã€‚è€Œmod=6ï¼Œä¼šå‘ç°ç¬¬ä¸€ä¸ªå£æµé‡å¾ˆé«˜ï¼Œç¬¬2ä¸ªå£åªå äº†å°éƒ¨åˆ†æµé‡\n"},{"id":66,"href":"/blog/linux/r1bIUL458Cz/","title":"centoså‡çº§ æ’é™¤ä¸æƒ³å‡çº§çš„è½¯ä»¶åŒ…","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" æ–¹æ³•ä¸€ # yum --exclude=\u0026#34;kernel*\u0026#34; update æ–¹æ³•äºŒ # cat /etc/yum.conf [main] ...... exclude=kernel* ä¿®æ”¹/etc/yum.confï¼Œåœ¨â€œ[main]â€çš„æœ€ååŠ ä¸Šâ€œexclude=kernel*â€å³å¯ã€‚\næ€»ç»“ # æ–¹æ³•ä¸€ä¸ºé›¶æ—¶çš„ï¼Œä¹Ÿå°±æ˜¯åªåœ¨å½“æ¬¡æœ‰æ•ˆï¼Œè€Œæ–¹æ³•äºŒä¸ºæ°¸ä¹…æœ‰æ•ˆã€‚å¯æ ¹æ®ä¸åŒæƒ…å†µé€‰æ‹©ã€‚\n"},{"id":67,"href":"/blog/ffmpeg/BkpKIL498RM/","title":"ffmbcä¹‹è½¬DVCPROHD","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"ffmbc -i xx.ts -vcodec dvvideo -flags +ildct+ilme -tff -pix_fmt yuv422p -vf scale=1440:1080:1 -acodec pcm_s16le -ar 48000 -ac 1 -y xx.mxf "},{"id":68,"href":"/blog/ffmpeg/Hy0UI8V9I0M/","title":"ffmpeg å¤šéŸ³è½¨æ··åˆæˆå¤šå£°é“","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨FFmpegåˆ¶ä½œå¤šå£°é“è§†é¢‘\nå°†8ä¸ªéŸ³è½¨æ··åˆæˆåŒå£°é“\nffmpeg -i input.mkv -filter_complex \u0026#34;[0:1][0:2][0:3][0:4][0:5][0:6][0:7][0:8] amerge=inputs=8\u0026#34; -c:a pcm_s16le output.mkv "},{"id":69,"href":"/blog/ffmpeg/B1mILV58AM/","title":"ffmpegè·å–display_picture_numberå¯¹åº”å¸§ä¿¡æ¯","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä½¿ç”¨æ–¹å¼ # ffmpeg -i input -vf \u0026#34;select=eq(n\\,15237)\u0026#34;,showinfo -an -f null /dev/null è¾“å‡ºç»“æœ # 15237ä¸ºdisplay_picture_number\n[Parsed_showinfo_1 @ 0x41ca760] n: 0 pts:54860400 pts_time:609.56 pos:427032896 fmt:yuv420p sar:1/1 s:1920x1080 i:T iskey:0 type:B checksum:A2FB0133 plane_checksum:[7E1FA1A9 3D005549 67BC0A32] mean:[92 127 134] stdev:[62.5 9.2 20.7] å‚æ•°è§£é‡Š # ### showinfo ### ä¸æ”¹å˜è¾“å…¥è€Œåœ¨è¡Œä¸­æ˜¾ç¤ºæ¯å¸§ä¿¡æ¯ã€‚ æ˜¾ç¤ºçš„ä¿¡æ¯ä»¥`key/value`çš„åºåˆ—å½¢å¼ç»™å‡º ä¸‹é¢æ˜¯å°†æ˜¾ç¤ºåœ¨è¾“å‡ºä¸­çš„å€¼ï¼š - n å¸§åºæ•°ï¼Œä»0å¼€å§‹è®¡æ•° - pts è¾“å…¥å¸§çš„æ—¶é—´æˆ³ï¼Œä»¥æ—¶åŸºä¸ºå•ä½ï¼Œæ—¶é—´ä¾èµ–äºè¾“å…¥ - pts_time æŒ‰ç§’è®¡çš„æ—¶é—´æˆ³ - pos è¾“å…¥å¸§åœ¨è¾“å…¥æµä¸­çš„åç§»å®šä½ï¼Œ-1è¡¨ç¤ºä¿¡æ¯ä¸å¯ç”¨å’Œ/æˆ–æ— æ„ä¹‰ï¼ˆä¾‹å¦‚åˆæˆè§†é¢‘ä¸­ï¼‰ - fmt åƒç´ æ ¼å¼å - sar è¾“å…¥å¸§çš„å®½é«˜æ¯”ï¼Œè¡¨ç¤ºä¸º`num/den`æ ¼å¼ - s è¾“å…¥å¸§å°ºå¯¸ï¼Œè¯­æ³•åŒäº[è§†é¢‘å°ºå¯¸ï¼ˆåˆ†è¾¨ç‡ï¼‰](ffmpeg-doc-cn-07.md#è§†é¢‘å°ºå¯¸ï¼ˆåˆ†è¾¨ç‡ï¼‰) - i äº¤é”™æ¨¡å¼ (\u0026#34;P\u0026#34;å¯¹åº” \u0026#34;é€è¡Œ\u0026#34;, \u0026#34;T\u0026#34; å¯¹åº”ä¸Šåœºä¼˜å…ˆ, \u0026#34;B\u0026#34;ä¸ºä¸‹åœºä¼˜å…ˆt) - iskey ä¸º1è¡¨ç¤ºæ˜¯å…³é”®å¸§ï¼Œ0åˆ™ä¸æ˜¯ - type è¾“å…¥å¸§å›¾ç‰‡ç±»å‹ (\u0026#34;I\u0026#34;å¯¹åº”Iå¸§, \u0026#34;P\u0026#34; å¯¹åº”På¸§, \u0026#34;B\u0026#34; å¯¹åº”Bå¸§,æˆ–è€… \u0026#34;?\u0026#34;å¯¹åº”æœªçŸ¥ç±»å‹).å‚è€ƒå®šä¹‰ä¸`libavutil/avutil.h`ä¸­çš„`av_get_picture_type_char`å‡½æ•°å’Œ` - checksum è¾“å…¥å¸§æ‰€æœ‰ä¿¡æ¯å†…å®¹çš„ Adler-32æ ¡éªŒå€¼ (ä»¥16è¿›åˆ¶è¾“å‡º) - plane_checksum è¾“å…¥å¸§æ‰€æœ‰ä¿¡æ¯å†…å®¹çš„ Adler-32æ ¡éªŒå€¼ (ä»¥16è¿›åˆ¶è¾“å‡º), ä»¥æ ¼å¼\u0026#34;[c0 c1 c2 c3]\u0026#34;æ˜¾ç¤º "},{"id":70,"href":"/blog/ffmpeg/BJDz88N580G/","title":"ffmpegé€è¡Œæ‰«æè½¬éš”è¡Œæ‰«æ","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å‘½ä»¤å‚æ•° # ffmpeg -i input -aspect 16:9 -c:v mpeg2video -b:v 4000k -minrate 4000k -maxrate 4000k -bufsize 2000k -dc 9 -flags +ilme+ildct -alternate_scan 1 -top 0 output å…¶å®ä¸»è¦çš„å°±æ˜¯å¦‚ä¸‹å‚æ•°ï¼š\n-flags +ilme+ildct -alternate_scan 1 -top 0 alternate_scanä½¿ç”¨éš”è¡Œè½¬ç ï¼Œtopä¸ä¸€èˆ¬æ²¡æœ‰ä»€ä¹ˆè¦æ±‚çš„è¯é ‚åœºä¼˜å…ˆå°±å¯ä»¥äº†ã€‚\néš”è¡Œè½¬é€è¡Œ # ffmpeg -i input -aspect 16:9 -c:v mpeg2video -b:v 4000k -minrate 4000k -maxrate 4000k -bufsize 2000k -dc 9 -deinterlace output æ·»åŠ ä¸€ä¸ªâ€œdeinterlaceâ€å³å¯ã€‚\n"},{"id":71,"href":"/blog/linux/HJi_UUE5ICG/","title":"linux bashæˆªå–å­—ç¬¦ä¸²çš„å‡ ç§æ–¹æ³•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" # å·æˆªå–ï¼Œåˆ é™¤å·¦è¾¹å­—ç¬¦ï¼Œä¿ç•™å³è¾¹å­—ç¬¦ # var=http://www.aaa.com/123.htm echo ${var#*//} å…¶ä¸­varæ˜¯å˜é‡åï¼Œ#å·æ˜¯è¿ç®—ç¬¦ï¼Œ å·æ˜¯é€šé…ç¬¦ï¼Œ//è¡¨ç¤ºä»å·¦è¾¹å¼€å§‹åˆ é™¤ç¬¬ä¸€ä¸ªåˆ°//å¤„çš„æ‰€æœ‰å­—ç¬¦å³åˆ é™¤http://\nç»“æœæ˜¯ ï¼šwww.aaa.com/123.htm\n## å·æˆªå–ï¼Œåˆ é™¤å·¦è¾¹å­—ç¬¦ï¼Œä¿ç•™å³è¾¹å­—ç¬¦ # var=http://www.aaa.com/123.htm echo ${var##*/} ##*/ è¡¨ç¤ºä»å·¦è¾¹å¼€å§‹åˆ é™¤æœ€åï¼ˆæœ€å³è¾¹ï¼‰ä¸€ä¸ª / å·åŠå·¦è¾¹çš„æ‰€æœ‰å­—ç¬¦å³åˆ é™¤ http://www.aaa.com/\nç»“æœæ˜¯ 123.htm\n% å·æˆªå–ï¼Œåˆ é™¤å³è¾¹å­—ç¬¦ï¼Œä¿ç•™å·¦è¾¹å­—ç¬¦ # var=http://www.aaa.com/123.htm echo ${var%/*} %/* è¡¨ç¤ºä»å³è¾¹å¼€å§‹ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ª / å·åŠå³è¾¹çš„å­—ç¬¦\nç»“æœæ˜¯ï¼šhttp://www.aaa.com\n%% å·æˆªå–ï¼Œåˆ é™¤å³è¾¹å­—ç¬¦ï¼Œä¿ç•™å·¦è¾¹å­—ç¬¦ # var=http://www.aaa.com/123.htm echo ${var%%/*} %%/* è¡¨ç¤ºä»å³è¾¹å¼€å§‹ï¼Œåˆ é™¤æœ€åï¼ˆæœ€å·¦è¾¹ï¼‰ä¸€ä¸ª / å·åŠå³è¾¹çš„å­—ç¬¦\nç»“æœæ˜¯ï¼šhttp:\n: å·æˆªå–ï¼Œä»å·¦è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼ŒåŠå­—ç¬¦çš„ä¸ªæ•° # var=http://www.aaa.com/123.htm echo ${var:0:5} å…¶ä¸­çš„ 0 è¡¨ç¤ºå·¦è¾¹ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹ï¼Œ5 è¡¨ç¤ºå­—ç¬¦çš„æ€»ä¸ªæ•°ã€‚\nç»“æœæ˜¯ï¼šhttp:\n: å·æˆªå–ï¼Œä»å·¦è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸ # var=http://www.aaa.com/123.htm echo ${var:7} å…¶ä¸­çš„ 7 è¡¨ç¤ºå·¦è¾¹ç¬¬8ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸã€‚\nç»“æœæ˜¯ ï¼šwww.aaa.com/123.htm\n: å·æˆªå–ï¼Œä»å³è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼ŒåŠå­—ç¬¦çš„ä¸ªæ•° # var=http://www.aaa.com/123.htm echo ${var:0-7:3} å…¶ä¸­çš„ 0-7 è¡¨ç¤ºå³è¾¹ç®—èµ·ç¬¬ä¸ƒä¸ªå­—ç¬¦å¼€å§‹ï¼Œ3 è¡¨ç¤ºå­—ç¬¦çš„ä¸ªæ•°ã€‚\nç»“æœæ˜¯ï¼š123\n: å·æˆªå–ï¼Œä»å³è¾¹ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸ # var=http://www.aaa.com/123.htm echo ${var:0-7} è¡¨ç¤ºä»å³è¾¹ç¬¬ä¸ƒä¸ªå­—ç¬¦å¼€å§‹ï¼Œä¸€ç›´åˆ°ç»“æŸã€‚\nç»“æœæ˜¯ï¼š123.htm\næ³¨ï¼šï¼ˆå·¦è¾¹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ç”¨ 0 è¡¨ç¤ºï¼Œå³è¾¹çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç”¨ 0-1 è¡¨ç¤ºï¼‰\n"},{"id":72,"href":"/blog/linux/rJvbIUV580z/","title":"linux crontabè®¡åˆ’ä»»åŠ¡è¯¦è§£","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" crontabå‘½ä»¤å¸¸è§äºUnixå’Œç±»Unixçš„æ“ä½œç³»ç»Ÿä¹‹ä¸­ï¼Œç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„æŒ‡ä»¤\né…ç½®æ–‡ä»¶ # cat /etc/crontab SHELL=/bin/bash è®¡åˆ’ä»»åŠ¡çš„é»˜è®¤è„šæœ¬bash shell PATH=/sbin:/bin:/usr/sbin:/usr/bin é»˜è®¤æœç´¢è·¯å¾„ MAILTO=root å½“è®¡åˆ’ä»»åŠ¡æœ‰æ ‡å‡†è¾“å‡ºæˆ–æ ‡å‡†é”™è¯¯è¾“å‡ºæ—¶ï¼Œä¼šå°†ç»“æœå‘é‚®ä»¶ç»™root HOME=/ # run-parts 01 * * * * root run-parts /etc/cron.hourly /etc/ åé¢ä¸€å®šæ˜¯ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯å°æ—¶æ‰§è¡Œ 02 4 * * * root run-parts /etc/cron.daily 22 4 * * 0 root run-parts /etc/cron.weekly 42 4 1 * * root run-parts /etc/cron.monthly æ³¨æ„äº‹é¡¹ # å¤šä¸ªè®¡åˆ’ä»»åŠ¡ä¸å®œåŒæ—¶è¿›è¡Œé˜²æ­¢æœ‰éæ³•è®¡åˆ’ä»»åŠ¡å‘¨å’Œæ—¥ï¼Œæœˆä¸å¯åŒæ—¶å¹¶å­˜ï¼Œå®¹æ˜“å¯¼è‡´è®¡åˆ’ä»»åŠ¡æ—¶é—´æ··ä¹±\nç®€è¦è¯´æ˜ # crond\næ˜¯linuxç”¨æ¥å®šæœŸæ‰§è¡Œç¨‹åºçš„å‘½ä»¤ã€‚å½“å®‰è£…å®Œæˆæ“ä½œç³»ç»Ÿä¹‹åï¼Œé»˜è®¤ä¾¿ä¼šå¯åŠ¨æ­¤ä»»åŠ¡è°ƒåº¦å‘½ä»¤ã€‚crondå‘½ä»¤æ¯åˆ†é”ºä¼šå®šæœŸæ£€æŸ¥æ˜¯å¦æœ‰è¦æ‰§è¡Œçš„å·¥ä½œï¼Œå¦‚æœæœ‰è¦æ‰§è¡Œçš„å·¥ä½œä¾¿ä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥å·¥ä½œã€‚è€Œlinuxä»»åŠ¡è°ƒåº¦çš„å·¥ä½œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š1ã€ç³»ç»Ÿæ‰§è¡Œçš„å·¥ä½œï¼šç³»ç»Ÿå‘¨æœŸæ€§æ‰€è¦æ‰§è¡Œçš„å·¥ä½œï¼Œå¦‚å¤‡ä»½ç³»ç»Ÿæ•°æ®ã€æ¸…ç†ç¼“å­˜ã€‚2ã€ä¸ªäººæ‰§è¡Œçš„å·¥ä½œï¼šæŸä¸ªç”¨æˆ·å®šæœŸè¦åšçš„å·¥ä½œï¼Œä¾‹å¦‚æ¯éš”10åˆ†é’Ÿæ£€æŸ¥é‚®ä»¶æœåŠ¡å™¨æ˜¯å¦æœ‰æ–°ä¿¡ï¼Œè¿™äº›å·¥ä½œå¯ç”±æ¯ä¸ªç”¨æˆ·è‡ªè¡Œè®¾ç½®\ncrontabæ˜¯UNIXç³»ç»Ÿä¸‹çš„å®šæ—¶ä»»åŠ¡è§¦å‘å™¨ï¼Œå…¶ä½¿ç”¨è€…çš„æƒé™è®°è½½åœ¨ä¸‹åˆ—ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼š\næ–‡ä»¶å«ä¹‰ # /etc/cron.deny è¯¥æ–‡ä»¶ä¸­æ‰€åˆ—çš„ç”¨æˆ·ä¸å…è®¸ä½¿ç”¨Crontabå‘½ä»¤\n/etc/cron.allow è¯¥æ–‡ä»¶ä¸­æ‰€åˆ—çš„ç”¨æˆ·å…è®¸ä½¿ç”¨Crontabå‘½ä»¤\n/var/spool/cron/ æ˜¯æ‰€æœ‰ç”¨æˆ·çš„crontabæ–‡ä»¶\n/var/spool/cron/crontabs /var/spool/cron/crontabs /etc/crontab ç³»ç»Ÿè®¡åˆ’ä»»åŠ¡åˆ—è¡¨æ–‡ä»¶\nCrontabå‘½ä»¤çš„æ ¼å¼ä¸ºï¼šcrontab â€“l|-r|-e|-i [username]ï¼Œå…¶å‚æ•°å«ä¹‰å¦‚è¡¨ä¸€ï¼š å‚æ•°åç§° å«ä¹‰ ç¤ºä¾‹ -l æ˜¾ç¤ºç”¨æˆ·çš„Crontabæ–‡ä»¶çš„å†…å®¹ crontabl â€“l -i åˆ é™¤ç”¨æˆ·çš„Crontabæ–‡ä»¶å‰ç»™æç¤º crontabl -ri -r ä»Crontabç›®å½•ä¸­åˆ é™¤ç”¨æˆ·çš„Crontabæ–‡ä»¶ crontabl -r -e ç¼–è¾‘ç”¨æˆ·çš„Crontabæ–‡ä»¶ crontabl -e åŸºæœ¬æ ¼å¼ # command \u0026lt;\u0026ndash;\u0026gt; åˆ†ã€€æ—¶ã€€æ—¥ã€€æœˆã€€å‘¨ã€€å‘½ä»¤ ç¬¬1åˆ—è¡¨ç¤ºåˆ†é’Ÿ1ï½59 æ¯åˆ†é’Ÿç”¨*æˆ–è€… */1è¡¨ç¤º\nç¬¬2åˆ—è¡¨ç¤ºå°æ—¶1ï½23ï¼ˆ0è¡¨ç¤º0ç‚¹ï¼‰\nç¬¬3åˆ—è¡¨ç¤ºæ—¥æœŸ1ï½31\nç¬¬4åˆ—è¡¨ç¤ºæœˆä»½1ï½12\nç¬¬5åˆ—æ ‡è¯†å·æ˜ŸæœŸ0ï½6ï¼ˆ0è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼‰\nç¬¬6åˆ—è¦è¿è¡Œçš„å‘½ä»¤\næ—¶é—´æ•°å€¼ç‰¹æ®Šè¡¨ç¤ºæ–¹æ³• # ï¼Š è¡¨ç¤ºè¯¥èŒƒå›´å†…çš„ä»»æ„æ—¶é—´ ï¼Œè¡¨ç¤ºé—´éš”çš„å¤šä¸ªä¸è¿ç»­æ—¶é—´ç‚¹\nï¼ è¡¨ç¤ºä¸€ä¸ªè¿ç»­çš„æ—¶é—´èŒƒå›´\n/n æŒ‡å®šé—´éš”çš„æ—¶é—´é¢‘ç‡\nå¸¸ç”¨ä¾‹å­ # #æ¯æ™šçš„21:30é‡å¯apache 30 21 * * * /usr/local/etc/rc.d/lighttpd restart #æ¯æœˆ1ã€10ã€22æ—¥çš„4 : 45é‡å¯apache 45 4 1,10,22 * * /usr/local/etc/rc.d/lighttpd restart #æ¯å‘¨å…­ã€å‘¨æ—¥çš„1 : 10é‡å¯apache 10 1 * * 6,0 /usr/local/etc/rc.d/lighttpd restart #æ¯å¤©18 : 00è‡³23 : 00ä¹‹é—´æ¯éš”30åˆ†é’Ÿé‡å¯apache 0,30 18-23 * * * /usr/local/etc/rc.d/lighttpd restart #æ¯ä¸ªæ˜ŸæœŸçš„æ˜ŸæœŸå…­çš„11 : 00 pmé‡å¯apache 0 23 * * 6 /usr/local/etc/rc.d/lighttpd restart #æ¯ä¸€å°æ—¶é‡å¯apache * */1 * * * /usr/local/etc/rc.d/lighttpd restart #æ¯å¤©çš„æ™šä¸Š11ç‚¹åˆ°æ—©ä¸Š7ç‚¹ä¹‹é—´ï¼Œæ¯éš”ä¸€å°æ—¶é‡å¯apache * 23-7/1 * * * /usr/local/etc/rc.d/lighttpd restart #æ¯æœˆçš„4å·ä¸æ¯å‘¨ä¸€åˆ°å‘¨ä¸‰çš„11ç‚¹é‡å¯apache 0 11 4 * mon-wed /usr/local/etc/rc.d/lighttpd restart #æ¯å¹´çš„ä¸€æœˆä¸€å·çš„4ç‚¹é‡å¯apache 0 4 1 jan * /usr/local/etc/rc.d/lighttpd restart "},{"id":73,"href":"/blog/linux/rJJe8UNcU0M/","title":"linux nfsé…ç½®åŠè®¿é—®æ§åˆ¶","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" NFSè½¯ä»¶åŒ… # nfs-utils portmap (rhel6æ¢æˆäº†rpcbind ,æ‰€ä»¥å¯åŠ¨æœåŠ¡æ—¶éœ€è¦æ³¨æ„)\nNFSæ–‡ä»¶ # /etc/exports #NFSä¸»é…ç½®æ–‡ä»¶ /etc/init.d/nfs #NFSå¯åŠ¨è„šæœ¬ /etc/init.d/protmap\n#portmapå¯åŠ¨è„šæœ¬ /var/lib/*tab #NFSæ—¥å¿—æ–‡ä»¶\nä¹¦å†™è§„åˆ™ # ç›®å½•å(ç»å¯¹è·¯å¾„) å®¢æˆ·ç«¯ä¸»æœºåã€IPæˆ–â€œ*â€(é€‰é¡¹) é€‰é¡¹å¯é€‰æ‹©å¦‚ä¸‹ï¼š\nsyncï¼šè®¾ç½®NFSæœåŠ¡å™¨åŒæ­¥å†™ç£ç›˜,è¿™æ ·ä¸ä¼šè½»æ˜“ä¸¢å¤±æ•°æ®,å»ºè®®æ‰€æœ‰çš„NFSå…±äº«ç›®å½•ä½¿ç”¨è¯¥é€‰é¡¹. roï¼šè®¾ç½®è¾“å‡ºçš„å…±äº«ç›®å½•ä¸ºåªè¯»ï¼Œä¸rwä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚\nrwï¼šè®¾ç½®è¾“å‡ºçš„å…±äº«ç›®å½•ä¸ºå¯è¯»å†™ï¼Œä¸roä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ root_squashï¼šrootç”¨æˆ·è®¿é—®å…±äº«ç›®å½•çš„èº«ä»½ä¼šè‡ªåŠ¨å˜æˆnobodyèº«ä»½ã€‚\nno_root_squashï¼šrootç”¨æˆ·ä¼šä»¥è‡ªå·±çš„çœŸå®èº«ä»½è®¿é—®å…±äº«ç›®å½•ï¼Œä¸å®‰å…¨ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚ æ›´å¤šé€‰é¡¹å¯åœ¨ç½‘ä¸ŠæŸ¥\nshowmount # showmountå‘½ä»¤ç”¨äºæŸ¥è¯¢æ˜¾ç¤ºNFSæœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯ æ˜¾ç¤ºNFSæœåŠ¡å™¨çš„è¾“å‡ºç›®å½•åˆ—è¡¨ æ˜¾ç¤ºå½“å‰æœ¬æœºä¸­NFSæœåŠ¡å™¨è¾“å‡ºåˆ—è¡¨\nshowmount -e æ˜¾ç¤ºæŒ‡ç‚¹NFSæœåŠ¡å™¨ä¸­çš„å…±äº«ç›®å½•åˆ—è¡¨\nshowmount -e IP é˜²ç«å¢™é…ç½® # nfsdï¼š2049 rhel5 portmapï¼š111 rhel6 rpcbindï¼š111\nrquotad,mountd,sratdå’Œlockdå¯ä»¥å¼ºåˆ¶ä½¿ç”¨ä¸€ä¸ªå¤§äº1024çš„é™æ€ç«¯å£\nä¿®æ”¹/etc/sysconfig/nfsæ–‡ä»¶ QUOTAD_PORT=40001 #rpc.quotadè¿›ç¨‹ç«¯å£ LOCKD_TCPPORT=40002 #rpc.lockdè¿›ç¨‹ç«¯å£ LOCKD_UDPPORT=40002 MOUNTD_PORT=40003 #rpc.mountdè¿›ç¨‹ç«¯å£ STARTD_PORT=40004 #rpc.sratdè¿›ç¨‹ç«¯å£ exportfs # ä¿®æ”¹äº†/etc/exportsæ–‡ä»¶ä¸éœ€è¦é‡å¯nfsï¼Œåªè¦é‡æ–°åŠ è½½/etc/exportsæ–‡ä»¶å³å¯ã€‚\n-aï¼šå…¨éƒ¨æŒ‚è½½ï¼ˆæˆ–å¸è½½ï¼‰/etc/exportsæ–‡ä»¶å†…çš„è®¾å®šã€‚\n-rï¼šé‡æ–°åŠ è½½/etc/exportsä¸­çš„è®¾ç½®ï¼Œæ­¤å¤–åŒæ­¥æ›´æ–°/etc/exportsåŠ/var/lib/nfs/xtabä¸­çš„å†…å®¹ã€‚\n-uï¼šå¸è½½æŸä¸€ç›®å½•ã€‚\n-vï¼šåœ¨exportæ—¶å°†å…±äº«çš„ç›®å½•æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚\nå¸¸ç”¨ç»„åˆ # exportfs -rv (é‡æ–°åŠ è½½é…ç½®å¹¶è¾“å‡ºå½“å‰å…±äº«çš„ç›®å½•)\nexportfs -auv (åœæ­¢å½“å‰ä¸»æœºä¸­NFSæœåŠ¡å™¨çš„æ‰€æœ‰è¾“å‡ºç›®å½•)\næœåŠ¡é…ç½® # vim /etc/exports /home/share 10.1.1.2(sync,rw) *(sync,ro) linuxä½¿ç”¨ # mount -t nfs ipåœ°å€:/home/share/ /mnt Windwosä½¿ç”¨ # Windows 7æˆ–Windows 2008æ”¯æŒNFSå®¢æˆ·ç«¯,NFSæœåŠ¡ç«¯åªæœ‰Windows Serverç‰ˆæœ¬æ”¯æŒ\nshowmount -e 10.1.1.1 mount \\\\10.1.1.1\\share Z: éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmount æŒ‚è½½ç‚¹å’ŒLinuxåŠUNIXæœ‰æ‰€ä¸åŒï¼Œä¸æ˜¯ä½¿ç”¨ä¸€ä¸ªç›®å½•ä½œä¸ºæŒ‚è½½ç‚¹ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªæœªè¢«ä½¿ç”¨çš„ç›˜ç¬¦ã€‚\n"},{"id":74,"href":"/blog/linux/SJ68UEcUCM/","title":"linux openssh å¸¸è§é—®é¢˜æ±‡æ€»","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" è½¯ä»¶åŒ…å\nopenssh-server openssh-clients\næœåŠ¡åï¼šsshd\næœåŠ¡ç«¯é…ç½®æ–‡ä»¶ï¼š/etc/ssh/sshd.config å®¢æˆ·ç«¯â€¦\nè½¯ä»¶åŒ…å # openssh-server openssh-clients\næœåŠ¡åï¼šsshd # æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ï¼š/etc/ssh/sshd.config å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ï¼š/etc/ssh/ssh.config\nå¯åŠ¨æœåŠ¡ # server sshd start æ–‡ä»¶è¯´æ˜ # ~/.ssh/known_hosts #å­˜æ”¾è®¿é—®è¿‡çš„æœåŠ¡å™¨çš„å…¬é’¥ ~/.ssh/authorized_keys #å­˜æ”¾éœ€è¦éªŒè¯çš„å®¢æˆ·æœºçš„å…¬é’¥ å¸¸è§é—®é¢˜ # 1ã€sshè®¿é—®æ…¢ # åŸå› ï¼šè®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ä¼šæŠŠæœåŠ¡å™¨çš„IPåœ°å€åå‘è§£æä¸ºåŸŸåï¼Œå¦‚æœæ— æ³•è§£æå°±ä¼šå¯¼è‡´ç™»é™†æ—¶å¾ˆæ…¢ã€‚ ä¸‹é¢å‡ ç§æ–¹æ³•éƒ½å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜\n1ã€æ¸…ç©º/etc/resolv.confæ–‡ä»¶ä¸­çš„nameserverè®°å½• 2ã€åœ¨å®¢æˆ·æœºçš„/etc/hostsæ–‡ä»¶ä¸­æ·»åŠ æœåŠ¡å™¨åŸŸåçš„è§£æè®°å½•\n3ã€ä¿®æ”¹å®¢æˆ·ç«¯çš„/etc/ssh/ssh.configæ–‡ä»¶ GSSAPLAuthentication no\n4ã€ä¿®æ”¹æœåŠ¡ç«¯çš„/etc/ssh/sshd.configæ–‡ä»¶ UserDNS no\n2ã€~/.sshæƒé™ # .sshç›®å½•å’Œä¸‹é¢çš„æ–‡ä»¶æƒé™ï¼Œç»„å’Œå…¶ä»–äººä¸èƒ½æœ‰wçš„æƒé™ è§£å†³æ–¹æ³•ï¼šé™ä½ç¬¬æœåŠ¡ç«¯çš„æƒé™æ£€æŸ¥\nvim /etc/ssh/sshd_config StrictModes no 3ã€ç¬¬ä¸€æ¬¡è®¿é—®sshserveræ—¶ä¸ç”¨è¾“å…¥yes # ssh -o StrictHostKeyChecking=no username@sshserver vim /etc/ssh/ssh.config StrictHostKeyChecking=no å…¬é’¥è®¤è¯ # ssh-keygen -t rsa #æŒ‡å®šrsaç®—æ³• åœ¨~/.ssh/ä¸‹ç”Ÿäº§ä¸¤ä¸ªæ–‡ä»¶ id_rsaç”¨æˆ·çš„ç§é’¥ id_rsa.pubç”¨æˆ·çš„å…¬é’¥ssh- copy-id -i ~/.ssh/id_rsa.pub username@sshserver scpä½¿ç”¨ # scp ç”¨æˆ·å@æœåŠ¡å™¨åœ°å€:æ–‡ä»¶ æœ¬åœ°è·¯å¾„ scp æœ¬åœ°æ–‡ä»¶ ç”¨æˆ·å@æœåŠ¡å™¨åœ°å€:ç›®æ ‡è·¯å¾„\nsftpä½¿ç”¨ # sftp ç”¨æˆ·å@æœåŠ¡å™¨åœ°å€\ntcp_wrappersè®¿é—®æ§åˆ¶ # æ£€æŸ¥æŸä¸ªæœåŠ¡æ˜¯å¦å—tcp_wrappersç®¡ç†æ”¯æŒ\nldd $(which sshd)|grep libwrap å…ˆæ£€æŸ¥/etc/hosts.allowç„¶åæ£€æŸ¥/etc/hosts.deny å¦‚æœä¸¤ä¸ªæ–‡ä»¶éƒ½æ²¡æœ‰åŒ¹é…çš„è§„åˆ™ï¼Œåˆ™æ”¾è¡Œã€‚\nsshd:all EXCEPT 192.168.0.0/255.255.255.0 å¯ä»¥ä½¿ç”¨allã€?ã€* é˜»æŒ¡æ‰€æœ‰ä½†æ’é™¤192.168.0.0ç½‘æ®µ\n"},{"id":75,"href":"/blog/linux/rkxlI845IAz/","title":"linux sambaé…ç½®åŠä¹±ç çš„è§£å†³æ–¹æ³•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ç®€è¦è¯´æ˜ # sambaï¼šè¿™ä¸ªè½¯ä½“ä¸»è¦æä¾›äº†SMBä¼ºæœå™¨æ‰€éœ€çš„å„é¡¹æœåŠ¡ç¨‹å¼(smbdåŠnmbd)ã€çš„æ–‡ä»¶æ¡£ã€ä»¥åŠå…¶ä»–ä¸SAMBAç›¸å…³çš„logrotateè®¾å®šæ¡£åŠå¼€æœºé¢„è®¾é€‰é¡¹æ¡£æ¡ˆç­‰ï¼›\nsamba-clientï¼šè¿™ä¸ªè½¯ä½“åˆ™æä¾›äº†å½“Linuxåšä¸ºSAMBA\nClientç«¯æ—¶ï¼Œæ‰€éœ€è¦çš„å·¥å…·æŒ‡ä»¤ï¼Œä¾‹å¦‚æŒ‚è½½SAMBAæ¡£æ¡ˆæ ¼å¼çš„mount.cifsã€å–å¾—ç±»ä¼¼ç½‘èŠ³ç›¸å…³æ ‘çŠ¶å›¾çš„smbtreeç­‰ç­‰ï¼›\nsamba-commonï¼šè¿™ä¸ªè½¯ä½“æä¾›çš„åˆ™æ˜¯ä¼ºæœå™¨ä¸ç”¨æˆ·ç«¯éƒ½ä¼šä½¿ç”¨åˆ°çš„èµ„æ–™ï¼ŒåŒ…æ‹¬SAMBAçš„ä¸»è¦è®¾å®šæ¡£(smb.conf)ã€è¯­æ³•æ£€éªŒæŒ‡ä»¤(testparm)ç­‰ç­‰ï¼›\n/var/lib/samba/private/{passdb.tdb,secrets.tdb}ï¼šç®¡ç†Sambaçš„ä½¿ç”¨è€…å¸å·/å¯†ç æ—¶ï¼Œä¼šç”¨åˆ°çš„èµ„æ–™åº“æ¡£æ¡ˆï¼›\næœåŠ¡é…ç½® # vim /etc/samba/smb.conf\n[share] path = /share //å…±äº«çš„ç›®å½• writable = yes //æ˜¯å¦å¯å†™ write list = test // testç”¨æˆ·å¯ä»¥è®¿é—®è¯¥å…±äº« è®¿é—®æ§åˆ¶ # max connections = æœ€å¤§è¿æ¥æ•° deadtime = æ–­æ‰è¿æ¥æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ã€0ä¸ºä¸é™åˆ¶ã€‘ hosts deny = IP ã€åŸŸåã€except hosts allow = IP ã€åŸŸåã€except ç”¨æˆ·æ§åˆ¶ # public = no #ä¸å…è®¸åŒ¿åç”¨æˆ·è®¿é—® browseable = no #éšè—ç›®å½• ï¼ˆçŸ¥é“ç›®å½•åŒæ ·å¯ä»¥è®¿é—®ï¼‰ valid users = ç”¨æˆ·æˆ–åˆ—è¡¨æˆ–@ç”¨æˆ·ç»„ writable = yes #å¯å†™ï¼ˆç›®å½•æœ¬èº«è¦å¯å†™ï¼‰ weite list = ç”¨æˆ·æˆ–åˆ—è¡¨æˆ–@ç”¨æˆ·ç»„ read only = yes #åªè¯»è®¾ç½® create mask = 0744 #æ§åˆ¶å®¢æˆ·æœºåˆ›å»ºæ–‡ä»¶çš„æƒé™ directory mask = 0744 # æ§åˆ¶å®¢æˆ·æœºåˆ›å»ºç›®å½•çš„æƒé™ å®‰å…¨çº§åˆ« # sambaæœåŠ¡å™¨çš„å®‰å…¨çº§åˆ«åˆ†ä¸º5ç§ï¼Œåˆ†åˆ«æ˜¯userã€shareã€serverã€domainå’Œadsã€‚\nåœ¨è®¾ç½®ä¸åŒçš„çº§åˆ«æ—¶ï¼ŒsambaæœåŠ¡å™¨è¿˜ä¼šä½¿ç”¨å£ä»¤æœåŠ¡å™¨å’ŒåŠ å¯†å£ä»¤ã€‚\n1ã€user â€”â€“å®¢æˆ·ç«¯è®¿é—®æœåŠ¡å™¨æ—¶éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œé€šè¿‡éªŒè¯åï¼Œæ‰èƒ½ä½¿ç”¨æœåŠ¡å™¨çš„å…±äº«èµ„æºã€‚æ­¤çº§åˆ«ä½¿ç”¨åŠ å¯†çš„æ–¹å¼ä¼ é€å¯†ç ã€‚\n2ã€share â€”â€“å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨æ—¶ä¸éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç \n3ã€server â€”â€“å®¢æˆ·ç«¯åœ¨è®¿é—®æ—¶åŒæ ·éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œä½†æ˜¯ï¼Œå¯†ç éªŒè¯éœ€è¦å¯†ç éªŒè¯æœåŠ¡å™¨æ¥è´Ÿè´£ã€‚\n4ã€domain â€”â€“é‡‡ç”¨åŸŸæ§åˆ¶å™¨å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯\n5ã€ads â€”â€“è‹¥sambaæœåŠ¡å™¨åŠ å…¥åˆ°Windowsæ´»åŠ¨ç›®å½•ä¸­ï¼Œåˆ™ä½¿ç”¨adså®‰å…¨çº§åˆ«ï¼Œadså®‰å…¨çº§åˆ«ä¹Ÿå¿…é¡»æŒ‡å®šå£ä»¤æœåŠ¡å™¨\nå¯åŠ¨æœåŠ¡ # service smb reload ç®¡ç†å·¥å…· # ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶åï¼Œå¯åŠ¨æœåŠ¡ï¼Œç„¶åæ·»åŠ Sambaç”¨æˆ·ï¼ˆpdbedit -a ç”¨æˆ·åï¼‰\nä½¿ç”¨pdbeditæŒ‡ä»¤åŠŸèƒ½ é€‰é¡¹ä¸å‚æ•°ï¼š\n-L ï¼šåˆ—å‡ºç›®å‰åœ¨èµ„æ–™åº“å½“ä¸­çš„å¸å·ä¸UID ç­‰ç›¸å…³èµ„è®¯ï¼›\n-v ï¼šéœ€è¦æ­é…-L æ¥æ‰§è¡Œï¼Œå¯åˆ—å‡ºæ›´å¤šçš„è®¯æ¯ï¼ŒåŒ…æ‹¬å®¶ç›®å½•ç­‰èµ„æ–™ï¼›\n-w ï¼šéœ€è¦æ­é…-L æ¥æ‰§è¡Œï¼Œä½¿ç”¨æ—§ç‰ˆçš„smbpasswd æ ¼å¼æ¥æ˜¾ç¤ºèµ„æ–™ï¼›\n-a ï¼šæ–°å¢ä¸€ä¸ªå¯ä½¿ç”¨Samba çš„å¸å·ï¼Œåé¢çš„å¸å·éœ€è¦åœ¨/etc/passwd å†…å­˜åœ¨è€…ï¼›\n-r ï¼šä¿®æ”¹ä¸€ä¸ªå¸å·çš„ç›¸å…³èµ„è®¯ï¼Œéœ€æ­é…å¾ˆå¤šç‰¹æ®Šå‚æ•°ï¼Œè¯·man pdbeditï¼›\n-x ï¼šåˆ é™¤ä¸€ä¸ªå¯ä½¿ç”¨Samba çš„å¸å·ï¼Œå¯å…ˆç”¨-L æ‰¾åˆ°å¸å·åå†åˆ é™¤ï¼›\n-m ï¼šåé¢æ¥çš„æ˜¯æœºå™¨çš„ä»£ç (machine account)ï¼Œä¸domain model æœ‰å…³ï¼\nä¹±ç é—®é¢˜ # cat /etc/sysconfig/i18n [global] # å¦‚æœlocaleæ˜¯zh_CN.UTF-8ï¼Œåšå¦‚ä¸‹è®¾ç½®ï¼š display charset = UTF-8 unix charset = UTF-8 dos charset = UTF-8 # å¦‚æœlocaleæ˜¯zh_CN.GBKæˆ–zh_CN.gb2312ï¼Œåšå¦‚ä¸‹è®¾ç½®ï¼š display charset = cp936 unix charset = cp936 dos charset = cp936 linuxè®¿é—® # smbclient //IP/ç›®å½•å -U ç™»å½•ç”¨æˆ·å mount -t cifs -o username=ç”¨æˆ·å,passwd=å¯†ç ,iocharset=gb2312,uid,pid,rw //ip æŒ‚è½½ç‚¹ smbtar -s server -u user -p passwd -x sharename -t output.tar windowsè®¿é—® # windowsè®¿é—®æ–¹å¼å°±ä¸è¯´äº†ã€‚ä¸‹é¢è¯´ä¸‹æ¸…é™¤windowså…±äº«è®¿é—®æ–¹æ³•ï¼š\næ‰“å¼€cmd. c:\\\u0026gt;net use * /del "},{"id":76,"href":"/blog/linux/B1muLLNcIRf/","title":"Linux Screenå‘½ä»¤","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"Linux screen å‘½ä»¤ç”¨äºå¤šé‡è§†çª—ç®¡ç†ç¨‹åºã€‚\nscreen ä¸ºå¤šé‡è§†çª—ç®¡ç†ç¨‹åºã€‚æ­¤å¤„æ‰€è°“çš„è§†çª—ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå…¨å±å¹•çš„æ–‡å­—æ¨¡å¼ç”»é¢ã€‚é€šå¸¸åªæœ‰åœ¨ä½¿ç”¨ telnet ç™»å…¥ä¸»æœºæˆ–æ˜¯ä½¿ç”¨è€å¼çš„ç»ˆç«¯æœºæ—¶ï¼Œæ‰æœ‰å¯èƒ½ç”¨åˆ° screen ç¨‹åºã€‚\nè¯­æ³• # screen [-AmRvx -ls -wipe][-d \u0026lt;ä½œä¸šåç§°\u0026gt;][-h \u0026lt;è¡Œæ•°\u0026gt;][-r \u0026lt;ä½œä¸šåç§°\u0026gt;][-s \u0026lt;shell\u0026gt;][-S \u0026lt;ä½œä¸šåç§°\u0026gt;] å‚æ•°è¯´æ˜ï¼š\n-A å°†æ‰€æœ‰çš„è§†çª—éƒ½è°ƒæ•´ä¸ºç›®å‰ç»ˆç«¯æœºçš„å¤§å°ã€‚ -d \u0026lt;ä½œä¸šåç§°\u0026gt; å°†æŒ‡å®šçš„ screen ä½œä¸šç¦»çº¿ã€‚ -h \u0026lt;è¡Œæ•°\u0026gt; æŒ‡å®šè§†çª—çš„ç¼“å†²åŒºè¡Œæ•°ã€‚ -m å³ä½¿ç›®å‰å·²åœ¨ä½œä¸šä¸­çš„ screen ä½œä¸šï¼Œä»å¼ºåˆ¶å»ºç«‹æ–°çš„ screen ä½œä¸šã€‚ -r \u0026lt;ä½œä¸šåç§°\u0026gt; æ¢å¤ç¦»çº¿çš„ screen ä½œä¸šã€‚ -R å…ˆè¯•å›¾æ¢å¤ç¦»çº¿çš„ä½œä¸šã€‚è‹¥æ‰¾ä¸åˆ°ç¦»çº¿çš„ä½œä¸šï¼Œå³å»ºç«‹æ–°çš„ screen ä½œä¸šã€‚ -s æŒ‡å®šå»ºç«‹æ–°è§†çª—æ—¶ï¼Œæ‰€è¦æ‰§è¡Œçš„ shellã€‚ -S \u0026lt;ä½œä¸šåç§°\u0026gt; æŒ‡å®š screen ä½œä¸šçš„åç§°ã€‚ -v æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ -x æ¢å¤ä¹‹å‰ç¦»çº¿çš„ screen ä½œä¸šã€‚ -ls æˆ– \u0026ndash;list æ˜¾ç¤ºç›®å‰æ‰€æœ‰çš„ screen ä½œä¸šã€‚ -wipe æ£€æŸ¥ç›®å‰æ‰€æœ‰çš„ screen ä½œä¸šï¼Œå¹¶åˆ é™¤å·²ç»æ— æ³•ä½¿ç”¨çš„ screen ä½œä¸šã€‚ å®ä¾‹ # åˆ›å»º screen ç»ˆç«¯\nscreen //åˆ›å»º screen ç»ˆç«¯ åˆ›å»º screen ç»ˆç«¯ å¹¶æ‰§è¡Œä»»åŠ¡\nscreen vi ~/main.c //åˆ›å»º screen ç»ˆç«¯ ï¼Œå¹¶æ‰§è¡Œ viå‘½ä»¤ ç¦»å¼€ screen ç»ˆç«¯\nscreen vi ~/main.c //åˆ›å»º screen ç»ˆç«¯ ï¼Œå¹¶æ‰§è¡Œ viå‘½ä»¤ #include main () { } \u0026#34;~/mail.c\u0026#34; 0,0-1 åœ¨ screen ç»ˆç«¯ ä¸‹ æŒ‰ä¸‹ Ctrl+a dé”® é‡æ–°è¿æ¥ç¦»å¼€çš„ screen ç»ˆç«¯\nscreen -ls # æ˜¾ç¤ºå·²åˆ›å»ºçš„screenç»ˆç«¯ There are screens on: 2433.pts-3.linuxÂ (2013å¹´10æœˆ20æ—¥ 16æ—¶48åˆ†59ç§’)Â (Detached) 2428.pts-3.linuxÂ (2013å¹´10æœˆ20æ—¥ 16æ—¶48åˆ†05ç§’)Â (Detached) 2284.pts-3.linuxÂ (2013å¹´10æœˆ20æ—¥ 16æ—¶14åˆ†55ç§’)Â (Detached) 2276.pts-3.linuxÂ (2013å¹´10æœˆ20æ—¥ 16æ—¶13åˆ†18ç§’)Â (Detached) 4 Sockets in /var/run/screen/S-root. screen -r 2276 //è¿æ¥ screen_id ä¸º 2276 çš„ screenç»ˆç«¯ "},{"id":77,"href":"/blog/linux/HyYg884c80f/","title":"linux é˜²å¾¡SYNæ”»å‡»","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" ä¸€ã€é»˜è®¤syné…ç½® # sysctl -a | grep _syn net.ipv4.tcp_max_syn_backlog = 1024 net.ipv4.tcp_syncookies = 1 net.ipv4.tcp_synack_retries = 5 net.ipv4.tcp_syn_retries = 5 tcp_max_syn_backlog æ˜¯SYNé˜Ÿåˆ—çš„é•¿åº¦ï¼ŒåŠ å¤§SYNé˜Ÿåˆ—é•¿åº¦å¯ä»¥å®¹çº³æ›´å¤šç­‰å¾…è¿æ¥çš„ç½‘ç»œè¿æ¥æ•°ã€‚\ntcp_syncookiesæ˜¯ä¸€ä¸ªå¼€å…³ï¼Œæ˜¯å¦æ‰“å¼€SYN Cookie åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½å¯ä»¥é˜²æ­¢éƒ¨åˆ†SYNæ”»å‡»ã€‚\ntcp_synack_retrieså’Œtcp_syn_retrieså®šä¹‰SYN çš„é‡è¯•è¿æ¥æ¬¡æ•°ï¼Œå°†é»˜è®¤çš„å‚æ•°å‡å°æ¥æ§åˆ¶SYNè¿æ¥æ¬¡æ•°çš„å°½é‡å°‘ã€‚\näºŒã€ä¿®æ”¹syné…ç½® # ulimit -HSn 65535 sysctl -w net.ipv4.tcp_max_syn_backlog=2048 sysctl -w net.ipv4.tcp_syncookies=1 sysctl -w net.ipv4.tcp_synack_retries=2 sysctl -w net.ipv4.tcp_syn_retries=2 ä¸‰ã€æ·»åŠ é˜²ç«å¢™è§„åˆ™ # #Syn æ´ªæ°´æ”»å‡»(--limit 1/s é™åˆ¶synå¹¶å‘æ•°æ¯ç§’1æ¬¡) iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT #é˜²ç«¯å£æ‰«æ iptables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT #é˜²æ´ªæ°´ping iptables -A FORWARD -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT å››ã€æ·»åŠ å¼€æœºå¯åŠ¨ # æœ€ååˆ«å¿˜è®°å°†äºŒã€ä¸‰ã€é‡Œé¢çš„å‘½ä»¤å†™åˆ°/etc/rc.d/rc.local\n"},{"id":78,"href":"/blog/linux/S13z8UE5UCf/","title":"linuxå†…å­˜æ¸…ç†é‡Šæ”¾å‘½ä»¤","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å‘½ä»¤ # sync echo 1 \u0026gt; /proc/sys/vm/drop_caches echo 2 \u0026gt; /proc/sys/vm/drop_caches echo 3 \u0026gt; /proc/sys/vm/drop_caches è§£é‡Š # cacheé‡Šæ”¾ï¼š To free pagecache: echo 1 \u0026gt; /proc/sys/vm/drop_caches To free dentries and inodes: echo 2 \u0026gt; /proc/sys/vm/drop_caches To free pagecache, dentries and inodes: echo 3 \u0026gt; /proc/sys/vm/drop_caches è¯´æ˜ # é‡Šæ”¾å‰æœ€å¥½syncä¸€ä¸‹ï¼Œé˜²æ­¢ä¸¢æ•°æ®ã€‚\n"},{"id":79,"href":"/blog/linux/B1FO88V580M/","title":"Linuxæ¸…é™¤å†…å­˜","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å¦‚ä½•åœ¨ Linux ä¸­æ¸…é™¤ç¼“å­˜ï¼ˆCacheï¼‰ï¼Ÿ # æ¯ä¸ª Linux ç³»ç»Ÿæœ‰ä¸‰ç§é€‰é¡¹æ¥æ¸…é™¤ç¼“å­˜è€Œä¸éœ€è¦ä¸­æ–­ä»»ä½•è¿›ç¨‹æˆ–æœåŠ¡ã€‚\nï¼ˆLCTT è¯‘æ³¨ï¼šCacheï¼Œè¯‘ä½œâ€œç¼“å­˜â€ï¼ŒæŒ‡ CPU\nå’Œå†…å­˜ä¹‹é—´é«˜é€Ÿç¼“å­˜ã€‚Bufferï¼Œè¯‘ä½œâ€œç¼“å†²åŒºâ€ï¼ŒæŒ‡åœ¨å†™å…¥ç£ç›˜å‰çš„å­˜å‚¨å†å†…å­˜ä¸­çš„å†…å®¹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼ŒBuffer å’Œ Cache æœ‰æ—¶å€™ä¼šé€šæŒ‡ã€‚ï¼‰\nä»…æ¸…é™¤é¡µé¢ç¼“å­˜ï¼ˆPageCacheï¼‰ # sync; echo 1 \u0026gt; /proc/sys/vm/drop_caches æ¸…é™¤ç›®å½•é¡¹å’Œinode # sync; echo 2 \u0026gt; /proc/sys/vm/drop_caches æ¸…é™¤é¡µé¢ç¼“å­˜ï¼Œç›®å½•é¡¹å’Œinode # sync; echo 3 \u0026gt; /proc/sys/vm/drop_caches ä¸Šè¿°å‘½ä»¤çš„è¯´æ˜ï¼š\nsync\nå°†åˆ·æ–°æ–‡ä»¶ç³»ç»Ÿç¼“å†²åŒºï¼ˆbufferï¼‰ï¼Œå‘½ä»¤é€šè¿‡â€œ;â€åˆ†éš”ï¼Œé¡ºåºæ‰§è¡Œï¼Œshellåœ¨æ‰§è¡Œåºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå‘½ä»¤ä¹‹å‰ä¼šç­‰å¾…å‘½ä»¤çš„ç»ˆæ­¢ã€‚æ­£å¦‚å†…æ ¸æ–‡æ¡£ä¸­æåˆ°çš„ï¼Œå†™å…¥åˆ°drop_cacheå°†æ¸…ç©ºç¼“å­˜è€Œä¸ä¼šæ€æ­»ä»»ä½•åº”ç”¨ç¨‹åº/æœåŠ¡ï¼Œechoå‘½ä»¤åšå†™å…¥æ–‡ä»¶çš„å·¥ä½œã€‚\nå¦‚æœä½ å¿…é¡»æ¸…é™¤ç£ç›˜é«˜é€Ÿç¼“å­˜ï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤åœ¨ä¼ä¸šå’Œç”Ÿäº§ç¯å¢ƒä¸­æ˜¯æœ€å®‰å…¨ï¼Œâ€â€¦echo 1\u0026gt; â€¦â€œåªä¼šæ¸…é™¤é¡µé¢ç¼“å­˜ã€‚\nåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸å»ºè®®ä½¿ç”¨ä¸Šé¢çš„ç¬¬ä¸‰ä¸ªé€‰é¡¹â€â€¦echo 3 \u0026gt; â€¦â€ ï¼Œé™¤éä½ æ˜ç¡®è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œå› ä¸ºå®ƒä¼šæ¸…é™¤ç¼“å­˜é¡µï¼Œç›®å½•é¡¹å’Œinodesã€‚\n"},{"id":80,"href":"/blog/macos/H1JGLLVcL0G/","title":"MacOS 10.12 è§£å†³æ‰¾ä¸åˆ°ä»»ä½•æ¥æºè®¾ç½®","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å®‰è£…ç¬¬ä¸‰æ–¹è½¯ä»¶å¿…å¤‡æŠ€èƒ½\næ‰“å¼€ç»ˆç«¯ ( ç»ˆç«¯åœ¨ åº”ç”¨ç¨‹åº - å®ç”¨å·¥å…·å†… )\nè¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶å›è½¦\nsudo spctl --master-disable ç„¶åæŸ¥çœ‹é—®é¢˜æ˜¯å¦è§£å†³ï¼Œ åå¥½è®¾ç½®-\u0026gt;å®‰å…¨æ€§ä¸éšç§-\u0026gt;é€šç”¨-\u0026gt;ä»»ä½•æ¥æº\n"},{"id":81,"href":"/blog/linux/Sky_LU458CM/","title":"mediainfoè·å–tsæ–‡ä»¶å¤§å°å’Œä¿¡æ¯ä¸å‡†ç¡®ï¼ˆMPEG-TSï¼šæ£€æµ‹æ–‡ä»¶çš„åºåˆ—ï¼‰çš„è§£å†³åŠæ³•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" è§£å†³mediainfoè·å–tsåª’ä½“ä¿¡æ¯ä¸å‡†ç¡®é—®é¢˜\nåœºæ™¯ # åœ¨/opt/ç›®å½•ä¸‹æ€»å…±æœ‰200å¤šä¸ªæ–‡ä»¶æ–‡ä»¶ååˆ†åˆ«å¦‚ä¸‹ï¼š\n/opt/2017LPLå¤å­£èµ›ç¬¬01é›†.ts\n/opt/2017LPLå¤å­£èµ›ç¬¬02é›†.ts\n/opt/2017LPLå¤å­£èµ›ç¬¬03é›†.ts\nâ€¦\n/opt/2017LPLå¤å­£èµ›ç¬¬227é›†.ts\n/opt/2017LPLå¤å­£èµ›ç¬¬228é›†.ts\né”™è¯¯ç»“æœ # mediainfo /opt/2017LPLå¤å­£èµ›ç¬¬01é›†.ts General ID : 1 (0x1) Complete name : Z:\\vrs\\new_upload\\2018-01-16\\2017LPLå¤å­£èµ›ç¬¬01é›†.ts CompleteName_Last : Z:\\vrs\\new_upload\\2018-01-16\\2017LPLå¤å­£èµ›ç¬¬228é›†.ts Format : MPEG-TS File size : 560 GiB Duration : 53mn 32s Overall bit rate mode : Constant Overall bit rate : 1 496 Mbps Video ID : 100 (0x64) Menu ID : 1 (0x1) Format : AVC Format/Info : Advanced Video Codec Format profile : High@L4.0 Format settings, CABAC : No Format settings, ReFrames : 2 frames Codec ID : 27 Duration : 53mn 32s Bit rate mode : Constant Bit rate : 1 422 Mbps Nominal bit rate : 7 800 Kbps / 7 800 Kbps Width : 1 920 pixels Height : 1 080 pixels Display aspect ratio : 16:9 Frame rate : 25.000 fps Color space : YUV Chroma subsampling : 4:2:0 Bit depth : 8 bits Scan type : Progressive Bits/(Pixel*Frame) : 27.431 Stream size : 532 GiB (95%) Writing library : x264 core 148 r2705 3f5ed56 Encoding settings : cabac=0 / ref=2 / deblock=1:0:0 / analyse=0x3:0x13 / me=hex / subme=7 / psy=1 / psy_rd=1.00:0.00 / mixed_ref=1 / me_range=16 / chroma_me=1 / trellis=1 / 8x8dct=1 / cqm=0 / deadzone=21,11 / fast_pskip=1 / chroma_qp_offset=-2 / threads=34 / lookahead_threads=5 / sliced_threads=0 / nr=0 / decimate=1 / interlaced=0 / bluray_compat=0 / constrained_intra=0 / bframes=3 / b_pyramid=0 / b_adapt=1 / b_bias=0 / direct=1 / weightb=1 / open_gop=0 / weightp=1 / keyint=32 / keyint_min=16 / scenecut=40 / intra_refresh=0 / rc_lookahead=32 / rc=cbr / mbtree=1 / bitrate=7800 / ratetol=1.0 / qcomp=0.60 / qpmin=0 / qpmax=69 / qpstep=4 / vbv_maxrate=7800 / vbv_bufsize=1560 / nal_hrd=cbr / filler=1 / ip_ratio=1.40 / aq=1:1.00 Audio ID : 101 (0x65) Menu ID : 1 (0x1) Format : MPEG Audio Format version : Version 1 Format profile : Layer 2 Codec ID : 3 Duration : 53mn 32s Bit rate mode : Constant Bit rate : 96.0 Kbps Channel(s) : 2 channels Sampling rate : 48.0 KHz Compression mode : Lossy Delay relative to video : -10ms Stream size : 36.8 MiB (0%) Menu ID : 4096 (0x1000) Menu ID : 1 (0x1) Duration : 53mn 32s List : 100 (0x64) (AVC) / 101 (0x65) (MPEG Audio) Service name : RM_SERVICE_01 Service provider : RealMagic Service type : digital television æ­£ç¡®ç»“æœ # mediainfo /opt/2017LPLå¤å­£èµ›ç¬¬01é›†.ts General ID : 1 (0x1) Complete name : /data/stb/product/vrs/new_upload/./2018-01-16/2017LPLå¤å­£èµ›ç¬¬01é›†.ts Format : MPEG-TS File size : 2.58 GiB Duration : 43mn 42s Overall bit rate mode : Constant Overall bit rate : 8 464 Kbps Video ID : 100 (0x64) Menu ID : 1 (0x1) Format : AVC Format/Info : Advanced Video Codec Format profile : High@L4.0 Format settings, CABAC : No Format settings, ReFrames : 2 frames Codec ID : 27 Duration : 43mn 42s Bit rate mode : Constant Bit rate : 7 800 Kbps / 7 800 Kbps Width : 1 920 pixels Height : 1 080 pixels Display aspect ratio : 16:9 Frame rate : 25.000 fps Color space : YUV Chroma subsampling : 4:2:0 Bit depth : 8 bits Scan type : Progressive Bits/(Pixel*Frame) : 0.150 Stream size : 2.43 GiB (94%) Writing library : x264 core 148 r2705 3f5ed56 Encoding settings : cabac=0 / ref=2 / deblock=1:0:0 / analyse=0x3:0x13 / me=hex / subme=7 / psy=1 / psy_rd=1.00:0.00 / mixed_ref=1 / me_range=16 / chroma_me=1 / trellis=1 / 8x8dct=1 / cqm=0 / deadzone=21,11 / fast_pskip=1 / chroma_qp_offset=-2 / threads=34 / lookahead_threads=5 / sliced_threads=0 / nr=0 / decimate=1 / interlaced=0 / bluray_compat=0 / constrained_intra=0 / bframes=3 / b_pyramid=0 / b_adapt=1 / b_bias=0 / direct=1 / weightb=1 / open_gop=0 / weightp=1 / keyint=32 / keyint_min=16 / scenecut=40 / intra_refresh=0 / rc_lookahead=32 / rc=cbr / mbtree=1 / bitrate=7800 / ratetol=1.0 / qcomp=0.60 / qpmin=0 / qpmax=69 / qpstep=4 / vbv_maxrate=7800 / vbv_bufsize=1560 / nal_hrd=cbr / filler=1 / ip_ratio=1.40 / aq=1:1.00 Audio ID : 101 (0x65) Menu ID : 1 (0x1) Format : MPEG Audio Format version : Version 1 Format profile : Layer 2 Codec ID : 3 Duration : 43mn 42s Bit rate mode : Constant Bit rate : 96.0 Kbps Channel(s) : 2 channels Sampling rate : 48.0 KHz Compression mode : Lossy Delay relative to video : -10ms Stream size : 30.0 MiB (1%) Menu ID : 4096 (0x1000) Menu ID : 1 (0x1) Duration : 43mn 42s List : 100 (0x64) (AVC) / 101 (0x65) (MPEG Audio) Service name : RM_SERVICE_01 Service provider : RealMagic Service type : digital television è§£å†³åŠæ³• # æ ¹æ®ä½œè€…çš„githubä¸Šæäº¤çš„ä»£ç æè¿°\nhttps://github.com/MediaArea/MediaInfoLib/commit/78f739893c85d4b1397276ef15badd160907b7aa\nvim \u0026#34;Source/MediaInfo/Multiple/File_MpegTs.cpp\u0026#34; void File_MpegTs::Streams_Accept() { ... if (!IsSub) { ... //TestContinuousFileNames(); ... } } æˆ‘ä»¬åªè¦å°†â€TestContinuousFileNames();â€œè¿™è¡Œæ³¨é‡Šæ‰å³å¯è§£å†³é»˜è®¤è·å–tsæ–‡ä»¶åºåˆ—é—®é¢˜\n"},{"id":82,"href":"/blog/linux/ByS8884qI0M/","title":"nginx+php+ThinkPHPç¯å¢ƒå¸¸è§é”™è¯¯æ€»ç»“","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" é”™è¯¯ä¸€\n2017/09/07 16:39:18 [error] 21753#0: *26 FastCGI sent in stderr: â€œPrimary sâ€¦\né”™è¯¯ä¸€ # 2017/09/07 16:39:18 [error] 21753#0: *26 FastCGI sent in stderr: \u0026#34;Primary script unknown\u0026#34; while reading response header from upstream, client: 172.31.26.114, server: localhost, request: \u0026#34;GET /1.php HTTP/1.1\u0026#34;, upstream: \u0026#34;fastcgi://127.0.0.1:9000\u0026#34;, host: \u0026#34;10.200.8.220:8000\u0026#34; è§£å†³ç‰ˆæœ¬ # åœ¨serverèŠ‚ç‚¹ä¸‹æ·»åŠ ä»¥ä¸‹é…ç½®\nroot /var/www/web; index index.php index.html index.htm; location ~ \\.php$ { try_files $uri = 404; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi.conf; } ThinkPHPé…ç½® # å‡å¦‚ç½‘ç«™çš„æ ¹ç›®å½•æ˜¯/var/www/webï¼Œå¦‚æœThinkPHPçš„ç½‘ç«™åœ¨/var/www/web/Testç›®å½•é…ç½®å¦‚ä¸‹\nlocation /Test/ { if (!-e $request_filename){ rewrite ^/Test/(.*)$ /Test/index.php?s=$1 last; } } location ~ \\.php/?.*$ { try_files $uri = 404; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi.conf; #è®¾ç½®PATH_INFOå¹¶æ”¹å†™SCRIPT_FILENAME,SCRIPT_NAMEæœåŠ¡å™¨ç¯å¢ƒå˜é‡ #set $fastcgi_script_name2 $fastcgi_script_name; #if ($fastcgi_script_name ~ \u0026#34;^(.+\\.php)(/.+)$\u0026#34;) { # set $fastcgi_script_name2 $1; # set $path_info $2; #} #fastcgi_param PATH_INFO $path_info; #fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name2; #fastcgi_param SCRIPT_NAME $fastcgi_script_name2; } å¦‚æœæ˜¯æ”¾åœ¨æ ¹ç›®å½•ä¸‹\nlocation / { if (!-e $request_filename){ rewrite ^/(.*)$ /index.php?s=$1 last; } } location ~ \\.php/?.*$ { try_files $uri = 404; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi.conf; #è®¾ç½®PATH_INFOå¹¶æ”¹å†™SCRIPT_FILENAME,SCRIPT_NAMEæœåŠ¡å™¨ç¯å¢ƒå˜é‡ #set $fastcgi_script_name2 $fastcgi_script_name; #if ($fastcgi_script_name ~ \u0026#34;^(.+\\.php)(/.+)$\u0026#34;) { # set $fastcgi_script_name2 $1; # set $path_info $2; #} #fastcgi_param PATH_INFO $path_info; #fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name2; #fastcgi_param SCRIPT_NAME $fastcgi_script_name2; } æœ€åæ¥ä¸ªå®Œæ•´çš„ä¾‹å­\nuser root; worker_processes auto; #error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; #pid logs/nginx.pid; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; server { listen 80; server_name localhost; root /var/www/web; index index.php index.html index.htm; location / { index index.htm index.html index.php; } location /Test/ { if (!-e $request_filename){ rewrite ^/Test/(.*)$ /Test/index.php?s=$1 last; } } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } location ~ \\.php/?.*$ { try_files $uri = 404; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi.conf; #è®¾ç½®PATH_INFOå¹¶æ”¹å†™SCRIPT_FILENAME,SCRIPT_NAMEæœåŠ¡å™¨ç¯å¢ƒå˜é‡ #set $fastcgi_script_name2 $fastcgi_script_name; #if ($fastcgi_script_name ~ \u0026#34;^(.+\\.php)(/.+)$\u0026#34;) { # set $fastcgi_script_name2 $1; # set $path_info $2; #} #fastcgi_param PATH_INFO $path_info; #fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name2; #fastcgi_param SCRIPT_NAME $fastcgi_script_name2; } } } "},{"id":83,"href":"/blog/linux/rykY88V58CG/","title":"nignxä¿®æ”¹æœ€å¤§ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"location / { root html; index index.html index.htm; client_max_body_size 1000m; } â€œclient_max_body_sizeâ€è®¾ç½®ä¸€ä¸‹ä¸Šä¼ çš„æœ€å¤§ä¸Šé™,ç„¶åé‡å¯nginxå³å¯ã€‚\n"},{"id":84,"href":"/blog/linux/HybPILE5U0z/","title":"RabbitMQ ä¸‰ç§ Exchange æ¨¡å¼","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"RabbitMQ ä¸­çš„ Exchangeï¼ˆäº¤æ¢æœºï¼‰è´Ÿè´£æ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®ç±»å‹å°†æ¶ˆæ¯è·¯ç”±åˆ°ç›¸åº”çš„é˜Ÿåˆ—ã€‚å¸¸è§çš„ä¸‰ç§ Exchange ç±»å‹å¦‚ä¸‹ï¼š\n1. Direct Exchangeï¼ˆç›´è¿æ¨¡å¼ï¼‰ # âœ… ç‰¹ç‚¹ï¼š # æ ¹æ®æ¶ˆæ¯çš„ routing key ç²¾ç¡®åŒ¹é…ï¼Œå°†æ¶ˆæ¯è·¯ç”±åˆ°ç»‘å®šäº† ç›¸åŒ routing key çš„é˜Ÿåˆ—ã€‚ ğŸ¯ é€‚ç”¨åœºæ™¯ï¼š # ä¸€å¯¹ä¸€æ¶ˆæ¯ä¼ é€’ã€‚ å¤šä¸ªé˜Ÿåˆ—åˆ†åˆ«è®¢é˜…ä¸åŒçš„æ¶ˆæ¯ç±»å‹ã€‚ ğŸ“Œ ç¤ºä¾‹ï¼š # ç»‘å®šæƒ…å†µï¼š\nQueue A ç»‘å®š routing keyï¼šerror Queue B ç»‘å®š routing keyï¼šinfo å‘é€æ¶ˆæ¯ï¼š\nProducer å‘é€æ¶ˆæ¯ï¼Œrouting key ä¸º error ç»“æœï¼š\nåªæœ‰ Queue A ä¼šæ¥æ”¶åˆ°è¯¥æ¶ˆæ¯ã€‚ 2. Fanout Exchangeï¼ˆå¹¿æ’­æ¨¡å¼ï¼‰ # âœ… ç‰¹ç‚¹ï¼š # å¿½ç•¥ routing keyã€‚ æ‰€æœ‰ç»‘å®šåˆ°è¯¥ Exchange çš„é˜Ÿåˆ—éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚ ğŸ¯ é€‚ç”¨åœºæ™¯ï¼š # å¹¿æ’­åœºæ™¯ï¼Œä¾‹å¦‚ç³»ç»Ÿé€šçŸ¥ã€ç¾¤å‘æ¶ˆæ¯ã€‚ ğŸ“Œ ç¤ºä¾‹ï¼š # ç»‘å®šæƒ…å†µï¼š\nQueue Aã€Queue B éƒ½ç»‘å®šåˆ°åŒä¸€ä¸ª fanout Exchange å‘é€æ¶ˆæ¯ï¼š\nProducer å‘é€ä»»æ„æ¶ˆæ¯ï¼ˆrouting key æ— æ•ˆï¼‰ ç»“æœï¼š\nQueue A å’Œ Queue B éƒ½ä¼šæ¥æ”¶åˆ°è¯¥æ¶ˆæ¯ã€‚ 3. Topic Exchangeï¼ˆä¸»é¢˜æ¨¡å¼ï¼‰ # âœ… ç‰¹ç‚¹ï¼š # æ”¯æŒ é€šé…ç¬¦ åŒ¹é… routing keyï¼š *ï¼šåŒ¹é…ä¸€ä¸ªå•è¯ï¼ˆä»¥ . åˆ†éš”ï¼‰ #ï¼šåŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå•è¯ ğŸ¯ é€‚ç”¨åœºæ™¯ï¼š # çµæ´»çš„è®¢é˜…æœºåˆ¶ï¼Œå¦‚æ—¥å¿—ç³»ç»Ÿã€æ–°é—»æ¨é€ç­‰ã€‚ ğŸ“Œ ç¤ºä¾‹ï¼š # ç»‘å®šæƒ…å†µï¼š\nQueue A ç»‘å®š routing keyï¼š*.error Queue B ç»‘å®š routing keyï¼šlog.# å‘é€æ¶ˆæ¯ï¼š\nProducer å‘é€ routing keyï¼šapp.error â†’ Queue A æ¥æ”¶ Producer å‘é€ routing keyï¼šlog.system.info â†’ Queue B æ¥æ”¶ ğŸ§¾ æ¨¡å¼å¯¹æ¯”è¡¨ # Exchange ç±»å‹ Routing Key æ˜¯å¦å‚ä¸è·¯ç”± åŒ¹é…æ–¹å¼ å…¸å‹åº”ç”¨åœºæ™¯ Direct âœ… æ˜¯ ç²¾ç¡®åŒ¹é… ç²¾å‡†è·¯ç”±ï¼Œåˆ†ç±»æ¶ˆæ¯ Fanout âŒ å¦ å¹¿æ’­ ç³»ç»Ÿé€šçŸ¥ï¼Œå…¨å‘˜æ¨é€ Topic âœ… æ˜¯ é€šé…ç¬¦åŒ¹é…ï¼ˆ*/#ï¼‰ æ—¥å¿—è®¢é˜…ï¼Œäº‹ä»¶åˆ†å‘ "},{"id":85,"href":"/blog/linux/HkXeLI4cIAG/","title":"rabbitmq æ¶ˆæ¯é˜Ÿåˆ—å®‰è£…å’Œé…ç½®","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" erlang # é¦–å…ˆå®‰è£…erlangè¯­è¨€ç¯å¢ƒ\nyum install erlang -y rabbitMQ # rabbitMQä¸‹è½½åœ°å€ï¼šç›´è¾¾å®‰è£…æ–¹æ³•:\nrpm -ivh --force --nodeps rabbitmq-server-3.6.0-1.noarch.rpm æˆ–è€… yum localinstall rabbitmq-server-3.6.0-1.noarch.rpm -y å¯åŠ¨æœåŠ¡ # /etc/init.d/rabbitmq-server start rabbitmq-plugins enable rabbitmq_management é…ç½®ä¸»å¤‡ # åŒæ­¥cookie # chmod 777 /var/lib/rabbitmq/.erlang.cookie scp /var/lib/rabbitmq/.erlang.cookie Go02:/var/lib/rabbitmq/.erlang.cookie chmod 400 /var/lib/rabbitmq/.erlang.cookie æ·»åŠ èŠ‚ç‚¹ # rabbitmqctl stop_app rabbitmqctl reset rabbitmqctl join_cluster [--ram] rabbit@Go01 //æ­¤å¤„çš„Go01ä¸ºä¸»èŠ‚ç‚¹çš„hostname,éœ€è¦åœ¨/etc/hostsä¸­æŒ‡å®š rabbitmqctl start_app åˆ é™¤èŠ‚ç‚¹ # rabbitmqctl stop_app rabbitmqctl forget_cluster_node rabbit@rabbit1 ä¿®æ”¹ç±»å‹ # rabbitmqctl stop_app rabbitmqctl change_cluster_node_type ram rabbitmqctl start_app æ·»åŠ ç”¨æˆ· # rabbitmqctl add_user admin admin # æ·»åŠ æƒé™: rabbitmqctl set_permissions -p \u0026#34;/\u0026#34; admin \u0026#34;.*\u0026#34; \u0026#34;.*\u0026#34; \u0026#34;.*\u0026#34; # åˆ é™¤æµ‹è¯•ç”¨æˆ·: rabbitmqctl delete_user guest # èµ‹äºˆå…¶administratorè§’è‰²ï¼š rabbitmqctl set_user_tags admin administrator # ä¿®æ”¹å¯†ç ï¼š rabbitmqctl change_password admin \u0026#39;12341234\u0026#39; ä¿®æ”¹é…ç½® # //é˜²æ­¢æœåŠ¡ç«¯å¼‚å¸¸ä¸­æ–­æ¢å¤åé•œåƒé˜Ÿåˆ—ä¸èƒ½æ¢å¤çš„é—®é¢˜ vim /etc/rabbitmq/rabbitmq.conf [ {rabbit,[{tcp_listeners,[5672]}, {cluster_partition_handling, autoheal}]} ]. #ä¸è¦å¿˜è®°æœ€åé¢çš„é‚£ä¸ªç‚¹å·å“¦ï¼ ç¯å¢ƒå˜é‡ # touch /etc/rabbitmq/rabbitmq-env.conf#è¾“å…¥ RABBITMQ_NODENAME=FZTEC-240088 èŠ‚ç‚¹åç§° RABBITMQ_NODE_IP_ADDRESS=127.0.0.1 ç›‘å¬IP RABBITMQ_NODE_PORT=5672 ç›‘å¬ç«¯å£ RABBITMQ_LOG_BASE=/data/rabbitmq/log æ—¥å¿—ç›®å½• RABBITMQ_PLUGINS_DIR=/data/rabbitmq/plugins æ’ä»¶ç›®å½• RABBITMQ_MNESIA_BASE=/data/rabbitmq/mnesia åç«¯å­˜å‚¨ç›®å½• RabbitMQçš„ç”¨æˆ·è§’è‰²åˆ†ç±» # noneã€managementã€policymakerã€monitoringã€administrator\nRabbitMQå„ç±»è§’è‰²æè¿°ï¼š # none # ä¸èƒ½è®¿é—® management plugin\nmanagement # ç”¨æˆ·å¯ä»¥é€šè¿‡AMQPåšçš„ä»»ä½•äº‹å¤–åŠ ï¼š åˆ—å‡ºè‡ªå·±å¯ä»¥é€šè¿‡AMQPç™»å…¥çš„virtual hosts æŸ¥çœ‹è‡ªå·±çš„virtual hostsä¸­çš„queues,\nexchanges å’Œ bindings æŸ¥çœ‹å’Œå…³é—­è‡ªå·±çš„channels å’Œ connections æŸ¥çœ‹æœ‰å…³è‡ªå·±çš„virtual\nhostsçš„â€œå…¨å±€â€çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…å«å…¶ä»–ç”¨æˆ·åœ¨è¿™äº›virtual hostsä¸­çš„æ´»åŠ¨ã€‚\npolicymaker # managementå¯ä»¥åšçš„ä»»ä½•äº‹å¤–åŠ ï¼š æŸ¥çœ‹ã€åˆ›å»ºå’Œåˆ é™¤è‡ªå·±çš„virtual hostsæ‰€å±çš„policieså’Œparameters\nmonitoring # managementå¯ä»¥åšçš„ä»»ä½•äº‹å¤–åŠ ï¼š åˆ—å‡ºæ‰€æœ‰virtual hostsï¼ŒåŒ…æ‹¬ä»–ä»¬ä¸èƒ½ç™»å½•çš„virtual hosts\næŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„connectionså’Œchannels æŸ¥çœ‹èŠ‚ç‚¹çº§åˆ«çš„æ•°æ®å¦‚clusteringå’Œmemoryä½¿ç”¨æƒ…å†µ æŸ¥çœ‹çœŸæ­£çš„å…³äºæ‰€æœ‰virtual\nhostsçš„å…¨å±€çš„ç»Ÿè®¡ä¿¡æ¯\nadministrator # policymakerå’Œmonitoringå¯ä»¥åšçš„ä»»ä½•äº‹å¤–åŠ : åˆ›å»ºå’Œåˆ é™¤virtual hosts æŸ¥çœ‹ã€åˆ›å»ºå’Œåˆ é™¤users\næŸ¥çœ‹åˆ›å»ºå’Œåˆ é™¤permissions å…³é—­å…¶ä»–ç”¨æˆ·çš„connections\n"},{"id":86,"href":"/blog/linux/H1z5LL49I0z/","title":"RabbitMQæ€§èƒ½ä¼˜åŒ–","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" rabbitmq.config # rabbitmq.configæ–‡ä»¶æ—¶rabbitmqçš„é…ç½®æ–‡ä»¶ï¼Œä»–éµå®ˆErlangé…ç½®æ–‡ä»¶å®šä¹‰ã€‚\nrabbitmq.configæ–‡ä»¶ä½ç½®ï¼š\nUnix $RABBITMQ_HOME/etc/rabbitmq Windows %APPDATA%\\RabbitMQ\\ ä¾‹å­å¦‚ä¸‹ï¼š\n[ {mnesia, [{dump_log_write_threshold, 1000}]}, {rabbit, [{tcp_listeners, [5673]}]} ]. Memoryé…ç½®å’Œè®¾ç½® # RabbitMQåœ¨ä½¿ç”¨å½“å‰æœºå™¨çš„40%ä»¥ä¸Šå†…å­˜æ—¶å€™ï¼Œä¼šå‘å‡ºå†…å­˜è­¦å‘Šï¼Œå¹¶ç»„ç»‡RabbitMQæ‰€æœ‰è¿æ¥ï¼ˆproducerè¿æ¥ï¼‰ã€‚ç›´åˆ°RabbitMQå°†å½“å‰æ•°æ®åˆ·å…¥åˆ°ç¡¬ç›˜æˆ–è€…æ¶ˆæ¯è¢«å®¢æˆ·ç«¯æ¶ˆè´¹ã€‚\nå½“Erlangçš„åƒåœ¾å›æ”¶æœºåˆ¶è¿è¡Œèµ·æ¥ï¼ˆè¿™æ˜¯ä¸€ä¸ªéå¸¸è€—è´¹èµ„æºçš„å·¥ä½œï¼‰ï¼Œä¼šæ¶ˆè´¹ä¸¤å€å†…å­˜ã€‚ï¼ˆé»˜è®¤æ˜¯80%çš„å†…å­˜ï¼‰ã€‚å› æ­¤éœ€è¦æ“ä½œç³»ç»Ÿæ”¯æŒOS swapå’Œpage\nfile.\næ³¨æ„ï¼šåœ¨32ä¸ºæ¶æ„ä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹è¢«é™åˆ¶ä¸º2GBã€‚é€šå¸¸64æ¶æ„ç³»ç»Ÿé™åˆ¶æ¯ä¸ªè¿›ç¨‹ä¸º256TBï¼Œ64ä½windowsé™åˆ¶ä¸º8TBã€‚å°±ç®—åœ¨64ä½æ“ä½œç³»ç»Ÿä¸‹ï¼Œ32ä½çš„è¿›ç¨‹åªèƒ½ç”¨2GBå†…å­˜ã€‚\nå› æ­¤å¼ºçƒˆæ¨èä½¿ç”¨64bit Erlang vmå’Œ64bit osã€‚\nå½“RabbitMQä¸èƒ½è¯†åˆ«ä½ çš„ç³»ç»Ÿçš„æ—¶å€™ï¼Œä½ å¿…é¡»å¯¹vm_memory_high_watermarkè¿›è¡Œä¿®æ”¹ã€‚\nå½“rabbitmqä¸èƒ½è¯†åˆ«ç³»ç»Ÿçš„æ—¶å€™ï¼Œä¼šè®¾ç½®å†…å­˜ä¸º1024MBã€‚æ‰€ä»¥rabbitmqå®é™…ä½¿ç”¨çš„å†…å­˜ä»…ä»…410MBã€‚\nå½“ç³»ç»Ÿä¸º8GBçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ˜¯vm_memory_high_watermark=3ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®é™…å¯ä»¥ä½¿ç”¨çš„å†…å­˜ä¸º3GBã€‚\né…ç½®Memory Thresholdæ–‡ä»¶\né»˜è®¤é…ç½®RabbitMQçš„vm_memory_high_watermark=0.4\n[{rabbit, [{vm_memory_high_watermark, 0.4}]}]. ä¸¾ä¾‹è¯´æ˜ï¼š # å½“æœºå™¨å†…å­˜ä¸º16GBï¼Œé‚£ä¹ˆ40%ï¼Œä¸º6.4GBã€‚ä¸»è¦å½“32ç³»ç»Ÿæ—¶å€™ï¼Œå®é™…å¯ä»¥ä½¿ç”¨çš„å†…å­˜ä¸º2GBï¼Œé‚£ä¹ˆå®é™…å¯ä»¥ä½¿ç”¨çš„å†…å­˜ä¸º820MBã€‚\nå½“æˆ‘é…ç½®vm_memory_high_watermark=0 æˆ‘ä»¬å¯ä»¥é˜»æ­¢æ‰€æœ‰æ¶ˆæ¯å‘é€ã€‚\næ³¨æ„ï¼šè¿™ä¸ªç™¾åˆ†æ¯”ï¼Œæœ€å¥½ä¸è¦ä¿®æ”¹ã€‚åº”ä¸ºErlang VMå›æ”¶çš„æ—¶å€™ä¼šå æ®ç³»ç»Ÿå†…å­˜çš„80%ã€‚å·²ç»è¾¾åˆ°ç³»ç»Ÿä¸´ç•ŒåŒºã€‚ä¸è¦è®¾ç½®è¶…è¿‡50%çš„ç™¾åˆ†æ¯”ã€‚\né…ç½®Page Thresholdæ–‡ä»¶ # å½“å†…å­˜ä¸­çš„æ•°æ®è¾¾åˆ°ä¸€å®šæ•°é‡åï¼Œä»–éœ€è¦è¢«page outå‡ºæ¥ã€‚ é»˜è®¤é…ç½®\nvm_memory_high_watermark_paging_ratio=0.5ã€‚ä¹Ÿå°±æ˜¯vm_memory_high_watermark0.5ã€‚å‡è®¾æ€»å†…å­˜8GBï¼Œ0.4çš„ä½¿ç”¨å†…å­˜æ˜¯3.2ã€‚é‚£ä¹ˆå½“å†…å­˜å¨å¨3.20.5=1.6GBæ—¶å€™ï¼Œç³»ç»Ÿå°†ä¼šå¤§é‡ç½®æ¢é¡µé¢ã€‚\nå› æ­¤æˆ‘ä»¬å¯ä»¥å°†é¡µé¢ç½®æ¢çš„ç™¾åˆ†æ¯”è°ƒé«˜ã€‚è®¾ç½®ä¸º0.75\n[{rabbit, [{vm_memory_high_watermark_paging_ratio, 0.75}, {vm_memory_high_watermark, 0.4}]}]. æ³¨æ„ï¼šæˆ‘ä»¬å¯ä»¥å°†vm_memory_high_watermark_paging_ratioè®¾ç½®è¶…è¿‡1.0ï¼Œé‚£ä¹ˆä¸ä¼šå‘ç”Ÿå†…å­˜æ¢é¡µçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å†…å­˜è¶…è¿‡æ€»å†…å­˜çš„40%ä¹‹åï¼Œå°†ä¼šé˜»æ­¢æ‰€æœ‰produceräº§ç”Ÿæ¶ˆæ¯ã€‚\né…ç½®å‘½ä»¤ # rabbitmqctl set_vm_memory_high_watermark 0.4 è¿™æ˜¯å†…å­˜ä½¿ç”¨å æ€»å†…å­˜æ•°çš„ç™¾åˆ†æ¯”\nrabbitmqctl set_vm_memory_high_watermark_paging_ratio 0.75 è®¾ç½®rabbitmqä½¿ç”¨å†…å­˜è¾¾åˆ°rabbitmqå¯ç”¨å†…å­˜ç™¾åˆ†æ¯”ï¼Œå°±å‡ºå‘é¡µé¢äº¤æ¢åŠŸèƒ½ã€‚\nrabbitmqctl status è·å¾—ç³»ç»Ÿé…ç½®ã€‚\nDiské…ç½®å’Œè®¾ç½® # RabbitMQä¼šåœ¨ç¡¬ç›˜ç©ºé—´ä¸å¤Ÿçš„æ—¶å€™ï¼Œé˜»æ­¢Producerå‘é€æ¶ˆæ¯ã€‚è¿™æ ·å¯ä»¥ä¿è¯RabbitMQå¯ä»¥å†ä»»ä½•æ—¶å€™ï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®ç½®æ¢åˆ°ç£ç›˜ä¸­æ¥ã€‚é€šå¸¸ä¼šå°†ç¡¬ç›˜å‰©ä½™æ•°æ®å¤§å°è®¾ç½®ä¸ºæœºå™¨çš„æ€»å†…å­˜å¤§å°ã€‚\nå…¨å±€æµæ§åˆ¶ä¼šè¢«è§¦å‘ï¼Œå½“å¯ç”¨æ€»ç¡¬ç›˜å®¹é‡å·²ç»ä½äºé…ç½®ä¿¡æ¯ã€‚brokeræ•°æ®åº“å°†ä¼šæœ€å°‘10ç§’æ£€æŸ¥ä¸€ä¸‹è­¦å‘Šæ˜¯å¦å‘å‡ºæˆ–è€…æ¸…é™¤ã€‚\nåœ¨RabbitMQå¯åŠ¨çš„åï¼Œä¼šæ‰“å°disk limité™åˆ¶ï¼Œä½†æ˜¯ä¸èƒ½è¯†åˆ«çš„å¹³å°å°±ä¸èƒ½æ˜¾ç¤ºä¿¡æ¯ã€‚\næ³¨æ„ï¼šå½“RabbitMQæ˜¯é›†ç¾¤æƒ…å†µä¸‹ï¼Œå½“å…¶ä¸­æœ‰ä¸€å°æœºå™¨ç¡¬ç›˜ä¸è¶³çš„æ—¶å€™ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„produceré“¾æ¥éƒ½ä¼šè¢«é˜»æ­¢ã€‚\nRabbitMQä¼šå®šæœŸä»·æ£€æŸ¥æ€»ç£ç›˜å¯ç”¨ç©ºé—´çš„å¤§å°ã€‚é€šå¸¸æ—¶é—´ä¸º10ç§’æ¯æ¬¡ï¼Œå½“é™åˆ¶å¿«è¢«è¾¾åˆ°æ—¶å€™ï¼ŒRabbitMQæ£€æŸ¥çš„æ—¶å€™ä¼šè¾¾åˆ°10æ¬¡/s.\né…ç½®Disk Free Space Limit # æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¾ç½®ç¡¬ç›˜çš„æœ€å°é™åˆ¶ã€‚ä¹Ÿå¯ä»¥è®¾ç½®ç›¸å¯¹å†…å­˜å¤§å°çš„è®¾ç½®ã€‚\nå…ˆè®¾ç½®ç£ç›˜1GBé™åˆ¶\n[{rabbit, [{disk_free_limit, 1000000000}]}]. åœ¨è¿™æ—¶ç›¸å¯¹äºæœºå™¨æ€»å†…å­˜\n[{rabbit, [{disk_free_limit, {mem_relative, 1.0}}]}]. Erlangçš„Hipeä¼˜åŒ– # å¯ä»¥è®¾ç½®hipe_compilesè®¾ç½®ã€‚å¯ä»¥çœ‹åˆ°æœ‰20-50%çš„æ€§èƒ½ä¼˜åŒ–ã€‚è€Œä½ åªéœ€è¦ä»˜å‡º1åˆ†é’Ÿå·¦å³çš„å»¶è¿Ÿå¯åŠ¨ã€‚\nHiPEéœ€è¦ä½ æ£€æŸ¥æ˜¯å¦ç¼–è¯‘è¿›å…¥ä½ çš„Erlangå®‰è£…ç¯å¢ƒã€‚Ubuntuï¼Œéœ€è¦å®‰è£…erlang-base-hipe.é»˜è®¤æœ‰äº›å¹³å°ä¸æ”¯æŒã€‚å¦‚æœErlang VM\nsegfaults,è¯·å…³é—­è¿™ä¸ªé€‰é¡¹ã€‚\n[{rabbit, [{hipe_compile, true}]}]. å‚è€ƒï¼šhttp://www.rabbitmq.com/configure.html#configuration-file\n"},{"id":87,"href":"/blog/linux/rkCKI84cLAG/","title":"rabbitmqä¹‹æœºå™¨æœºå™¨å…¨éƒ¨æ–­ç”µæ¢å¤è®°å½•","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":"ä»Šå¤©é‡åˆ°ä¸€ä¸ªrabbitmqé›†ç¾¤åŒæ—¶æ–­ç”µï¼Œå½“æœºå™¨å…¨éƒ¨å¯åŠ¨çš„æ—¶å€™å‘ç°rabbitmqæ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œç„¶åå‘ç°å¦‚ä¸‹æ—¥å¿—ã€‚\n=INFO REPORT==== 25-Apr-2018::11:11:07 === Starting RabbitMQ 3.5.3 on Erlang R16B03-1 Copyright (C) 2007-2014 GoPivotal, Inc. Licensed under the MPL. See http://www.rabbitmq.com/ =INFO REPORT==== 25-Apr-2018::11:11:07 === node : rabbit@WIN-ACC2J7AGNM9 home dir : C:\\Users\\Administrator config file(s) : e:/RabbitMQ Data/rabbitmq.config (not found) cookie hash : kR4NuIdBr2n8/4Qt9uIgqQ== log : E:/RabbitMQ Data/log/rabbit@WIN-ACC2J7AGNM9.log sasl log : E:/RabbitMQ Data/log/rabbit@WIN-ACC2J7AGNM9-sasl.log database dir : e:/RabbitMQ Data/db/rabbit@WIN-ACC2J7AGNM9-mnesia =WARNING REPORT==== 25-Apr-2018::11:11:07 === Kernel poll (epoll, kqueue, etc) is disabled. Throughput and CPU utilization may worsen. =INFO REPORT==== 25-Apr-2018::11:11:08 === Memory limit set to 13095MB of 32738MB total. =INFO REPORT==== 25-Apr-2018::11:11:08 === Disk free limit set to 50MB =INFO REPORT==== 25-Apr-2018::11:11:08 === Limiting to approx 8092 file handles (7280 sockets) =INFO REPORT==== 25-Apr-2018::11:11:38 === Timeout contacting cluster nodes: [\u0026#39;rabbit@WIN-2W6NDAIZBIA\u0026#39;]. BACKGROUND ========== This cluster node was shut down while other nodes were still running. To avoid losing data, you should start the other nodes first, then start this one. To force this node to start, first invoke \u0026#34;rabbitmqctl force_boot\u0026#34;. If you do so, any changes made on other cluster nodes after this one was shut down may be lost. DIAGNOSTICS =========== attempted to contact: [\u0026#39;rabbit@WIN-2W6NDAIZBIA\u0026#39;] rabbit@WIN-2W6NDAIZBIA: * connected to epmd (port 4369) on WIN-2W6NDAIZBIA * epmd reports: node \u0026#39;rabbit\u0026#39; not running at all no other nodes on WIN-2W6NDAIZBIA * suggestion: start the node current node details: - node name: \u0026#39;rabbit@WIN-ACC2J7AGNM9\u0026#39; - home dir: C:\\Users\\Administrator - cookie hash: kR4NuIdBr2n8/4Qt9uIgqQ== å…³é”®çš„åœ°æ–¹åœ¨äºä¸­é—´çš„è¿™æ®µè¯´æ˜ï¼š\nThis cluster node was shut down while other nodes were still running. To avoid losing data, you should start the other nodes first, then start this one. To force this node to start, first invoke \u0026#34;rabbitmqctl force_boot\u0026#34;. If you do so, any changes made on other cluster nodes after this one was shut down may be lost. åªè¦æ‰§è¡Œrabbitmqctl force_bootï¼Œå°†æ‰€æœ‰çš„èŠ‚ç‚¹å…¨éƒ¨å¼ºåˆ¶è®¾ç½®æˆæœ€åä¸€ä¸ªå…³é—­çš„å³å¯ã€‚\n"},{"id":88,"href":"/blog/linux/ry3FIUV58AM/","title":"rabbitmqä¹‹ä¿®æ”¹æ•°æ®å’Œlogç›®å½•ä½ç½®ä½ç½®","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" vim /etc/rabbitmq/rabbitmq-env.conf # I am a complete /etc/rabbitmq/rabbitmq-env.conf file. # Comment lines start with a hash character. # This is a /bin/sh script file - use ordinary envt var syntax MNESIA_BASE=/data/rabbitmq/mnesia LOG_BASE=/data/logs/rabbitmq "},{"id":89,"href":"/blog/ffmpeg/S1EdILNqU0M/","title":"Rematrix is needed between 10 channels and 7.1(wide) but there is not enough","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" è§£å†³åŠæ³•\nå°†10ä¸ªå£°é“æ‹†åˆ†æˆ10ä¸ªéŸ³è½¨\nffmpeg -i INPUTFILE -filter_complex â€œ[0:a]pan=mono|c0=c0[â€¦\nè§£å†³åŠæ³• # å°†10ä¸ªå£°é“æ‹†åˆ†æˆ10ä¸ªéŸ³è½¨\nffmpeg -i INPUTFILE -filter_complex \u0026#34;[0:a]pan=mono|c0=c0[a0];[0:a]pan=mono|c0=c1[a1];[0:a]pan=mono|c0=c2[a2];[0:a]pan=mono|c0=c3[a3];[0:a]pan=mono|c0=c4[a4];[0:a]pan=mono|c0=c5[a5];[0:a]pan=mono|c0=c6[a6];[0:a]pan=mono|c0=c7[a7];[0:a]pan=mono|c0=c8[a8];[0:a]pan=mono|c0=c9[a9]\u0026#34; -map \u0026#34;[a0]\u0026#34; -map \u0026#34;[a1]\u0026#34; -map \u0026#34;[a2]\u0026#34; -map \u0026#34;[a3]\u0026#34; -map \u0026#34;[a4]\u0026#34; -map \u0026#34;[a5]\u0026#34; -map \u0026#34;[a6]\u0026#34; -map \u0026#34;[a7]\u0026#34; -map \u0026#34;[a8]\u0026#34; -map \u0026#34;[a9]\u0026#34; -vn -c:a pcm_s24le OUTPUTFILE ffmpeg -i INPUTFILE -vn -c:a pcm_s24le -map 0:1 -filter:a:0 \u0026#34;pan=mono|c0=c0\u0026#34; -map 0:1 -filter:a:1 \u0026#34;pan=mono|c0=c1\u0026#34; -map 0:1 -filter:a:2 \u0026#34;pan=mono|c0=c2\u0026#34; -map 0:1 -filter:a:3 \u0026#34;pan=mono|c0=c3\u0026#34; -map 0:1 -filter:a:4 \u0026#34;pan=mono|c0=c4\u0026#34; -map 0:1 -filter:a:5 \u0026#34;pan=mono|c0=c5\u0026#34; -map 0:1 -filter:a:6 \u0026#34;pan=mono|c0=c6\u0026#34; -map 0:1 -filter:a:7 \u0026#34;pan=mono|c0=c7\u0026#34; -map 0:1 -filter:a:8 \u0026#34;pan=mono|c0=c8\u0026#34; -map 0:1 -filter:a:9 \u0026#34;pan=mono|c0=c9\u0026#34; OUTPUTFILE "},{"id":90,"href":"/blog/linux/BJrx8LE98CG/","title":"vsftpd é…ç½®æ–¹æ³•åŠè®¿é—®æ§åˆ¶","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" vsftpd è¯¦ç»†é…ç½®è¯´æ˜\nvsftpdå¸¸ç”¨é…ç½® # #å…³é—­åŒ¿åç”¨æˆ·è®¿é—®æƒé™ anonymous_enable=NO #å¼€å¯æœ¬åœ°ç”¨æˆ·æƒé™ local_enable=YES #å¼€å¯å†™æƒé™ write_enable=YES #è®¾ç½®ä¾¦å¬ç«¯å£ listen_port=21 #å†™æ–‡ä»¶æ—¶çš„umask local_umask=002 #è¢«åŠ¨æ¨¡å¼åŠå¼€æ”¾ç«¯å£æ®µ #pasv_enable=yes #pasv_min_port=30000 #pasv_max_port=50000 #è¶…æ—¶æ—¶é—´ #idle_session_timeout=6000000 #data_connection_timeout=6000000 dirmessage_enable=YES xferlog_enable=YES connect_from_port_20=YES xferlog_std_format=YES chroot_local_user=YES chroot_list_enable=YES chroot_list_file=/etc/vsftpd/chroot_list listen=YES pam_service_name=vsftpd userlist_enable=YES tcp_wrappers=YES use_localtime=YES reverse_lookup_enable=NO #convert_charset_enable=0 #local_charset=UTF8 #remote_charset=GB2312 #double_377=1 åˆ›å»ºè´¦æˆ·\nuseradd -M -s /sbin/nologin -d /mnt/usernamefile/ username for i in name1 name2 name3;do useradd -M -s /sbin/nologin -d /mnt/$i/ $i;done for i in name1 name2 name3;do echo \u0026#34;$i\u0026#34;123 | passwd --stdin $i ;done åˆ›å»ºç›®å½• # mkdir usernamefile chown username:username usernamefile for i in name1 name2 name3;do mkdir /mnt/$i;done for i in name1 name2 name3;do chown $i:$i /mnt/$i/;done chmod -R 770 * vsftpdè¢«åŠ¨æ¨¡å¼ # 1ã€å¼€å¯è¢«åŠ¨æ¨¡å¼ # vim vsftpd.conf pasv_enable=YES #å¼€å¯è¢«åŠ¨æ¨¡å¼ pasv_min_port=3000 #éšæœºæœ€å°ç«¯å£ pasv_max_port=4000 #éšæœºæœ€å¤§ç«¯å£ 2ã€åŠ è½½å†…æ ¸ # modprobe ip_conntrack_ftp modprobe ip_nat_ftp 3ã€é˜²ç«å¢™ # vim /etc/sysconfig/iptables åœ¨*filterä¸‹åŠ å…¥ä¸‹ -A OUTPUT -p tcp --sport 3000:4000 -j ACCEPT -A INPUT -p tcp --dport 3000:4000 -j ACCEPT iptables-restore \u0026lt; /etc/sysconfig/iptables åŠ è½½iptablesé…ç½® vsftpdè™šæ‹Ÿç”¨æˆ· # 1ã€vsftpdå®‰è£… # yum -y install vsftpd #vsftpdè½¯ä»¶ yum -y install db4-utils #ç”Ÿæˆè™šæ‹Ÿç”¨æˆ·è®¤è¯æ•°æ®æ–‡ä»¶å‘½ä»¤ 2ã€é…ç½®vsftp # vim /etc/vsftpd/vsftpd.conf listen=YES #ç‹¬ç«‹è¿è¡Œvsftpd anonymous_enable=NO #é™åˆ¶åŒ¿åç”¨æˆ·ç™»å½• dirmessage_enable=YES xferlog_enable=YES xferlog_file=/var/log/vsftpd.log xferlog_std_format=YES chroot_list_enable=YES #é™åˆ¶è™šæ‹Ÿç”¨æˆ·åˆ‡æ¢ç›®å½• chroot_list_file=/etc/vsftpd/chroot_list #é™åˆ¶åˆ‡æ¢ç›®å½•çš„ç”¨æˆ·åˆ—è¡¨ chroot_local_user=YES guest_enable=YES #å¼€å¯è™šæ‹Ÿç”¨æˆ·è®¤è¯ guest_username=ftp #æ˜ å°„çš„çœŸå®ç”¨æˆ· user_config_dir=/etc/vsftpd/vsftpd_user_conf #è™šæ‹Ÿç”¨æˆ·é…ç½®ç›®å½• pam_service_name=vsftpd.vu #vsftpdè®¤è¯çš„pamè®¤è¯æ¨¡å— local_enable=YES 3ã€è™šæ‹Ÿç”¨æˆ·db # cd /etc/vsftpd vim user.txt yuangang #ç”¨æˆ·å 123456 #å¯†ç  db_load -T -t hash -f user.txt /etc/vsftpd/vsftpd_login.db chmod 600 /etc/vsftpd/vsftpd_login.db # é…ç½®pamè®¤è¯ vim /etc/pam.d/vsftpd.vu auth required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpd_login account required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpd_login vim /etc/vsftpd/chroot_list #é™åˆ¶è™šæ‹Ÿç”¨æˆ·åˆ‡æ¢ç›®å½• ftp yuangang 4ã€é…ç½®è™šæ‹Ÿç”¨æˆ· # cd /etc/vsftpd/vsftpd_user_conf vim yuangang write_enable=YES anon_world_readable_only=NO anon_upload_enable=YES anon_mkdir_write_enable=YES anon_other_write_enable=YES local_root=/data/httpd/yuangang # å»ºç«‹è™šæ‹Ÿç”¨æˆ·ftpç›®å½• mkdir /data/httpd/yuangang chown -R ftp.root /data/httpd chmod o+rw /data/httpd/yuangang vsftpd cmds_allowed # cmds_allowed=ABOR,CWD,LIST,MDTM,MKD,NLST, PASS,PASV,PORT,PWD,QUIT,RETR,RMD,RNFR, RNTO,SITE,SIZE,STOR,TYPE,USER,ACCT, APPE,CDUP,HELP,MODE,NOOP,REIN,STAT,STOU,STRU,SYST æ³¨æ„:ä¸€å®šä¸èƒ½ä½¿ç”¨æ¢è¡Œå’Œç©ºæ ¼ï¼Œä¸ç„¶å°±æ²¡æ•ˆæœ..\nå…¨éƒ¨å‚æ•° # # ABOR - abort a file transfer å–æ¶ˆæ–‡ä»¶ä¼ è¾“ # CWD - change working directory æ›´æ”¹ç›®å½• # DELE - delete a remote file åˆ é™¤æ–‡ä»¶ # LIST - list remote files åˆ—ç›®å½• # MDTM - return the modification time of a file è¿”å›æ–‡ä»¶çš„æ›´æ–°æ—¶é—´ # MKD - make a remote directory æ–°å»ºæ–‡ä»¶å¤¹ # NLST - name list of remote directory # PASS - send password # PASV - enter passive mode # PORT - open a data port æ‰“å¼€ä¸€ä¸ªä¼ è¾“ç«¯å£ # PWD - print working directory æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½• # QUIT - terminate the connection é€€å‡º # RETR - retrieve a remote file ä¸‹è½½æ–‡ä»¶ # RMD - remove a remote directory # RNFR - rename from # RNTO - rename to # SITE - site-specific commands # SIZE - return the size of a file è¿”å›æ–‡ä»¶å¤§å° # STOR - store a file on the remote host ä¸Šä¼ æ–‡ä»¶ # TYPE - set transfer type # USER - send username # less common commands: # ACCT* - send account information # APPE - append to a remote file # CDUP - CWD to the parent of the current directory # HELP - return help on using the server # MODE - set transfer mode # NOOP - do nothing # REIN* - reinitialize the connection # STAT - return server status # STOU - store a file uniquely # STRU - set file transfer structure # SYST - return system type å¸¸ç”¨å‚æ•° # # CWD - change working directory æ›´æ”¹ç›®å½• # LIST - list remote files åˆ—ç›®å½• # MKD - make a remote directory æ–°å»ºæ–‡ä»¶å¤¹ # NLST - name list of remote directory # PWD - print working directory æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½• # RETR - retrieve a remote file ä¸‹è½½æ–‡ä»¶ # STOR - store a file on the remote host ä¸Šä¼ æ–‡ä»¶ # DELE - delete a remote file åˆ é™¤æ–‡ä»¶ # RMD - remove a remote directory åˆ é™¤ç›®å½• # RNFR - rename from é‡å‘½å # RNTO - rename to é‡å‘½å ä»¥ä¸Šæ˜¯å¸¸ç”¨çš„ä¸€äº›å‚æ•°ï¼Œå¤§å®¶å¯¹ç…§å­¦ä¹ ä¸€ä¸‹ï¼\nå‡ ä¸ªä¾‹å­ # 1ã€åªèƒ½ä¸Šä¼ ã€‚ä¸èƒ½ä¸‹è½½ã€åˆ é™¤ã€é‡å‘½åã€‚ cmds_allowedï¼FEAT,REST,CWD,LIST,MDTM,MKD,NLST,PASS,PASV,PORT,PWD,QUIT,RMD,SIZE,STOR,TYPE,USER,ACCT, APPE,CDUP,HELP,MODE,NOOP,REIN,STAT,STOU,STRU,SYST 2ã€åªèƒ½ä¸‹è½½ã€‚ä¸èƒ½ä¸Šä¼ ã€åˆ é™¤ã€é‡å‘½åã€‚write_enable=NO 3ã€åªèƒ½ä¸Šä¼ ã€åˆ é™¤ã€é‡å‘½åã€‚ä¸èƒ½ä¸‹è½½ã€‚download_enableï¼NO 4ã€åªèƒ½ä¸‹è½½ã€åˆ é™¤ã€é‡å‘½åã€‚ä¸èƒ½ä¸Šä¼ ã€‚ cmds_allowed=FEAT,REST,CWD,LIST,MDTM,MKD,NLST,PASS,PASV,PORT,PWD,QUIT,RMD,RNFR,RNTO, RETR,DELE,SIZE,TYPE,USER,ACCT,APPE,CDUP,HELP,MODE,NOOP,REIN,STAT,STOU,STRU,SYST æ—¥å¿—æ ¼å¼è§£æ # Sun Feb 23 22:08:26 2014 | 6 | 212.73.193.130 | 1023575 |\n/Lille_IconSP/win_230214_52_11.jpg | b| _| i| r| sipafranch| ftp| 0| *| c\nè®°å½• å«ä¹‰\nSun Feb 23 22:08:26 2014 FTPä¼ è¾“æ—¶é—´\n6 ä¼ è¾“æ–‡ä»¶æ‰€ç”¨æ—¶é—´ã€‚å•ä½/ç§’\n212.73.193.130 ftpå®¢æˆ·ç«¯åç§°/IP\n1023575 ä¼ è¾“æ–‡ä»¶å¤§å°ã€‚å•ä½/Byte\n/Lille_IconSP/win_230214_52_11.jpg ä¼ è¾“æ–‡ä»¶åï¼ŒåŒ…å«è·¯å¾„\nb ä¼ è¾“æ–¹å¼ï¼š aä»¥ASCIIæ–¹å¼ä¼ è¾“; bä»¥äºŒè¿›åˆ¶(binary)æ–¹å¼ä¼ è¾“;\n_ ç‰¹æ®Šå¤„ç†æ ‡å¿—ä½ï¼šâ€_â€œä¸åšä»»ä½•å¤„ç†ï¼›â€Câ€æ–‡ä»¶æ˜¯å‹ç¼©æ ¼å¼ï¼›â€Uâ€æ–‡ä»¶éå‹ç¼©æ ¼å¼ï¼›â€Tâ€æ–‡ä»¶æ˜¯taræ ¼å¼ï¼›\ni ä¼ è¾“æ–¹å‘ï¼šâ€iâ€ä¸Šä¼ ï¼›â€oâ€ä¸‹è½½ï¼›\nr ç”¨æˆ·è®¿é—®æ¨¡å¼ï¼šâ€œaâ€åŒ¿åç”¨æˆ·ï¼›â€gâ€è®¿å®¢æ¨¡å¼ï¼›â€râ€ç³»ç»Ÿä¸­ç”¨æˆ·;\nsipafranch ç™»å½•ç”¨æˆ·å\nftp æœåŠ¡åç§°ï¼Œä¸€èˆ¬éƒ½æ˜¯ftp\n0 è®¤è¯æ–¹å¼ï¼šâ€0â€æ— ï¼›â€1â€RFC931è®¤è¯ï¼›\nè®¤è¯ç”¨æˆ·idï¼Œâ€*â€œè¡¨ç¤ºæ— æ³•è·å–id c å®ŒæˆçŠ¶æ€ï¼šâ€iâ€ä¼ è¾“æœªå®Œæˆï¼›â€câ€ä¼ è¾“å·²å®Œæˆï¼›\n"},{"id":91,"href":"/blog/linux/SJ_88EqU0M/","title":"webè¿ç»´ç›¸å…³æŸ¥è¯¢å‘½ä»¤","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" 1. æŸ¥çœ‹TCPè¿æ¥çŠ¶æ€ # netstat -nat |awk \u0026#39;{print $6}\u0026#39;|sort|uniq -c|sort -rn netstat -n | awk \u0026#39;/^tcp/ {++S[$NF]};END {for(a in S) print a, S[a]}\u0026#39; æˆ– netstat -n | awk \u0026#39;/^tcp/ {++state[$NF]}; END {for(key in state) print key,\u0026#34;\\t\u0026#34;,state[key]}\u0026#39; netstat -n | awk \u0026#39;/^tcp/ {++arr[$NF]};END {for(k in arr) print k,\u0026#34;\\t\u0026#34;,arr[k]}\u0026#39; netstat -n |awk \u0026#39;/^tcp/ {print $NF}\u0026#39;|sort|uniq -c|sort -rn netstat -ant | awk \u0026#39;{print $NF}\u0026#39; | grep -v \u0026#39;[a-z]\u0026#39; | sort | uniq -c ä»¥ä¸Šæ¯ä¸€è¡Œå®ç°çš„æ•ˆæœåŸºæœ¬ç›¸åŒï¼Œåœ¨æ­¤åˆ—å‡ºä¸åŒçš„å†™æ³•ï¼Œæ–¹ä¾¿å¯¹è„šæœ¬å†™æ³•çš„æ›´æ·±ç†è§£\n2. æŸ¥æ‰¾è¯·æ±‚æ•°è¯·20ä¸ªIPï¼ˆå¸¸ç”¨äºæŸ¥æ‰¾æ”»æ¥æºï¼‰ # netstat -anlp|grep 80|grep tcp|awk \u0026#39;{print $5}\u0026#39;|awk -F: \u0026#39;{print $1}\u0026#39;|sort|uniq -c|sort -nr|head -n20 netstat -ant |awk \u0026#39;/:80/{split($5,ip,\u0026#34;:\u0026#34;);++A[ip[1]]}END{for(i in A) print A[i],i}\u0026#39; |sort -rn|head -n20 3. ç”¨tcpdumpå—…æ¢80ç«¯å£çš„è®¿é—®çœ‹çœ‹è°æœ€é«˜ # tcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -F\u0026#34;.\u0026#34; \u0026#39;{print $1\u0026#34;.\u0026#34;$2\u0026#34;.\u0026#34;$3\u0026#34;.\u0026#34;$4}\u0026#39; | sort | uniq -c | sort -nr |head -20 4. æŸ¥æ‰¾è¾ƒå¤štime_waitè¿æ¥ # netstat -n|grep TIME_WAIT|awk \u0026#39;{print $5}\u0026#39;|sort|uniq -c|sort -rn|head -n20 5. æ‰¾æŸ¥è¾ƒå¤šçš„SYNè¿æ¥ # netstat -an | grep SYN | awk \u0026#39;{print $5}\u0026#39; | awk -F: \u0026#39;{print $1}\u0026#39; | sort | uniq -c | sort -nr | more 6. æ ¹æ®ç«¯å£åˆ—è¿›ç¨‹ # netstat -ntlp | grep 80 | awk \u0026#39;{print $7}\u0026#39; | cut -d/ -f1 7. æŸ¥çœ‹æœ‰å¤šå°‘ä¸ªPHP-CGIè¿›ç¨‹æ´»åŠ¨ # netstat -anp | grep php-cgi | grep ^tcp | wc -l 8.æŸ¥çœ‹PHP-CGIå ç”¨å†…å­˜çš„æ€»æ•° # total=0; for i in `ps -C php-cgi -o rss=`; do total=$(($total+$i)); done; echo \u0026#34;PHP-CGI Memory usage: $total kb\u0026#34; "},{"id":92,"href":"/blog/linux/SytNL84q8Af/","title":"é˜¿é‡Œäº‘ECS Linuxçš„rc.localï¼ˆå¼€æœºå¯åŠ¨ï¼‰è®¾ç½®ä¸ç”Ÿæ•ˆ","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" none\nä½¿ç”¨åœºæ™¯ # å‰æ®µæ—¶é—´ä½¿ç”¨é˜¿é‡Œäº‘çš„ecsï¼Œå°†ä¸€äº›å¼€æœºå¯åŠ¨çš„å‘½ä»¤å†™åˆ°/etc/rc.localé‡Œé¢ï¼Œå‘ç°ä¸ç”Ÿæ•ˆã€‚ç»è¿‡ä¸€ç•ªæŸ¥è¯¢å’Œæœç´¢ä¹‹åï¼Œæœ€åå‘ç°ä¸€ä¸ªå‘ï¼Œå±…ç„¶è¦ç»™è¿™ä¸ªæ–‡ä»¶è®¾ç½®æ‰§è¡Œæƒé™æ‰ç”Ÿæ•ˆã€‚\nè§£å†³æ–¹æ³• # chmod +x /etc/rc.local "},{"id":93,"href":"/blog/linux/HJqtULE5I0z/","title":"æ’æŸ¥linuxæ ¹ç›®å½•ç©ºé—´å ç”¨ä¸å®é™…ç©ºé—´ä¸ç¬¦","section":"ğŸ“š æˆ‘çš„æ–‡ç« ","content":" å‘ç°é—®é¢˜ # é¦–å…ˆä½¿ç”¨â€df -Thâ€æŸ¥çœ‹æ ¹ç›®å½•çš„ç©ºé—´ä½¿ç”¨å’Œâ€du -sh /â€œçš„ç»“æœè¿›è¡Œå¯¹æ¯”ã€‚\næ’æŸ¥é—®é¢˜ # ç¬¬ä¸€ç§æƒ…å†µ # æ–‡ä»¶è¢«åˆ æ‰ï¼Œä½†æ˜¯å†™è¿™ä¸ªæ–‡ä»¶çš„è¿›ç¨‹æ²¡é€€å‡º\nlsof -n|grep delete ä½¿ç”¨ä»¥ä¸Šå‘½ä»¤å¾—åˆ°ç›¸å…³çš„è¿›ç¨‹ï¼Œç„¶åä½¿ç”¨å¾—åˆ°çš„pidæ‰¾åˆ°å¯¹åº”çš„ç¨‹åºï¼Œç„¶åé‡å¯ç¨‹åºæˆ–killæ‰å³å¯é‡Šæ”¾è¢«åˆ é™¤æ–‡ä»¶çš„ç©ºé—´ã€‚\nç¬¬äºŒç§æƒ…å†µ # lsof -n|grep delete æ²¡æœ‰å¾—åˆ°ä»»ä½•è¿”å›ç»“æœã€‚\né‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆæŸ¥çœ‹ä¸‹æ ¹ç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚æœæ˜¯â€œxfsâ€,é‚£ä¹ˆå¯ä»¥ä½¿ç”¨\nxfs_db -c frag -r /dev/sdxx æŸ¥çœ‹ç¢ç‰‡çš„å æ¯”ï¼Œå¦‚æœè¾ƒé«˜çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ•´ç†ä¸‹xfsçš„ç¢ç‰‡äº†ã€‚\nxfs_fsr /dev/sdxx #æ•´ç†ç¢ç‰‡ ç„¶åä½ å†â€œdfâ€çœ‹çœ‹é‡Šæ”¾ç©ºé—´å·²ç»é‡Šæ”¾äº†ã€‚\nå¤‡æ³¨ # xfsè™½ç„¶æ€§èƒ½æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯ç¨³å®šæ€§è¿˜æ˜¯æœ‰æ‰€æ¬ ç¼ºï¼Œä¸æ˜¯å¾ˆå»ºè®®ä½¿ç”¨ã€‚\nå¦‚æœä»¥ä¸Šçš„æ–¹æ³•æ²¡æœ‰è§£å†³ä½ çš„é—®é¢˜æˆ–è€…ä½ è¿˜æœ‰å…¶ä»–æƒ…å†µï¼Œæ¬¢è¿ç•™è¨€ä¸€èµ·æ¢è®¨ã€‚\n"}]