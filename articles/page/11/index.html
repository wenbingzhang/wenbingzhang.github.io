<!doctype html><html lang=zh dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://notes.zhangwenbing.com/articles/"><meta property="og:site_name" content="张文兵的笔记"><meta property="og:title" content="📚 我的文章"><meta property="og:locale" content="zh"><meta property="og:type" content="website"><title>📚 我的文章 | 张文兵的笔记</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=https://notes.zhangwenbing.com/articles/><link rel=stylesheet href=/book.min.7bc0bb908f28131671779537cc0c91a39075ed4cba93497f05888d37375171ce.css integrity="sha256-e8C7kI8oExZxd5U3zAyRo5B17Uy6k0l/BYiNNzdRcc4=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/zh.search.min.341f63499f92249bc924ac7508939aec7ae268385455b3059a28d6d4d77f36e0.js integrity="sha256-NB9jSZ+SJJvJJKx1CJOa7HriaDhUVbMFmijW1Nd/NuA=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://notes.zhangwenbing.com/articles/index.xml title=张文兵的笔记></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>张文兵的笔记</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-6d1804e163fb7f5fbc576b94719a59cb class=toggle>
<label for=section-6d1804e163fb7f5fbc576b94719a59cb class="flex justify-between"><a role=button>👨🏼‍💻 编程相关</a></label><ul><li><input type=checkbox id=section-f56428119b0aac71309abf8dfea134ce class=toggle>
<label for=section-f56428119b0aac71309abf8dfea134ce class="flex justify-between"><a role=button>📔 C++</a></label><ul><li><input type=checkbox id=section-fb47b341e1fcc9c423db5ed573183d82 class=toggle>
<label for=section-fb47b341e1fcc9c423db5ed573183d82 class="flex justify-between"><a role=button>🔖 MacOS相关</a></label><ul><li><a href=/notes/2024/06/06/sf4ff6x8cuyhvzougj9dwg/>📝 MacOS签名</a></li><li><a href=/notes/2024/05/28/3txbbb7iruppjsg4p7rwnb/>📝 MacOS堆栈大小</a></li></ul></li><li><input type=checkbox id=section-b76e207ac5e871ff00bceef2a05945c7 class=toggle>
<label for=section-b76e207ac5e871ff00bceef2a05945c7 class="flex justify-between"><a role=button>🔖 Qt</a></label><ul><li><a href=/notes/2024/08/01/rnc4n7cfifidx8ca2rhjme/>📝 QML鼠标事件</a></li><li><a href=/notes/2024/08/06/ny773erqjgbzmzgfikfvds/>📝 QML虚拟列表</a></li></ul></li><li><input type=checkbox id=section-03639da61c682690825d49325c54c7e8 class=toggle>
<label for=section-03639da61c682690825d49325c54c7e8 class="flex justify-between"><a role=button>🔖 Python</a></label><ul><li><a href=/notes/2025/02/10/7auahqg8nnxm5ydhxzqrnr/>📝 调用Python代码</a></li><li><a href=/notes/2025/02/10/gqci9riugfetribe6j6fou/>📝 调用Python方法</a></li><li><a href=/notes/2025/02/10/pkdrvn9md3ggfmbxahx4ef/>📝 注册Python模块</a></li></ul></li></ul></li><li><input type=checkbox id=section-aea9addc7ea0cf58a2c2c9ec52f959c9 class=toggle>
<label for=section-aea9addc7ea0cf58a2c2c9ec52f959c9 class="flex justify-between"><a role=button>📔 Git</a></label><ul><li><a href=/notes/2024/03/11/j3c62fv8dglvf2kg975zlv/>📝 标签操作</a></li><li><a href=/notes/2024/03/14/5kqlzqjqawbxf2t6vusxar/>📝 删除Commit</a></li><li><a href=/blog/git/WNYzxj6GR/>📝 git之删除远程分支</a></li><li><a href=/blog/git/-fZeBsu3T/>📝 git更新.gitignore</a></li><li><a href=/blog/git/H1Krv6b-4/>📝 git修改历史cimmit信息</a></li><li><a href=/blog/git/By9OI51xN/>📝 git基础笔记</a></li><li><a href=/blog/git/Hk6GGp6cQ/>📝 Git回滚到某个commit</a></li></ul></li></ul></li><li><input type=checkbox id=section-caf3b688bb818cc6cfc82165db78eba5 class=toggle>
<label for=section-caf3b688bb818cc6cfc82165db78eba5 class="flex justify-between"><a role=button>♻️ 回收归档</a></label><ul><li><input type=checkbox id=section-4a72fedb3d7dfc18dbbcab83511bf75a class=toggle>
<label for=section-4a72fedb3d7dfc18dbbcab83511bf75a class="flex justify-between"><a role=button>📔 Rust</a></label><ul><li><input type=checkbox id=section-8aa26b33a0315c1be70924160dd1a92c class=toggle>
<label for=section-8aa26b33a0315c1be70924160dd1a92c class="flex justify-between"><a role=button>🔖 学习笔记</a></label><ul><li><a href=/notes/2024/03/06/e3ksq3zkmps14gcxuirwzx/>📝 所有权</a></li><li><a href=/notes/2024/03/06/o4arkqgfnqygr5ckif2gkk/>📝 借用与引用</a></li></ul></li></ul></li></ul></li><li><a href=/links/>🤝 友情链接</a></li></ul><ul><li><a href=/articles/>📚 我的文章</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>📚 我的文章</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Categories</strong><ul><li class="flex justify-between"><a href=/categories/linux/>Linux</a>
<span>84</span></li><li class="flex justify-between"><a href=/categories/ffmpeg/>FFmpeg</a>
<span>25</span></li><li class="flex justify-between"><a href=/categories/macos/>MacOS</a>
<span>10</span></li><li class="flex justify-between"><a href=/categories/hugo/>Hugo</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/linux/>Linux</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/ffmpeg/>FFmpeg</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/macos/>MacOS</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/python/>Python</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/blog/>Blog</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/hugo/>Hugo</a>
<span>1</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/SyqLL45IRz/>nginx 简单配置及使用教程</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>none</p></blockquote><h2 id=常用配置>常用配置
<a class=anchor href=#%e5%b8%b8%e7%94%a8%e9%85%8d%e7%bd%ae>#</a></h2><pre tabindex=0><code>#运行用户
user nobody;
#启动进程,通常设置成和cpu的数量相等
worker_processes  1;

#全局错误日志及PID文件
#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;

#工作模式及连接数上限
events {
    #epoll是多路复用IO(I/O Multiplexing)中的一种方式,
    #仅用于linux2.6以上内核,可以大大提高nginx的性能
    use   epoll;

    #单个后台worker process进程的最大并发链接数
    worker_connections  1024;

    # 并发总数是 worker_processes 和 worker_connections 的乘积
    # 即 max_clients = worker_processes * worker_connections
    # 在设置了反向代理的情况下，max_clients = worker_processes * worker_connections / 4  为什么
    # 为什么上面反向代理要除以4，应该说是一个经验值
    # 根据以上条件，正常情况下的Nginx Server可以应付的最大连接数为：4 * 8000 = 32000
    # worker_connections 值的设置跟物理内存大小有关
    # 因为并发受IO约束，max_clients的值须小于系统可以打开的最大文件数
    # 而系统可以打开的最大文件数和内存大小成正比，一般1GB内存的机器上可以打开的文件数大约是10万左右
    # 我们来看看360M内存的VPS可以打开的文件句柄数是多少：
    # $ cat /proc/sys/fs/file-max
    # 输出 34336
    # 32000 &lt; 34336，即并发连接总数小于系统可以打开的文件句柄总数，这样就在操作系统可以承受的范围之内
    # 所以，worker_connections 的值需根据 worker_processes 进程数目和系统可以打开的最大文件总数进行适当地进行设置
    # 使得并发总数小于操作系统可以打开的最大文件数目
    # 其实质也就是根据主机的物理CPU和内存进行配置
    # 当然，理论上的并发总数可能会和实际有所偏差，因为主机还有其他的工作进程需要消耗系统资源。
    # ulimit -SHn 65535

}

http {
    #设定mime类型,类型由mime.type文件定义
    include    mime.types;
    default_type  application/octet-stream;
    #设定日志格式
    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;
                      &#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;
                      &#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;;

    access_log  logs/access.log  main;

    #sendfile 指令指定 nginx 是否调用 sendfile 函数（zero copy 方式）来输出文件，
    #对于普通应用，必须设为 on,
    #如果用来进行下载等应用磁盘IO重负载应用，可设置为 off，
    #以平衡磁盘与网络I/O处理速度，降低系统的uptime.
    sendfile     on;
    #tcp_nopush     on;

    #连接超时时间
    #keepalive_timeout  0;
    keepalive_timeout  65;
    tcp_nodelay     on;

    #开启gzip压缩
    gzip  on;
    gzip_disable &#34;MSIE [1-6].&#34;;

    #设定请求缓冲
    client_header_buffer_size    128k;
    large_client_header_buffers  4 128k;

    #设定虚拟主机配置
    server {
        #侦听80端口
        listen    80;
        #定义使用 www.nginx.cn访问
        server_name  www.nginx.cn;

        #定义服务器的默认网站根目录位置
        root html;

        #设定本虚拟主机的访问日志
        access_log  logs/nginx.access.log  main;

        #默认请求
        location / {

            #定义首页索引文件的名称
            index index.php index.html index.htm;

        }

        # 定义错误提示页面
        error_page   500 502 503 504 /50x.html;
        location = /50x.html {
        }

        #静态文件，nginx自己处理
        location ~ ^/(images|javascript|js|css|flash|media|static)/ {

            #过期30天，静态文件不怎么更新，过期可以设大一点，
            #如果频繁更新，则可以设置得小一点。
            expires 30d;
        }

        #PHP 脚本请求全部转发到 FastCGI处理. 使用FastCGI默认配置.
        location ~ .php$ {
            fastcgi_pass 127.0.0.1:9000;
            fastcgi_index index.php;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            include fastcgi_params;
        }

        #禁止访问 .htxxx 文件
            location ~ /.ht {
            deny all;
        }

    }
}
</code></pre><h2 id=其他配置>其他配置
<a class=anchor href=#%e5%85%b6%e4%bb%96%e9%85%8d%e7%bd%ae>#</a></h2><pre tabindex=0><code>#定义Nginx运行的用户和用户组
user www www;

#nginx进程数，建议设置为等于CPU总核心数。
worker_processes 8;

#全局错误日志定义类型，[ debug | info | notice | warn | error | crit ]
error_log /var/log/nginx/error.log info;

#进程文件
pid /var/run/nginx.pid;

#一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（系统的值ulimit -n）与nginx进程数相除，但是nginx分配请求并不均匀，所以建议与ulimit -n的值保持一致。
worker_rlimit_nofile 65535;

#工作模式与连接数上限
events
{
#参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型是Linux 2.6以上版本内核中的高性能网络I/O模型，如果跑在FreeBSD上面，就用kqueue模型。
use epoll;
#单个进程最大连接数（最大连接数=连接数*进程数）
worker_connections 65535;
}

#设定http服务器
http
{
include mime.types; #文件扩展名与文件类型映射表
default_type application/octet-stream; #默认文件类型
#charset utf-8; #默认编码
server_names_hash_bucket_size 128; #服务器名字的hash表大小
client_header_buffer_size 32k; #上传文件大小限制
large_client_header_buffers 4 64k; #设定请求缓
client_max_body_size 8m; #设定请求缓
sendfile on; #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。
autoindex on; #开启目录列表访问，合适下载服务器，默认关闭。
tcp_nopush on; #防止网络阻塞
tcp_nodelay on; #防止网络阻塞
keepalive_timeout 120; #长连接超时时间，单位是秒

#FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。
fastcgi_connect_timeout 300;
fastcgi_send_timeout 300;
fastcgi_read_timeout 300;
fastcgi_buffer_size 64k;
fastcgi_buffers 4 64k;
fastcgi_busy_buffers_size 128k;
fastcgi_temp_file_write_size 128k;

#gzip模块设置
gzip on; #开启gzip压缩输出
gzip_min_length 1k; #最小压缩文件大小
gzip_buffers 4 16k; #压缩缓冲区
gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）
gzip_comp_level 2; #压缩等级
gzip_types text/plain application/x-javascript text/css application/xml;
#压缩类型，默认就已经包含text/html，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。
gzip_vary on;
#limit_zone crawler $binary_remote_addr 10m; #开启限制IP连接数的时候需要使用

upstream blog.ha97.com {
#upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。
server 192.168.80.121:80 weight=3;
server 192.168.80.122:80 weight=2;
server 192.168.80.123:80 weight=3;
}

#虚拟主机的配置
server
{
#监听端口
listen 80;
#域名可以有多个，用空格隔开
server_name www.ha97.com ha97.com;
index index.html index.htm index.php;
root /data/www/ha97;
location ~ .*\.(php|php5)?$
{
fastcgi_pass 127.0.0.1:9000;
fastcgi_index index.php;
include fastcgi.conf;
}
#图片缓存时间设置
location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
{
expires 10d;
}
#JS和CSS缓存时间设置
location ~ .*\.(js|css)?$
{
expires 1h;
}
#日志格式设定
log_format access &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;
&#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;
&#39;&#34;$http_user_agent&#34; $http_x_forwarded_for&#39;;
#定义本虚拟主机的访问日志
access_log /var/log/nginx/ha97access.log access;

#对 &#34;/&#34; 启用反向代理
location / {
proxy_pass http://127.0.0.1:88;
proxy_redirect off;
proxy_set_header X-Real-IP $remote_addr;
#后端的Web服务器可以通过X-Forwarded-For获取用户真实IP
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#以下是一些反向代理的配置，可选。
proxy_set_header Host $host;
client_max_body_size 10m; #允许客户端请求的最大单文件字节数
client_body_buffer_size 128k; #缓冲区代理缓冲用户端请求的最大字节数，
proxy_connect_timeout 90; #nginx跟后端服务器连接超时时间(代理连接超时)
proxy_send_timeout 90; #后端服务器数据回传时间(代理发送超时)
proxy_read_timeout 90; #连接成功后，后端服务器响应时间(代理接收超时)
proxy_buffer_size 4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小
proxy_buffers 4 32k; #proxy_buffers缓冲区，网页平均在32k以下的设置
proxy_busy_buffers_size 64k; #高负荷下缓冲大小（proxy_buffers*2）
proxy_temp_file_write_size 64k;
#设定缓存文件夹大小，大于这个值，将从upstream服务器传
}

#设定查看Nginx状态的地址
location /NginxStatus {
stub_status on;
access_log on;
auth_basic &#34;NginxStatus&#34;;
auth_basic_user_file conf/htpasswd;
#htpasswd文件的内容可以用apache提供的htpasswd工具来产生。
}

#本地动静分离反向代理配置
#所有jsp的页面均交由tomcat或resin处理
location ~ .(jsp|jspx|do)?$ {
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_pass http://127.0.0.1:8080;
}
#所有静态文件由nginx直接读取不经过tomcat或resin
location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$
{ expires 15d; }
location ~ .*.(js|css)?$
{ expires 1h; }
}
}
</code></pre></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/ByS8884qI0M/>nginx+php+ThinkPHP环境常见错误总结</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>错误一</p></blockquote><p>2017/09/07 16:39:18 [error] 21753#0: *26 FastCGI sent in stderr: “Primary s…</p><h2 id=错误一>错误一
<a class=anchor href=#%e9%94%99%e8%af%af%e4%b8%80>#</a></h2><pre tabindex=0><code>2017/09/07 16:39:18 [error] 21753#0: *26 FastCGI sent in stderr: &#34;Primary script unknown&#34; while reading response header from upstream, client: 172.31.26.114, server: localhost, request: &#34;GET /1.php HTTP/1.1&#34;, upstream: &#34;fastcgi://127.0.0.1:9000&#34;, host: &#34;10.200.8.220:8000&#34;
</code></pre><h3 id=解决版本>解决版本
<a class=anchor href=#%e8%a7%a3%e5%86%b3%e7%89%88%e6%9c%ac>#</a></h3><p>在server节点下添加以下配置</p><a href=/blog/linux/ByS8884qI0M/>...</a></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/H1v8I4cLAf/>Nginx反向代理、镜像缓存加速及负载均衡的配置</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>none</p></blockquote><p>Nginx已经具备Squid所拥有的Web缓存加速功能、清除指定URL缓存的功能。而在性能上，Nginx对多核CPU的利用，胜过Squid不少。另外，在反向代理、负载均衡、健康检查、后端服务器故障转移、Rewrite重写、易用性上，Nginx也比Squid强大得多。</p><a href=/blog/linux/H1v8I4cLAf/>...</a></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/rykY88V58CG/>nignx修改最大上传文件大小限制</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>none</p></blockquote><pre tabindex=0><code>location / {
            root   html;
            index  index.html index.htm;
            client_max_body_size    1000m;
  }
</code></pre><p>“client_max_body_size”设置一下上传的最大上限,然后重启nginx即可。</p></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/HkXeLI4cIAG/>rabbitmq 消息队列安装和配置</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><h2 id=erlang>erlang
<a class=anchor href=#erlang>#</a></h2><p>首先安装erlang语言环境</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install erlang -y
</span></span></code></pre></div><h2 id=rabbitmq>rabbitMQ
<a class=anchor href=#rabbitmq>#</a></h2><p>rabbitMQ下载地址：直达安装方法:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rpm -ivh --force --nodeps rabbitmq-server-3.6.0-1.noarch.rpm
</span></span><span style=display:flex><span>或者
</span></span><span style=display:flex><span>yum localinstall  rabbitmq-server-3.6.0-1.noarch.rpm -y
</span></span></code></pre></div><h2 id=启动服务>启动服务
<a class=anchor href=#%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/etc/init.d/rabbitmq-server start
</span></span><span style=display:flex><span>rabbitmq-plugins enable rabbitmq_management
</span></span></code></pre></div><h2 id=配置主备>配置主备
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e4%b8%bb%e5%a4%87>#</a></h2><h3 id=同步cookie>同步cookie
<a class=anchor href=#%e5%90%8c%e6%ad%a5cookie>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>777</span> /var/lib/rabbitmq/.erlang.cookie
</span></span><span style=display:flex><span>scp /var/lib/rabbitmq/.erlang.cookie Go02:/var/lib/rabbitmq/.erlang.cookie
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>400</span> /var/lib/rabbitmq/.erlang.cookie
</span></span></code></pre></div><h3 id=添加节点>添加节点
<a class=anchor href=#%e6%b7%bb%e5%8a%a0%e8%8a%82%e7%82%b9>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rabbitmqctl stop_app
</span></span><span style=display:flex><span>rabbitmqctl reset
</span></span><span style=display:flex><span>rabbitmqctl join_cluster <span style=color:#f92672>[</span>--ram<span style=color:#f92672>]</span> rabbit@Go01 //此处的Go01为主节点的hostname,需要在/etc/hosts中指定
</span></span><span style=display:flex><span>rabbitmqctl start_app
</span></span></code></pre></div><h3 id=删除节点>删除节点
<a class=anchor href=#%e5%88%a0%e9%99%a4%e8%8a%82%e7%82%b9>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rabbitmqctl stop_app
</span></span><span style=display:flex><span>rabbitmqctl forget_cluster_node rabbit@rabbit1
</span></span></code></pre></div><h3 id=修改类型>修改类型
<a class=anchor href=#%e4%bf%ae%e6%94%b9%e7%b1%bb%e5%9e%8b>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rabbitmqctl stop_app
</span></span><span style=display:flex><span>rabbitmqctl change_cluster_node_type ram
</span></span><span style=display:flex><span>rabbitmqctl start_app
</span></span></code></pre></div><h3 id=添加用户>添加用户
<a class=anchor href=#%e6%b7%bb%e5%8a%a0%e7%94%a8%e6%88%b7>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rabbitmqctl add_user admin admin
</span></span><span style=display:flex><span>添加权限:
</span></span><span style=display:flex><span>rabbitmqctl set_permissions -p <span style=color:#e6db74>&#34;/&#34;</span> admin <span style=color:#e6db74>&#34;.*&#34;</span> <span style=color:#e6db74>&#34;.*&#34;</span> <span style=color:#e6db74>&#34;.*&#34;</span>
</span></span><span style=display:flex><span>删除测试用户:
</span></span><span style=display:flex><span>rabbitmqctl delete_user guest
</span></span><span style=display:flex><span>赋予其administrator角色：
</span></span><span style=display:flex><span>rabbitmqctl set_user_tags admin administrator
</span></span></code></pre></div><h3 id=修改配置>修改配置
<a class=anchor href=#%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>//防止服务端异常中断恢复后镜像队列不能恢复的问题
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vim /etc/rabbitmq/rabbitmq.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>rabbit,<span style=color:#f92672>[{</span>tcp_listeners,<span style=color:#f92672>[</span>5672<span style=color:#f92672>]}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>cluster_partition_handling, autoheal<span style=color:#f92672>}]}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>.
</span></span><span style=display:flex><span><span style=color:#75715e>#不要忘记最后面的那个点号哦！</span>
</span></span></code></pre></div><h3 id=环境变量>环境变量
<a class=anchor href=#%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>touch /etc/rabbitmq/rabbitmq-env.conf#输入
</span></span><span style=display:flex><span>    RABBITMQ_NODENAME<span style=color:#f92672>=</span>FZTEC-240088 节点名称    RABBITMQ_NODE_IP_ADDRESS<span style=color:#f92672>=</span>127.0.0.1 监听IP
</span></span><span style=display:flex><span>    RABBITMQ_NODE_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>5672</span> 监听端口    RABBITMQ_LOG_BASE<span style=color:#f92672>=</span>/data/rabbitmq/log 日志目录
</span></span><span style=display:flex><span>    RABBITMQ_PLUGINS_DIR<span style=color:#f92672>=</span>/data/rabbitmq/plugins 插件目录
</span></span><span style=display:flex><span>    RABBITMQ_MNESIA_BASE<span style=color:#f92672>=</span>/data/rabbitmq/mnesia 后端存储目录
</span></span></code></pre></div><h3 id=rabbitmq的用户角色分类>RabbitMQ的用户角色分类
<a class=anchor href=#rabbitmq%e7%9a%84%e7%94%a8%e6%88%b7%e8%a7%92%e8%89%b2%e5%88%86%e7%b1%bb>#</a></h3><p>none、management、policymaker、monitoring、administrator</p><a href=/blog/linux/HkXeLI4cIAG/>...</a></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/HybPILE5U0z/>RabbitMQ三种Exchange模式(fanout,direct,topic)的性能比较</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>none</p></blockquote><p>RabbitMQ中，所有生产者提交的消息都由Exchange来接受，然后Exchange按照特定的策略转发到Queue进行存储</p><p>RabbitMQ提供了四种Exchange：fanout,direct,topic,header</p><a href=/blog/linux/HybPILE5U0z/>...</a></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/H1z5LL49I0z/>RabbitMQ性能优化</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>none</p></blockquote><h2 id=rabbitmqconfig>rabbitmq.config
<a class=anchor href=#rabbitmqconfig>#</a></h2><p>rabbitmq.config文件时rabbitmq的配置文件，他遵守Erlang配置文件定义。</p><p>rabbitmq.config文件位置：</p><a href=/blog/linux/H1z5LL49I0z/>...</a></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/rkCKI84cLAG/>rabbitmq之机器机器全部断电恢复记录</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><p>今天遇到一个rabbitmq集群同时断电，当机器全部启动的时候发现rabbitmq无法正常启动，然后发现如下日志。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>=</span>INFO REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:07 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Starting RabbitMQ 3.5.3 on Erlang R16B03-1
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> 2007-2014 GoPivotal, Inc.
</span></span><span style=display:flex><span>Licensed under the MPL.  See http://www.rabbitmq.com/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>INFO REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:07 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>node           : rabbit@WIN-ACC2J7AGNM9
</span></span><span style=display:flex><span>home dir       : C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator
</span></span><span style=display:flex><span>config file<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> : e:/RabbitMQ Data/rabbitmq.config <span style=color:#f92672>(</span>not found<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>cookie hash    : kR4NuIdBr2n8/4Qt9uIgqQ<span style=color:#f92672>==</span>
</span></span><span style=display:flex><span>log            : E:/RabbitMQ Data/log/rabbit@WIN-ACC2J7AGNM9.log
</span></span><span style=display:flex><span>sasl log       : E:/RabbitMQ Data/log/rabbit@WIN-ACC2J7AGNM9-sasl.log
</span></span><span style=display:flex><span>database dir   : e:/RabbitMQ Data/db/rabbit@WIN-ACC2J7AGNM9-mnesia
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>WARNING REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:07 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Kernel poll <span style=color:#f92672>(</span>epoll, kqueue, etc<span style=color:#f92672>)</span> is disabled. Throughput and CPU utilization may worsen.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>INFO REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:08 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Memory limit set to 13095MB of 32738MB total.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>INFO REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:08 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Disk free limit set to 50MB
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>INFO REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:08 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Limiting to approx <span style=color:#ae81ff>8092</span> file handles <span style=color:#f92672>(</span><span style=color:#ae81ff>7280</span> sockets<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>INFO REPORT<span style=color:#f92672>====</span> 25-Apr-2018::11:11:38 <span style=color:#f92672>===</span>
</span></span><span style=display:flex><span>Timeout contacting cluster nodes: <span style=color:#f92672>[</span><span style=color:#e6db74>&#39;rabbit@WIN-2W6NDAIZBIA&#39;</span><span style=color:#f92672>]</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>BACKGROUND
</span></span><span style=display:flex><span><span style=color:#f92672>==========</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>This cluster node was shut down <span style=color:#66d9ef>while</span> other nodes were still running.
</span></span><span style=display:flex><span>To avoid losing data, you should start the other nodes first, <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>start this one. To force this node to start, first invoke
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;rabbitmqctl force_boot&#34;</span>. If you <span style=color:#66d9ef>do</span> so, any changes made on other
</span></span><span style=display:flex><span>cluster nodes after this one was shut down may be lost.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DIAGNOSTICS
</span></span><span style=display:flex><span><span style=color:#f92672>===========</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>attempted to contact: <span style=color:#f92672>[</span><span style=color:#e6db74>&#39;rabbit@WIN-2W6NDAIZBIA&#39;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rabbit@WIN-2W6NDAIZBIA:
</span></span><span style=display:flex><span>  * connected to epmd <span style=color:#f92672>(</span>port 4369<span style=color:#f92672>)</span> on WIN-2W6NDAIZBIA
</span></span><span style=display:flex><span>  * epmd reports: node <span style=color:#e6db74>&#39;rabbit&#39;</span> not running at all
</span></span><span style=display:flex><span>                  no other nodes on WIN-2W6NDAIZBIA
</span></span><span style=display:flex><span>  * suggestion: start the node
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>current node details:
</span></span><span style=display:flex><span>- node name: <span style=color:#e6db74>&#39;rabbit@WIN-ACC2J7AGNM9&#39;</span>
</span></span><span style=display:flex><span>- home dir: C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\A</span>dministrator
</span></span><span style=display:flex><span>- cookie hash: kR4NuIdBr2n8/4Qt9uIgqQ<span style=color:#f92672>==</span>
</span></span></code></pre></div><p>关键的地方在于中间的这段说明：</p><a href=/blog/linux/rkCKI84cLAG/>...</a></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/linux/ry3FIUV58AM/>rabbitmq之修改数据和log目录位置位置</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><p><blockquote><p>vim /etc/rabbitmq/rabbitmq-env.conf</p></blockquote><h1 id=i-am-a-complete-etcrabbitmqrabbitmq-e>I am a complete /etc/rabbitmq/rabbitmq-e…
<a class=anchor href=#i-am-a-complete-etcrabbitmqrabbitmq-e>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> vim /etc/rabbitmq/rabbitmq-env.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># I am a complete /etc/rabbitmq/rabbitmq-env.conf file.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Comment lines start with a hash character.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This is a /bin/sh script file - use ordinary envt var syntax</span>
</span></span><span style=display:flex><span>MNESIA_BASE<span style=color:#f92672>=</span>/data/rabbitmq/mnesia
</span></span><span style=display:flex><span>LOG_BASE<span style=color:#f92672>=</span>/data/logs/rabbitmq
</span></span></code></pre></div></p></article><article class="markdown book-post"><h2 class=book-post-title><a href=/blog/ffmpeg/S1EdILNqU0M/>Rematrix is needed between 10 channels and 7.1(wide) but there is not enough</a></h2><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/ffmpeg/>FFmpeg</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/ffmpeg/>FFmpeg</a></span></div><p><blockquote><p>解决办法</p></blockquote><p>将10个声道拆分成10个音轨</p><p>ffmpeg -i INPUTFILE -filter_complex “[0:a]pan=mono|c0=c0[…</p><h2 id=解决办法>解决办法
<a class=anchor href=#%e8%a7%a3%e5%86%b3%e5%8a%9e%e6%b3%95>#</a></h2><p>将10个声道拆分成10个音轨</p><pre tabindex=0><code>ffmpeg -i INPUTFILE  -filter_complex &#34;[0:a]pan=mono|c0=c0[a0];[0:a]pan=mono|c0=c1[a1];[0:a]pan=mono|c0=c2[a2];[0:a]pan=mono|c0=c3[a3];[0:a]pan=mono|c0=c4[a4];[0:a]pan=mono|c0=c5[a5];[0:a]pan=mono|c0=c6[a6];[0:a]pan=mono|c0=c7[a7];[0:a]pan=mono|c0=c8[a8];[0:a]pan=mono|c0=c9[a9]&#34; -map &#34;[a0]&#34; -map &#34;[a1]&#34; -map &#34;[a2]&#34; -map &#34;[a3]&#34; -map &#34;[a4]&#34; -map &#34;[a5]&#34; -map &#34;[a6]&#34; -map &#34;[a7]&#34; -map &#34;[a8]&#34; -map &#34;[a9]&#34; -vn -c:a pcm_s24le  OUTPUTFILE

ffmpeg -i INPUTFILE -vn -c:a pcm_s24le -map 0:1 -filter:a:0 &#34;pan=mono|c0=c0&#34; -map 0:1 -filter:a:1 &#34;pan=mono|c0=c1&#34; -map 0:1 -filter:a:2 &#34;pan=mono|c0=c2&#34; -map 0:1 -filter:a:3 &#34;pan=mono|c0=c3&#34; -map 0:1 -filter:a:4 &#34;pan=mono|c0=c4&#34; -map 0:1 -filter:a:5 &#34;pan=mono|c0=c5&#34; -map 0:1 -filter:a:6 &#34;pan=mono|c0=c6&#34; -map 0:1 -filter:a:7 &#34;pan=mono|c0=c7&#34; -map 0:1 -filter:a:8 &#34;pan=mono|c0=c8&#34; -map 0:1 -filter:a:9 &#34;pan=mono|c0=c9&#34; OUTPUTFILE
</code></pre></p></article><ul class="pagination pagination-default"><li class=page-item><a href=/articles/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/articles/page/10/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/articles/page/8/ aria-label="Page 8" class=page-link role=button>8</a></li><li class=page-item><a href=/articles/page/9/ aria-label="Page 9" class=page-link role=button>9</a></li><li class=page-item><a href=/articles/page/10/ aria-label="Page 10" class=page-link role=button>10</a></li><li class="page-item active"><a aria-current=page aria-label="Page 11" class=page-link role=button>11</a></li><li class=page-item><a href=/articles/page/12/ aria-label="Page 12" class=page-link role=button>12</a></li><li class=page-item><a href=/articles/page/12/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/articles/page/12/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav><ul><li class=book-section-flat><strong>Categories</strong><ul><li class="flex justify-between"><a href=/categories/linux/>Linux</a>
<span>84</span></li><li class="flex justify-between"><a href=/categories/ffmpeg/>FFmpeg</a>
<span>25</span></li><li class="flex justify-between"><a href=/categories/macos/>MacOS</a>
<span>10</span></li><li class="flex justify-between"><a href=/categories/hugo/>Hugo</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Tags</strong><ul><li class="flex justify-between"><a href=/tags/linux/>Linux</a>
<span>85</span></li><li class="flex justify-between"><a href=/tags/ffmpeg/>FFmpeg</a>
<span>25</span></li><li class="flex justify-between"><a href=/tags/macos/>MacOS</a>
<span>10</span></li><li class="flex justify-between"><a href=/tags/python/>Python</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/blog/>Blog</a>
<span>1</span></li><li class="flex justify-between"><a href=/tags/hugo/>Hugo</a>
<span>1</span></li></ul></li></ul></nav></div></aside></main><footer class=page-footer><p><span id=page-footer-time>载入中...</span>
<script>function secondToDate(e){if(!e)return 0;var t=new Array(0,0,0,0,0);return e>=365*24*3600&&(t[0]=parseInt(e/(365*24*3600)),e%=365*24*3600),e>=24*3600&&(t[1]=parseInt(e/(24*3600)),e%=24*3600),e>=3600&&(t[2]=parseInt(e/3600),e%=3600),e>=60&&(t[3]=parseInt(e/60),e%=60),e>0&&(t[4]=e),t}</script><script type=text/javascript language=javascript>function setTime(){var e=Math.round(new Date(Date.UTC(2016,11,1,0,0,0)).getTime()/1e3),t=Math.round(((new Date).getTime()+8*60*60*1e3)/1e3);currentTime=secondToDate(t-e),currentTimeHtml=currentTime[0]+"年"+currentTime[1]+"天"+currentTime[2]+"时"+currentTime[3]+"分"+currentTime[4]+"秒",document.getElementById("page-footer-time").innerHTML="网站运行:"+currentTimeHtml}setInterval(setTime,1e3)</script></p></footer></body></html>