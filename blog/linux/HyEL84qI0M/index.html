<!doctype html><html lang=zh dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
æœåŠ¡å™¨é…ç½®å¤šç½‘å¡å¤šç½‘å…³æ—¶ï¼Œä¸ºäº†é¿å…æ—¶ä¸æ—¶çš„å»æ·»åŠ ç›¸å…³å›ç¨‹è·¯ç”±ï¼Œå› æ­¤éœ€è¦é…ç½®ä¸€ä¸‹ç­–ç•¥è·¯ç”±ã€‚

åŸæ–‡åœ°å€ blog.csdn.net
æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬ï¼šCentOS Linux release 7.3.1611

  1.æ·»åŠ è·¯ç”±è¡¨
  #

vi /etc/iproute2/rt_tables

...

101Â  Â  Â innerRoute
102Â  Â  Â globalRoute

  2. æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬
  #

ip route flush table globalRoute
ip rule add dev eth1 table globalRoute
if ! ip rule show | grep x.x.x.x ; then
    ip rule add from x.x.x.x table globalRoute
fi
ip route add default via y.y.y.y dev eth1 table globalRoute

ip route flush table innerRoute
ip rule add dev eth2 table innerRoute
if ! ip rule show | grep 172.16.x.x ; then
    ip rule add from 172.16.x.x table innerRoute
fi
ip route add default via 172.16.y.y dev eth2 table innerRoute
ä¸Šé¢ x.x.x.x æ˜¯é…ç½®åœ¨ç½‘å£ eth1 ä¸Šçš„ ipï¼Œy.y.y.y æ˜¯è¯¥ ip çš„ç½‘å…³ï¼Œ172.16.x.x æ˜¯ eth2 çš„ ipï¼Œæˆ‘è¿™é‡Œæ˜¯å†…ç½‘ ipï¼Œ172.16.y.y æ˜¯ 172 ç½‘å…³çš„ç½‘å…³ã€‚"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://notes.zhangwenbing.com/blog/linux/HyEL84qI0M/"><meta property="og:site_name" content="å¼ æ–‡å…µçš„ç¬”è®°"><meta property="og:title" content="centos7 åŒipç­–ç•¥è·¯ç”±é…ç½®æ–¹æ³•"><meta property="og:description" content=" æœåŠ¡å™¨é…ç½®å¤šç½‘å¡å¤šç½‘å…³æ—¶ï¼Œä¸ºäº†é¿å…æ—¶ä¸æ—¶çš„å»æ·»åŠ ç›¸å…³å›ç¨‹è·¯ç”±ï¼Œå› æ­¤éœ€è¦é…ç½®ä¸€ä¸‹ç­–ç•¥è·¯ç”±ã€‚
åŸæ–‡åœ°å€ blog.csdn.net
æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬ï¼šCentOS Linux release 7.3.1611
1.æ·»åŠ è·¯ç”±è¡¨ # vi /etc/iproute2/rt_tables ... 101Â innerRoute 102Â globalRoute 2. æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬ # ip route flush table globalRoute ip rule add dev eth1 table globalRoute if ! ip rule show | grep x.x.x.x ; then ip rule add from x.x.x.x table globalRoute fi ip route add default via y.y.y.y dev eth1 table globalRoute ip route flush table innerRoute ip rule add dev eth2 table innerRoute if ! ip rule show | grep 172.16.x.x ; then ip rule add from 172.16.x.x table innerRoute fi ip route add default via 172.16.y.y dev eth2 table innerRoute ä¸Šé¢ x.x.x.x æ˜¯é…ç½®åœ¨ç½‘å£ eth1 ä¸Šçš„ ipï¼Œy.y.y.y æ˜¯è¯¥ ip çš„ç½‘å…³ï¼Œ172.16.x.x æ˜¯ eth2 çš„ ipï¼Œæˆ‘è¿™é‡Œæ˜¯å†…ç½‘ ipï¼Œ172.16.y.y æ˜¯ 172 ç½‘å…³çš„ç½‘å…³ã€‚"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-05-14T04:45:01+08:00"><meta property="article:modified_time" content="2018-05-14T04:45:01+08:00"><meta property="article:tag" content="Linux"><title>centos7 åŒipç­–ç•¥è·¯ç”±é…ç½®æ–¹æ³• | å¼ æ–‡å…µçš„ç¬”è®°</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=https://notes.zhangwenbing.com/blog/linux/HyEL84qI0M/><link rel=stylesheet href=/book.min.7bc0bb908f28131671779537cc0c91a39075ed4cba93497f05888d37375171ce.css integrity="sha256-e8C7kI8oExZxd5U3zAyRo5B17Uy6k0l/BYiNNzdRcc4=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/zh.search.min.c07ff3d3de9a2b6b7dadb3cfa263c5b4ed9782d56cb13a49bb73fd2f8a5850d9.js integrity="sha256-wH/z096aK2t9rbPPomPFtO2XgtVssTpJu3P9L4pYUNk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>å¼ æ–‡å…µçš„ç¬”è®°</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=æœç´¢ aria-label=æœç´¢ maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-6d1804e163fb7f5fbc576b94719a59cb class=toggle>
<label for=section-6d1804e163fb7f5fbc576b94719a59cb class="flex justify-between"><a role=button>ğŸ‘¨ğŸ¼â€ğŸ’» ç¼–ç¨‹ç›¸å…³</a></label><ul><li><input type=checkbox id=section-0aec292f8bca227859512cec8a349fde class=toggle>
<label for=section-0aec292f8bca227859512cec8a349fde class="flex justify-between"><a role=button>ğŸ“” Rust</a></label><ul><li><input type=checkbox id=section-2c4b9a1cbc74613570f3c4585f635628 class=toggle>
<label for=section-2c4b9a1cbc74613570f3c4585f635628 class="flex justify-between"><a role=button>ğŸ”– å­¦ä¹ ç¬”è®°</a></label><ul><li><a href=/notes/2024/03/06/e3ksq3zkmps14gcxuirwzx/>ğŸ“ æ‰€æœ‰æƒ</a></li><li><a href=/notes/2024/03/06/o4arkqgfnqygr5ckif2gkk/>ğŸ“ å€Ÿç”¨ä¸å¼•ç”¨</a></li></ul></li></ul></li><li><input type=checkbox id=section-e9c99308492d6ec7c6ad1055f21a8388 class=toggle>
<label for=section-e9c99308492d6ec7c6ad1055f21a8388 class="flex justify-between"><a role=button>ğŸ“” C++</a></label><ul><li><input type=checkbox id=section-20a57960c86cf1e17496afffbf8709bd class=toggle>
<label for=section-20a57960c86cf1e17496afffbf8709bd class="flex justify-between"><a role=button>ğŸ”– MacOSç›¸å…³</a></label><ul><li><a href=/notes/2024/06/06/sf4ff6x8cuyhvzougj9dwg/>ğŸ“ MacOSç­¾å</a></li><li><a href=/notes/2024/05/28/3txbbb7iruppjsg4p7rwnb/>ğŸ“ MacOSå †æ ˆå¤§å°</a></li></ul></li><li><input type=checkbox id=section-73d666aab79f51941fa08364256f32f2 class=toggle>
<label for=section-73d666aab79f51941fa08364256f32f2 class="flex justify-between"><a role=button>ğŸ”– Qt</a></label><ul><li><a href=/notes/2024/08/01/rnc4n7cfifidx8ca2rhjme/>ğŸ“ QMLé¼ æ ‡äº‹ä»¶</a></li><li><a href=/notes/2024/08/06/ny773erqjgbzmzgfikfvds/>ğŸ“ QMLè™šæ‹Ÿåˆ—è¡¨</a></li></ul></li></ul></li><li><input type=checkbox id=section-aea9addc7ea0cf58a2c2c9ec52f959c9 class=toggle>
<label for=section-aea9addc7ea0cf58a2c2c9ec52f959c9 class="flex justify-between"><a role=button>ğŸ“” Git</a></label><ul><li><a href=/notes/2024/03/11/j3c62fv8dglvf2kg975zlv/>ğŸ“ æ ‡ç­¾æ“ä½œ</a></li><li><a href=/notes/2024/03/14/5kqlzqjqawbxf2t6vusxar/>ğŸ“ åˆ é™¤Commit</a></li><li><a href=/blog/git/WNYzxj6GR/>ğŸ“ gitä¹‹åˆ é™¤è¿œç¨‹åˆ†æ”¯</a></li><li><a href=/blog/git/-fZeBsu3T/>ğŸ“ gitæ›´æ–°.gitignore</a></li><li><a href=/blog/git/H1Krv6b-4/>ğŸ“ gitä¿®æ”¹å†å²cimmitä¿¡æ¯</a></li><li><a href=/blog/git/By9OI51xN/>ğŸ“ gitåŸºç¡€ç¬”è®°</a></li><li><a href=/blog/git/Hk6GGp6cQ/>ğŸ“ Gitå›æ»šåˆ°æŸä¸ªcommit</a></li></ul></li></ul></li><li><a href=/links/>ğŸ¤ å‹æƒ…é“¾æ¥</a></li></ul><ul><li><a href=/articles/>ğŸ“š æˆ‘çš„æ–‡ç« </a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>centos7 åŒipç­–ç•¥è·¯ç”±é…ç½®æ–¹æ³•</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#1æ·»åŠ è·¯ç”±è¡¨>1.æ·»åŠ è·¯ç”±è¡¨</a></li><li><a href=#2-æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬>2. æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬</a></li><li><a href=#3-å¼€æœºå¯åŠ¨>3. å¼€æœºå¯åŠ¨</a></li></ul></nav></aside></header><article class="markdown book-post"><h1 class=book-post-title><a href=/blog/linux/HyEL84qI0M/>centos7 åŒipç­–ç•¥è·¯ç”±é…ç½®æ–¹æ³•</a></h1><div class=book-post-meta><span class=book-post-meta-date>2018-05-14</span>
<span class=book-post-meta-separator-categories>&nbsp; | &nbsp;</span>
<span class=book-post-meta-categories><a href=/categories/linux/>Linux</a>
</span><span class=book-post-meta-separator-tags>&nbsp; | &nbsp;</span>
<span class=book-post-meta-tags><a href=/tags/linux/>Linux</a></span></div><blockquote><p>æœåŠ¡å™¨é…ç½®å¤šç½‘å¡å¤šç½‘å…³æ—¶ï¼Œä¸ºäº†é¿å…æ—¶ä¸æ—¶çš„å»æ·»åŠ ç›¸å…³å›ç¨‹è·¯ç”±ï¼Œå› æ­¤éœ€è¦é…ç½®ä¸€ä¸‹ç­–ç•¥è·¯ç”±ã€‚</p></blockquote><p>åŸæ–‡åœ°å€ <a href=https://blog.csdn.net/pyxllq/article/details/105817064>blog.csdn.net</a></p><p>æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬ï¼šCentOS Linux release 7.3.1611</p><h2 id=1æ·»åŠ è·¯ç”±è¡¨>1.æ·»åŠ è·¯ç”±è¡¨
<a class=anchor href=#1%e6%b7%bb%e5%8a%a0%e8%b7%af%e7%94%b1%e8%a1%a8>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi /etc/iproute2/rt_tables
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>101Â  Â  Â innerRoute
</span></span><span style=display:flex><span>102Â  Â  Â globalRoute
</span></span></code></pre></div><h2 id=2-æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬>2. æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬
<a class=anchor href=#2-%e6%b7%bb%e5%8a%a0%e8%b7%af%e7%94%b1%e9%85%8d%e7%bd%ae%e8%84%9a%e6%9c%ac>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ip route flush table globalRoute
</span></span><span style=display:flex><span>ip rule add dev eth1 table globalRoute
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! ip rule show | grep x.x.x.x ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    ip rule add from x.x.x.x table globalRoute
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>ip route add default via y.y.y.y dev eth1 table globalRoute
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ip route flush table innerRoute
</span></span><span style=display:flex><span>ip rule add dev eth2 table innerRoute
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! ip rule show | grep 172.16.x.x ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    ip rule add from 172.16.x.x table innerRoute
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>ip route add default via 172.16.y.y dev eth2 table innerRoute
</span></span></code></pre></div><p>ä¸Šé¢ x.x.x.x æ˜¯é…ç½®åœ¨ç½‘å£ eth1 ä¸Šçš„ ipï¼Œy.y.y.y æ˜¯è¯¥ ip çš„ç½‘å…³ï¼Œ172.16.x.x æ˜¯ eth2 çš„ ipï¼Œæˆ‘è¿™é‡Œæ˜¯å†…ç½‘ ipï¼Œ172.16.y.y æ˜¯ 172 ç½‘å…³çš„ç½‘å…³ã€‚</p><h2 id=3-å¼€æœºå¯åŠ¨>3. å¼€æœºå¯åŠ¨
<a class=anchor href=#3-%e5%bc%80%e6%9c%ba%e5%90%af%e5%8a%a8>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>1ã€ï¼ˆ/opt/script/autostart.shæ˜¯ä½ çš„è„šæœ¬è·¯å¾„ï¼‰
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chmod +x /opt/script/autostart.sh
</span></span><span style=display:flex><span>2ã€æ‰“å¼€/etc/rc.d/rc.localæ–‡ä»¶ï¼Œåœ¨æœ«å°¾å¢åŠ å¦‚ä¸‹å†…å®¹
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/opt/script/autostart.sh
</span></span><span style=display:flex><span>3ã€åœ¨centos7ä¸­ï¼Œ/etc/rc.d/rc.localçš„æƒé™è¢«é™ä½äº†ï¼Œæ‰€ä»¥éœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤èµ‹äºˆå…¶å¯æ‰§è¡Œæƒé™
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chmod +x /etc/rc.d/rc.local
</span></span></code></pre></div><p>æ³¨é‡Šï¼šcentos 7.5 ç³»ç»Ÿé…ç½®å‘½ä»¤éƒ½æ˜¯éœ€è¦ id(101,102) ä¸å†æ˜¯åå­—</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1æ·»åŠ è·¯ç”±è¡¨>1.æ·»åŠ è·¯ç”±è¡¨</a></li><li><a href=#2-æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬>2. æ·»åŠ è·¯ç”±é…ç½®è„šæœ¬</a></li><li><a href=#3-å¼€æœºå¯åŠ¨>3. å¼€æœºå¯åŠ¨</a></li></ul></nav></div></aside></main><footer class=page-footer><p><span id=page-footer-time>è½½å…¥ä¸­...</span>
<script>function secondToDate(e){if(!e)return 0;var t=new Array(0,0,0,0,0);return e>=365*24*3600&&(t[0]=parseInt(e/(365*24*3600)),e%=365*24*3600),e>=24*3600&&(t[1]=parseInt(e/(24*3600)),e%=24*3600),e>=3600&&(t[2]=parseInt(e/3600),e%=3600),e>=60&&(t[3]=parseInt(e/60),e%=60),e>0&&(t[4]=e),t}</script><script type=text/javascript language=javascript>function setTime(){var e=Math.round(new Date(Date.UTC(2016,11,1,0,0,0)).getTime()/1e3),t=Math.round(((new Date).getTime()+8*60*60*1e3)/1e3);currentTime=secondToDate(t-e),currentTimeHtml=currentTime[0]+"å¹´"+currentTime[1]+"å¤©"+currentTime[2]+"æ—¶"+currentTime[3]+"åˆ†"+currentTime[4]+"ç§’",document.getElementById("page-footer-time").innerHTML="ç½‘ç«™è¿è¡Œ:"+currentTimeHtml}setInterval(setTime,1e3)</script></p></footer></body></html>